# lib/oesc_tables.py
"""
OESC Lookup Tables (embedded)

This module holds embedded OESC table data for calculators (e.g., conduit fill).
Keeping tables in a dedicated file avoids missing-file issues (e.g., JSON not
committed) and makes lookups fast and reliable.

Tables included (as extracted from the provided images):
- Table 6A: Unjacketed 600 V insulated conductors (Class B R90XLPE, RW75XLPE,
  RW90XLPE, RPV90) for conduit/tubing fill.
- Table 6B: Unjacketed 1000 V insulated conductors (Class B R90XLPE, RW75XLPE,
  RW90XLPE, RPV90) for conduit/tubing fill.
- Table 6C: Jacketed 600 V insulated conductors (Class B R90XLPE, RW75XLPE,
  R90EP, RW75EP, RW90XLPE, RW90EP, RPV90) for conduit/tubing fill.

Data structure for each table:
TABLE_6X[conductor_construction][size]["dia_mm"]
TABLE_6X[conductor_construction][size]["areas_by_count"][n_conductors]

Where:
- conductor_construction: "stranded" or "solid"
- size: conductor size label as string (e.g., "14", "1/0", "250", "1000")
- n_conductors: int (1,2,3,4,5,6,7,8,9,10,20)
- areas are in mm², diameters in mm

Notes:
- Extracted from screenshots; please verify against the official OESC tables
  if you require absolute certainty for issued engineering deliverables.
"""

from __future__ import annotations

from typing import Dict, Any, Optional

# ----------------------------
# Friendly title overrides
# (Some legacy tables are stored in "raw" structures, so their titles are not embedded in the object.)
# ----------------------------
TITLE_OVERRIDES: Dict[str, str] = {
    "6A": "Table 6A — Dimensions of single Class B R90XLPE, RW75XLPE, RW90XLPE, and RPV90 unjacketed 600 V insulated conductors for calculating conduit and tubing fill",
    "6B": "Table 6B — Dimensions of single Class B R90XLPE, RW75XLPE, RW90XLPE, and RPV90 unjacketed 1000 V insulated conductors for calculating conduit and tubing fill",
    "6C": "Table 6C — Dimensions of single Class B R90XLPE, RW75XLPE, R90EP, RW75EP, RW90XLPE, RW90EP, and RPV90 jacketed 600 V insulated conductors for calculating conduit and tubing fill",
    "6D": "Table 6D — Dimensions of single Class B TWU, TWU75, RWU90XLPE unjacketed, and RPVU90 jacketed 1000 V cables for calculating conduit and tubing fill",
    "6E": "Table 6E — Dimensions of single Class B RPVU90 unjacketed 1000 V and 2000 V cables for calculating conduit and tubing fill",
    "6F": "Table 6F — Dimensions of single Class B RPVU90 jacketed 1000 V and 2000 V cables for calculating conduit and tubing fill",
    "6G": "Table 6G — Dimensions of single Class B RPV90 unjacketed 2000 V insulated conductors for calculating conduit and tubing fill",
    "6H": "Table 6H — Dimensions of single Class B RPV90 jacketed 1000 V insulated conductors for calculating conduit and tubing fill",
    "6I": "Table 6I — Dimensions of single Class B RPV90 jacketed 2000 V insulated conductors for calculating conduit and tubing fill",
    "6J": "Table 6J — Dimensions of single Class B TW, TW75 insulated conductors for calculating conduit and tubing fill",
    "6K": "Table 6K — Dimensions of single Class C TWN75, T90 NYLON insulated conductors for calculating conduit and tubing fill",

    "9A": "Table 9A — Internal diameter and cross-sectional areas of various trade conduit and tubing",
    "9B": "Table 9B — Internal diameter and cross-sectional areas of various trade conduit and tubing",
    "9C": "Table 9C — Internal diameter and maximum conductor cross-sectional areas allowable fill at 53% for various trade conduit and tubing used for one conductor or multi-conductor cable (not lead-sheathed)",
    "9D": "Table 9D — Internal diameter and maximum conductor cross-sectional areas allowable fill at 53% for various trade conduit and tubing used for one conductor or multi-conductor cable (not lead-sheathed)",
    "9E": "Table 9E — Internal diameter and maximum conductor cross-sectional areas allowable fill at 31% for various trade conduit and tubing used for two conductors or multi-conductor cables (not lead-sheathed)",
    "9F": "Table 9F — Internal diameter and maximum conductor cross-sectional areas allowable fill at 31% for various trade conduit and tubing used for two conductors or multi-conductor cables (not lead-sheathed)",
    "9G": "Table 9G — Internal diameter and maximum conductor cross-sectional areas allowable fill at 40% for various trade conduit and tubing used for three or more conductors or multi-conductor cables (not lead-sheathed)",
    "9H": "Table 9H — Internal diameter and maximum conductor cross-sectional areas allowable fill at 40% for various trade conduit and tubing used for three or more conductors or multi-conductor cables (not lead-sheathed)",
    "37": "Table 37 — Motor supply conductor insulation minimum temperature rating, °C (based on an ambient temperature of 30 °C)",
    "44": "Table 44 — Three-phase ac motors (AC motor full load current, A)",
    "45": "Table 45 — Single-phase ac motors (Single-phase ac motors full load current, A)",
    "27": "Table 27 — Determining conductor sizes for motors for different requirements of service (Percentage of nameplate current rating of motor)",
    "D2": "Table D2 — DC motors (DC full load current rating, A)",
    "D3": "Table D3 — K values for calculating voltage drop in an installation of 2, 3, or 4 insulated conductors in a cable or raceway based on a conductor operating temperature of 75 °C",
    "D-System-Factor": "Table D — System factor (f) for voltage drop calculations in various AC and DC electrical systems and connection types",
}



# --------------------------------------------------------------------------------------
# Table 6A (600 V, unjacketed) — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_6A: Dict[str, Dict[str, Dict[str, Any]]] = {
    "stranded": {
        "14":  {"dia_mm": 3.36, "areas_by_count": {1: 8.87, 2: 17.8, 3: 26.6, 4: 35.5, 5: 44.4, 6: 53.2, 7: 62.1, 8: 71.0, 9: 79.8, 10: 88.7, 20: 178}},
        "12":  {"dia_mm": 3.84, "areas_by_count": {1: 11.6, 2: 23.2, 3: 34.8, 4: 46.4, 5: 58.0, 6: 69.5, 7: 81.1, 8: 92.7, 9: 105.0, 10: 116.0, 20: 232}},
        "10":  {"dia_mm": 4.47, "areas_by_count": {1: 15.7, 2: 31.4, 3: 47.1, 4: 62.8, 5: 78.5, 6: 94.2, 7: 110.0, 8: 126.0, 9: 142.0, 10: 157.0, 20: 314}},
        "8":   {"dia_mm": 5.99, "areas_by_count": {1: 28.2, 2: 56.4, 3: 84.6, 4: 113.0, 5: 141.0, 6: 170.0, 7: 198.0, 8: 226.0, 9: 254.0, 10: 282.0, 20: 564}},
        "6":   {"dia_mm": 6.95, "areas_by_count": {1: 38.0, 2: 75.9, 3: 114.0, 4: 152.0, 5: 190.0, 6: 228.0, 7: 266.0, 8: 304.0, 9: 342.0, 10: 380.0, 20: 759}},
        "4":   {"dia_mm": 8.17, "areas_by_count": {1: 52.5, 2: 105.0, 3: 158.0, 4: 210.0, 5: 263.0, 6: 315.0, 7: 367.0, 8: 420.0, 9: 472.0, 10: 525.0, 20: 1049}},
        "3":   {"dia_mm": 8.88, "areas_by_count": {1: 62.0, 2: 124.0, 3: 186.0, 4: 248.0, 5: 310.0, 6: 372.0, 7: 434.0, 8: 496.0, 9: 558.0, 10: 620.0, 20: 1239}},
        "2":   {"dia_mm": 9.70, "areas_by_count": {1: 73.9, 2: 148.0, 3: 222.0, 4: 296.0, 5: 370.0, 6: 444.0, 7: 518.0, 8: 592.0, 9: 666.0, 10: 739.0, 20: 1478}},
        "1":   {"dia_mm": 11.23, "areas_by_count": {1: 99.1, 2: 199.0, 3: 298.0, 4: 397.0, 5: 496.0, 6: 595.0, 7: 694.0, 8: 793.0, 9: 892.0, 10: 991.0, 20: 1981}},
        "1/0": {"dia_mm": 12.27, "areas_by_count": {1: 119.0, 2: 237.0, 3: 355.0, 4: 473.0, 5: 592.0, 6: 710.0, 7: 828.0, 8: 946.0, 9: 1065.0, 10: 1183.0, 20: 2365}},
        "2/0": {"dia_mm": 13.44, "areas_by_count": {1: 142.0, 2: 284.0, 3: 426.0, 4: 568.0, 5: 710.0, 6: 852.0, 7: 994.0, 8: 1135.0, 9: 1277.0, 10: 1419.0, 20: 2838}},
        "3/0": {"dia_mm": 14.74, "areas_by_count": {1: 171.0, 2: 342.0, 3: 512.0, 4: 683.0, 5: 854.0, 6: 1024.0, 7: 1195.0, 8: 1366.0, 9: 1536.0, 10: 1707.0, 20: 3413}},
        "4/0": {"dia_mm": 16.21, "areas_by_count": {1: 207.0, 2: 413.0, 3: 620.0, 4: 826.0, 5: 1032.0, 6: 1239.0, 7: 1445.0, 8: 1651.0, 9: 1858.0, 10: 2064.0, 20: 4128}},
        "250": {"dia_mm": 17.90, "areas_by_count": {1: 252.0, 2: 504.0, 3: 755.0, 4: 1007.0, 5: 1259.0, 6: 1510.0, 7: 1762.0, 8: 2014.0, 9: 2265.0, 10: 2517.0, 20: 5033}},
        "300": {"dia_mm": 19.30, "areas_by_count": {1: 293.0, 2: 586.0, 3: 878.0, 4: 1171.0, 5: 1463.0, 6: 1756.0, 7: 2048.0, 8: 2341.0, 9: 2633.0, 10: 2926.0, 20: 5852}},
        "350": {"dia_mm": 20.53, "areas_by_count": {1: 332.0, 2: 663.0, 3: 994.0, 4: 1325.0, 5: 1656.0, 6: 1987.0, 7: 2318.0, 8: 2649.0, 9: 2980.0, 10: 3311.0, 20: 6621}},
        "400": {"dia_mm": 21.79, "areas_by_count": {1: 373.0, 2: 746.0, 3: 1119.0, 4: 1492.0, 5: 1865.0, 6: 2238.0, 7: 2611.0, 8: 2984.0, 9: 3357.0, 10: 3730.0, 20: 7459}},
        "450": {"dia_mm": 22.91, "areas_by_count": {1: 413.0, 2: 825.0, 3: 1237.0, 4: 1649.0, 5: 2062.0, 6: 2474.0, 7: 2886.0, 8: 3298.0, 9: 3711.0, 10: 4123.0, 20: 8245}},
        "500": {"dia_mm": 23.95, "areas_by_count": {1: 451.0, 2: 902.0, 3: 1352.0, 4: 1803.0, 5: 2253.0, 6: 2704.0, 7: 3154.0, 8: 3605.0, 9: 4055.0, 10: 4506.0, 20: 9011}},
        "600": {"dia_mm": 26.74, "areas_by_count": {1: 562.0, 2: 1124.0, 3: 1685.0, 4: 2247.0, 5: 2808.0, 6: 3370.0, 7: 3932.0, 8: 4493.0, 9: 5055.0, 10: 5616.0, 20: 11232}},
        "700": {"dia_mm": 28.55, "areas_by_count": {1: 641.0, 2: 1281.0, 3: 1921.0, 4: 2561.0, 5: 3201.0, 6: 3842.0, 7: 4482.0, 8: 5122.0, 9: 5762.0, 10: 6402.0, 20: 12804}},
        "750": {"dia_mm": 29.41, "areas_by_count": {1: 680.0, 2: 1359.0, 3: 2038.0, 4: 2718.0, 5: 3397.0, 6: 4076.0, 7: 4756.0, 8: 5435.0, 9: 6114.0, 10: 6794.0, 20: 13587}},
        "800": {"dia_mm": 30.25, "areas_by_count": {1: 719.0, 2: 1438.0, 3: 2157.0, 4: 2875.0, 5: 3594.0, 6: 4313.0, 7: 5031.0, 8: 5750.0, 9: 6469.0, 10: 7187.0, 20: 14374}},
        "900": {"dia_mm": 31.85, "areas_by_count": {1: 797.0, 2: 1594.0, 3: 2391.0, 4: 3187.0, 5: 3984.0, 6: 4781.0, 7: 5578.0, 8: 6374.0, 9: 7171.0, 10: 7968.0, 20: 15935}},
        "1000": {"dia_mm": 33.32, "areas_by_count": {1: 872.0, 2: 1744.0, 3: 2616.0, 4: 3488.0, 5: 4360.0, 6: 5232.0, 7: 6104.0, 8: 6976.0, 9: 7848.0, 10: 8720.0, 20: 17440}},
        "1250": {"dia_mm": 37.56, "areas_by_count": {1: 1109.0, 2: 2217.0, 3: 3325.0, 4: 4433.0, 5: 5541.0, 6: 6649.0, 7: 7757.0, 8: 8865.0, 9: 9973.0, 10: 11081.0, 20: 22161}},
        "1500": {"dia_mm": 40.68, "areas_by_count": {1: 1300.0, 2: 2600.0, 3: 3900.0, 4: 5199.0, 5: 6499.0, 6: 7799.0, 7: 9099.0, 8: 10398.0, 9: 11698.0, 10: 12998.0, 20: 25995}},
        "1750": {"dia_mm": 43.58, "areas_by_count": {1: 1492.0, 2: 2984.0, 3: 4475.0, 4: 5967.0, 5: 7459.0, 6: 8950.0, 7: 10442.0, 8: 11934.0, 9: 13425.0, 10: 14917.0, 20: 29833}},
        "2000": {"dia_mm": 46.27, "areas_by_count": {1: 1682.0, 2: 3363.0, 3: 5045.0, 4: 6726.0, 5: 8408.0, 6: 10089.0, 7: 11771.0, 8: 13452.0, 9: 15134.0, 10: 16815.0, 20: 33630}}
    },
    "solid": {
        "14": {"dia_mm": 3.15, "areas_by_count": {1: 7.79, 2: 15.6, 3: 23.4, 4: 31.2, 5: 39.0, 6: 46.8, 7: 54.6, 8: 62.4, 9: 70.2, 10: 78.0, 20: 156}},
        "12": {"dia_mm": 3.57, "areas_by_count": {1: 10.1, 2: 20.1, 3: 30.1, 4: 40.1, 5: 50.1, 6: 60.1, 7: 70.1, 8: 80.1, 9: 90.1, 10: 101.0, 20: 201}},
        "10": {"dia_mm": 4.11, "areas_by_count": {1: 13.3, 2: 26.6, 3: 39.9, 4: 53.1, 5: 66.4, 6: 79.7, 7: 92.9, 8: 107.0, 9: 120.0, 10: 133.0, 20: 266}}
    }
}


# --------------------------------------------------------------------------------------
# Table 6B (1000 V, unjacketed) — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_6B: Dict[str, Dict[str, Dict[str, Any]]] = {
    "stranded": {
        "14":  {"dia_mm": 4.12, "areas_by_count": {1: 13.4, 2: 26.7, 3: 40.0, 4: 53.4, 5: 66.7, 6: 80.0, 7: 93.4, 8: 107.0, 9: 120.0, 10: 134.0, 20: 267.0}},
        "12":  {"dia_mm": 4.60, "areas_by_count": {1: 16.7, 2: 33.3, 3: 49.9, 4: 66.5, 5: 83.1, 6: 99.8, 7: 117.0, 8: 133.0, 9: 150.0, 10: 167.0, 20: 333.0}},
        "10":  {"dia_mm": 5.23, "areas_by_count": {1: 21.5, 2: 43.0, 3: 64.5, 4: 86.0, 5: 108.0, 6: 129.0, 7: 151.0, 8: 172.0, 9: 194.0, 10: 215.0, 20: 430.0}},
        "8":   {"dia_mm": 5.99, "areas_by_count": {1: 28.2, 2: 56.4, 3: 84.6, 4: 113.0, 5: 141.0, 6: 170.0, 7: 198.0, 8: 226.0, 9: 254.0, 10: 282.0, 20: 564.0}},
        "6":   {"dia_mm": 7.71, "areas_by_count": {1: 46.7, 2: 93.4, 3: 141.0, 4: 187.0, 5: 234.0, 6: 281.0, 7: 327.0, 8: 374.0, 9: 421.0, 10: 467.0, 20: 934.0}},
        "4":   {"dia_mm": 8.93, "areas_by_count": {1: 62.7, 2: 126.0, 3: 188.0, 4: 251.0, 5: 314.0, 6: 376.0, 7: 439.0, 8: 502.0, 9: 564.0, 10: 627.0, 20: 1253.0}},
        "3":   {"dia_mm": 9.64, "areas_by_count": {1: 73.0, 2: 146.0, 3: 219.0, 4: 292.0, 5: 365.0, 6: 438.0, 7: 511.0, 8: 584.0, 9: 657.0, 10: 730.0, 20: 1460.0}},
        "2":   {"dia_mm": 10.46, "areas_by_count": {1: 86.0, 2: 172.0, 3: 258.0, 4: 344.0, 5: 430.0, 6: 516.0, 7: 602.0, 8: 688.0, 9: 774.0, 10: 860.0, 20: 1719.0}},
        "1":   {"dia_mm": 12.49, "areas_by_count": {1: 123.0, 2: 246.0, 3: 368.0, 4: 491.0, 5: 613.0, 6: 736.0, 7: 858.0, 8: 981.0, 9: 1103.0, 10: 1226.0, 20: 2451.0}},
        "1/0": {"dia_mm": 13.53, "areas_by_count": {1: 144.0, 2: 288.0, 3: 432.0, 4: 576.0, 5: 719.0, 6: 863.0, 7: 1007.0, 8: 1151.0, 9: 1294.0, 10: 1438.0, 20: 2876.0}},
        "2/0": {"dia_mm": 14.70, "areas_by_count": {1: 170.0, 2: 340.0, 3: 510.0, 4: 679.0, 5: 849.0, 6: 1019.0, 7: 1189.0, 8: 1358.0, 9: 1528.0, 10: 1698.0, 20: 3395.0}},
        "3/0": {"dia_mm": 16.00, "areas_by_count": {1: 202.0, 2: 403.0, 3: 604.0, 4: 805.0, 5: 1006.0, 6: 1207.0, 7: 1408.0, 8: 1609.0, 9: 1810.0, 10: 2011.0, 20: 4022.0}},
        "4/0": {"dia_mm": 17.47, "areas_by_count": {1: 240.0, 2: 480.0, 3: 720.0, 4: 959.0, 5: 1199.0, 6: 1439.0, 7: 1678.0, 8: 1918.0, 9: 2158.0, 10: 2398.0, 20: 4795.0}},
        "250": {"dia_mm": 19.17, "areas_by_count": {1: 289.0, 2: 578.0, 3: 866.0, 4: 1155.0, 5: 1444.0, 6: 1732.0, 7: 2021.0, 8: 2310.0, 9: 2598.0, 10: 2887.0, 20: 5773.0}},
        "300": {"dia_mm": 20.56, "areas_by_count": {1: 332.0, 2: 664.0, 3: 996.0, 4: 1328.0, 5: 1660.0, 6: 1992.0, 7: 2324.0, 8: 2656.0, 9: 2988.0, 10: 3320.0, 20: 6640.0}},
        "350": {"dia_mm": 21.79, "areas_by_count": {1: 373.0, 2: 746.0, 3: 1119.0, 4: 1492.0, 5: 1865.0, 6: 2238.0, 7: 2611.0, 8: 2984.0, 9: 3357.0, 10: 3730.0, 20: 7459.0}},
        "400": {"dia_mm": 23.05, "areas_by_count": {1: 418.0, 2: 835.0, 3: 1252.0, 4: 1670.0, 5: 2087.0, 6: 2504.0, 7: 2921.0, 8: 3339.0, 9: 3756.0, 10: 4173.0, 20: 8346.0}},
        "450": {"dia_mm": 24.17, "areas_by_count": {1: 459.0, 2: 918.0, 3: 1377.0, 4: 1836.0, 5: 2295.0, 6: 2753.0, 7: 3212.0, 8: 3671.0, 9: 4130.0, 10: 4589.0, 20: 9177.0}},
        "500": {"dia_mm": 25.21, "areas_by_count": {1: 500.0, 2: 999.0, 3: 1498.0, 4: 1997.0, 5: 2496.0, 6: 2995.0, 7: 3495.0, 8: 3994.0, 9: 4493.0, 10: 4992.0, 20: 9984.0}},
        "600": {"dia_mm": 27.24, "areas_by_count": {1: 583.0, 2: 1166.0, 3: 1749.0, 4: 2332.0, 5: 2914.0, 6: 3497.0, 7: 4080.0, 8: 4663.0, 9: 5246.0, 10: 5828.0, 20: 11656.0}},
        "700": {"dia_mm": 29.05, "areas_by_count": {1: 663.0, 2: 1326.0, 3: 1989.0, 4: 2652.0, 5: 3314.0, 6: 3977.0, 7: 4640.0, 8: 5303.0, 9: 5966.0, 10: 6628.0, 20: 13256.0}},
        "750": {"dia_mm": 29.91, "areas_by_count": {1: 703.0, 2: 1406.0, 3: 2108.0, 4: 2811.0, 5: 3514.0, 6: 4216.0, 7: 4919.0, 8: 5621.0, 9: 6324.0, 10: 7027.0, 20: 14053.0}},
        "800": {"dia_mm": 30.75, "areas_by_count": {1: 743.0, 2: 1486.0, 3: 2228.0, 4: 2971.0, 5: 3714.0, 6: 4456.0, 7: 5199.0, 8: 5942.0, 9: 6684.0, 10: 7427.0, 20: 14853.0}},
        "900": {"dia_mm": 32.35, "areas_by_count": {1: 822.0, 2: 1644.0, 3: 2466.0, 4: 3288.0, 5: 4110.0, 6: 4932.0, 7: 5754.0, 8: 6576.0, 9: 7398.0, 10: 8220.0, 20: 16439.0}},
        "1000": {"dia_mm": 33.82, "areas_by_count": {1: 899.0, 2: 1797.0, 3: 2695.0, 4: 3594.0, 5: 4492.0, 6: 5390.0, 7: 6289.0, 8: 7187.0, 9: 8085.0, 10: 8984.0, 20: 17967.0}},
        "1250": {"dia_mm": 38.32, "areas_by_count": {1: 1154.0, 2: 2307.0, 3: 3460.0, 4: 4614.0, 5: 5767.0, 6: 6920.0, 7: 8074.0, 8: 9227.0, 9: 10380.0, 10: 11533.0, 20: 23066.0}},
        "1500": {"dia_mm": 41.44, "areas_by_count": {1: 1349.0, 2: 2698.0, 3: 4047.0, 4: 5395.0, 5: 6744.0, 6: 8093.0, 7: 9442.0, 8: 10790.0, 9: 12139.0, 10: 13488.0, 20: 26975.0}},
        "1750": {"dia_mm": 44.34, "areas_by_count": {1: 1545.0, 2: 3089.0, 3: 4633.0, 4: 6177.0, 5: 7721.0, 6: 9265.0, 7: 10809.0, 8: 12353.0, 9: 13898.0, 10: 15442.0, 20: 30883.0}},
        "2000": {"dia_mm": 47.03, "areas_by_count": {1: 1738.0, 2: 3475.0, 3: 5212.0, 4: 6949.0, 5: 8686.0, 6: 10423.0, 7: 12161.0, 8: 13898.0, 9: 15635.0, 10: 17372.0, 20: 34744.0}}
    },
    "solid": {
        "14": {"dia_mm": 3.91, "areas_by_count": {1: 12.1, 2: 24.1, 3: 36.1, 4: 48.1, 5: 60.1, 6: 72.1, 7: 84.1, 8: 96.1, 9: 109.0, 10: 121.0, 20: 241.0}},
        "12": {"dia_mm": 4.33, "areas_by_count": {1: 14.8, 2: 29.5, 3: 44.2, 4: 58.9, 5: 73.7, 6: 88.4, 7: 104.0, 8: 118.0, 9: 133.0, 10: 148.0, 20: 295.0}},
        "10": {"dia_mm": 4.87, "areas_by_count": {1: 18.7, 2: 37.3, 3: 55.9, 4: 74.6, 5: 93.2, 6: 112.0, 7: 131.0, 8: 150.0, 9: 168.0, 10: 187.0, 20: 373.0}}
    }
}


# --------------------------------------------------------------------------------------
# Table 6C (600 V, jacketed) — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_6C: Dict[str, Dict[str, Dict[str, Any]]] = {
    "stranded": {
        "14":  {"dia_mm": 4.12, "areas_by_count": {1: 13.4, 2: 26.7, 3: 40.0, 4: 53.4, 5: 66.7, 6: 80.0, 7: 93.4, 8: 107.0, 9: 120.0, 10: 134.0, 20: 267.0}},
        "12":  {"dia_mm": 4.60, "areas_by_count": {1: 16.7, 2: 33.3, 3: 49.9, 4: 66.5, 5: 83.1, 6: 99.8, 7: 117.0, 8: 133.0, 9: 150.0, 10: 167.0, 20: 333.0}},
        "10":  {"dia_mm": 5.23, "areas_by_count": {1: 21.5, 2: 43.0, 3: 64.5, 4: 86.0, 5: 108.0, 6: 129.0, 7: 151.0, 8: 172.0, 9: 194.0, 10: 215.0, 20: 430.0}},
        "8":   {"dia_mm": 6.75, "areas_by_count": {1: 35.8, 2: 71.6, 3: 108.0, 4: 144.0, 5: 179.0, 6: 215.0, 7: 251.0, 8: 287.0, 9: 323.0, 10: 358.0, 20: 716.0}},
        "6":   {"dia_mm": 8.47, "areas_by_count": {1: 56.4, 2: 113.0, 3: 170.0, 4: 226.0, 5: 282.0, 6: 339.0, 7: 395.0, 8: 451.0, 9: 508.0, 10: 564.0, 20: 1127.0}},
        "4":   {"dia_mm": 9.69, "areas_by_count": {1: 73.8, 2: 148.0, 3: 222.0, 4: 295.0, 5: 369.0, 6: 443.0, 7: 517.0, 8: 590.0, 9: 664.0, 10: 738.0, 20: 1475.0}},
        "3":   {"dia_mm": 10.40, "areas_by_count": {1: 85.0, 2: 170.0, 3: 255.0, 4: 340.0, 5: 425.0, 6: 510.0, 7: 595.0, 8: 680.0, 9: 765.0, 10: 850.0, 20: 1699.0}},
        "2":   {"dia_mm": 11.22, "areas_by_count": {1: 98.9, 2: 198.0, 3: 297.0, 4: 396.0, 5: 495.0, 6: 594.0, 7: 693.0, 8: 791.0, 9: 890.0, 10: 989.0, 20: 1978.0}},
        "1":   {"dia_mm": 13.51, "areas_by_count": {1: 144.0, 2: 287.0, 3: 431.0, 4: 574.0, 5: 717.0, 6: 861.0, 7: 1004.0, 8: 1147.0, 9: 1291.0, 10: 1434.0, 20: 2868.0}},
        "1/0": {"dia_mm": 14.55, "areas_by_count": {1: 167.0, 2: 333.0, 3: 499.0, 4: 666.0, 5: 832.0, 6: 998.0, 7: 1164.0, 8: 1331.0, 9: 1497.0, 10: 1663.0, 20: 3326.0}},
        "2/0": {"dia_mm": 15.72, "areas_by_count": {1: 195.0, 2: 389.0, 3: 583.0, 4: 777.0, 5: 971.0, 6: 1165.0, 7: 1359.0, 8: 1553.0, 9: 1747.0, 10: 1941.0, 20: 3882.0}},
        "3/0": {"dia_mm": 17.02, "areas_by_count": {1: 228.0, 2: 456.0, 3: 683.0, 4: 911.0, 5: 1138.0, 6: 1366.0, 7: 1593.0, 8: 1821.0, 9: 2048.0, 10: 2276.0, 20: 4551.0}},
        "4/0": {"dia_mm": 18.49, "areas_by_count": {1: 269.0, 2: 538.0, 3: 806.0, 4: 1075.0, 5: 1343.0, 6: 1612.0, 7: 1880.0, 8: 2149.0, 9: 2417.0, 10: 2686.0, 20: 5371.0}},
        "250": {"dia_mm": 21.21, "areas_by_count": {1: 354.0, 2: 707.0, 3: 1060.0, 4: 1414.0, 5: 1767.0, 6: 2120.0, 7: 2474.0, 8: 2827.0, 9: 3180.0, 10: 3534.0, 20: 7067.0}},
        "300": {"dia_mm": 22.60, "areas_by_count": {1: 402.0, 2: 803.0, 3: 1204.0, 4: 1605.0, 5: 2006.0, 6: 2407.0, 7: 2809.0, 8: 3210.0, 9: 3611.0, 10: 4012.0, 20: 8023.0}},
        "350": {"dia_mm": 23.83, "areas_by_count": {1: 447.0, 2: 893.0, 3: 1339.0, 4: 1785.0, 5: 2231.0, 6: 2677.0, 7: 3123.0, 8: 3569.0, 9: 4015.0, 10: 4461.0, 20: 8921.0}},
        "400": {"dia_mm": 25.09, "areas_by_count": {1: 495.0, 2: 989.0, 3: 1484.0, 4: 1978.0, 5: 2473.0, 6: 2967.0, 7: 3461.0, 8: 3956.0, 9: 4450.0, 10: 4945.0, 20: 9889.0}},
        "450": {"dia_mm": 26.21, "areas_by_count": {1: 540.0, 2: 1080.0, 3: 1619.0, 4: 2159.0, 5: 2698.0, 6: 3238.0, 7: 3777.0, 8: 4317.0, 9: 4856.0, 10: 5396.0, 20: 10791.0}},
        "500": {"dia_mm": 27.25, "areas_by_count": {1: 584.0, 2: 1167.0, 3: 1750.0, 4: 2333.0, 5: 2917.0, 6: 3500.0, 7: 4083.0, 8: 4666.0, 9: 5249.0, 10: 5833.0, 20: 11665.0}},
        "600": {"dia_mm": 30.04, "areas_by_count": {1: 709.0, 2: 1418.0, 3: 2127.0, 4: 2835.0, 5: 3544.0, 6: 4253.0, 7: 4962.0, 8: 5670.0, 9: 6379.0, 10: 7088.0, 20: 14175.0}},
        "700": {"dia_mm": 31.85, "areas_by_count": {1: 797.0, 2: 1594.0, 3: 2391.0, 4: 3187.0, 5: 3984.0, 6: 4781.0, 7: 5578.0, 8: 6374.0, 9: 7171.0, 10: 7968.0, 20: 15935.0}},
        "750": {"dia_mm": 32.71, "areas_by_count": {1: 841.0, 2: 1681.0, 3: 2521.0, 4: 3362.0, 5: 4202.0, 6: 5042.0, 7: 5883.0, 8: 6723.0, 9: 7563.0, 10: 8404.0, 20: 16807.0}},
        "800": {"dia_mm": 33.55, "areas_by_count": {1: 885.0, 2: 1769.0, 3: 2653.0, 4: 3537.0, 5: 4421.0, 6: 5305.0, 7: 6189.0, 8: 7073.0, 9: 7957.0, 10: 8841.0, 20: 17681.0}},
        "900": {"dia_mm": 35.15, "areas_by_count": {1: 971.0, 2: 1941.0, 3: 2912.0, 4: 3882.0, 5: 4852.0, 6: 5823.0, 7: 6793.0, 8: 7764.0, 9: 8734.0, 10: 9704.0, 20: 19408.0}},
        "1000": {"dia_mm": 36.62, "areas_by_count": {1: 1054.0, 2: 2107.0, 3: 3160.0, 4: 4213.0, 5: 5267.0, 6: 6320.0, 7: 7373.0, 8: 8426.0, 9: 9480.0, 10: 10533.0, 20: 21065.0}},
        "1250": {"dia_mm": 42.38, "areas_by_count": {1: 1411.0, 2: 2822.0, 3: 4232.0, 4: 5643.0, 5: 7054.0, 6: 8464.0, 7: 9875.0, 8: 11286.0, 9: 12696.0, 10: 14107.0, 20: 28213.0}},
        "1500": {"dia_mm": 45.50, "areas_by_count": {1: 1626.0, 2: 3252.0, 3: 4878.0, 4: 6504.0, 5: 8130.0, 6: 9756.0, 7: 11382.0, 8: 13008.0, 9: 14634.0, 10: 16260.0, 20: 32520.0}},
        "1750": {"dia_mm": 48.40, "areas_by_count": {1: 1840.0, 2: 3680.0, 3: 5520.0, 4: 7360.0, 5: 9200.0, 6: 11040.0, 7: 12879.0, 8: 14719.0, 9: 16559.0, 10: 18399.0, 20: 36797.0}},
        "2000": {"dia_mm": 51.09, "areas_by_count": {1: 2051.0, 2: 4101.0, 3: 6151.0, 4: 8201.0, 5: 10251.0, 6: 12301.0, 7: 14351.0, 8: 16401.0, 9: 18451.0, 10: 20501.0, 20: 41001.0}},
    },
    "solid": {
        "14": {"dia_mm": 3.91, "areas_by_count": {1: 12.1, 2: 24.1, 3: 36.1, 4: 48.1, 5: 60.1, 6: 72.1, 7: 84.1, 8: 96.1, 9: 109.0, 10: 121.0, 20: 241.0}},
        "12": {"dia_mm": 4.33, "areas_by_count": {1: 14.8, 2: 29.5, 3: 44.2, 4: 58.9, 5: 73.7, 6: 88.4, 7: 104.0, 8: 118.0, 9: 133.0, 10: 148.0, 20: 295.0}},
        "10": {"dia_mm": 4.87, "areas_by_count": {1: 18.7, 2: 37.3, 3: 55.9, 4: 74.6, 5: 93.2, 6: 112.0, 7: 131.0, 8: 150.0, 9: 168.0, 10: 187.0, 20: 373.0}},
    }
}


# --------------------------------------------------------------------------------------
# Table 6D (1000 V cables; TWU, TWU75, RWU90XLPE unjacketed, and RPVU90 jacketed)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_6D: Dict[str, Dict[str, Dict[str, Any]]] = {
    "stranded": {
        "14":  {"dia_mm": 4.88, "areas_by_count": {1: 18.7, 2: 37.5, 3: 56.2, 4: 74.9, 5: 93.6, 6: 113.0, 7: 131.0, 8: 150.0, 9: 169.0, 10: 188.0, 20: 375.0}},
        "12":  {"dia_mm": 5.36, "areas_by_count": {1: 22.6, 2: 45.2, 3: 67.7, 4: 90.3, 5: 113.0, 6: 136.0, 7: 158.0, 8: 181.0, 9: 204.0, 10: 226.0, 20: 452.0}},
        "10":  {"dia_mm": 5.97, "areas_by_count": {1: 28.0, 2: 56.0, 3: 84.0, 4: 112.0, 5: 140.0, 6: 168.0, 7: 196.0, 8: 224.0, 9: 252.0, 10: 280.0, 20: 560.0}},
        "8":   {"dia_mm": 7.76, "areas_by_count": {1: 47.3, 2: 94.6, 3: 142.0, 4: 190.0, 5: 237.0, 6: 284.0, 7: 332.0, 8: 379.0, 9: 426.0, 10: 473.0, 20: 946.0}},
        "6":   {"dia_mm": 8.72, "areas_by_count": {1: 59.8, 2: 120.0, 3: 180.0, 4: 239.0, 5: 299.0, 6: 359.0, 7: 419.0, 8: 478.0, 9: 538.0, 10: 598.0, 20: 1195.0}},
        "4":   {"dia_mm": 9.95, "areas_by_count": {1: 77.8, 2: 156.0, 3: 234.0, 4: 312.0, 5: 389.0, 6: 467.0, 7: 545.0, 8: 623.0, 9: 700.0, 10: 778.0, 20: 1556.0}},
        "3":   {"dia_mm": 10.67, "areas_by_count": {1: 89.5, 2: 179.0, 3: 269.0, 4: 358.0, 5: 448.0, 6: 537.0, 7: 626.0, 8: 716.0, 9: 805.0, 10: 895.0, 20: 1789.0}},
        "2":   {"dia_mm": 11.48, "areas_by_count": {1: 104.0, 2: 208.0, 3: 311.0, 4: 415.0, 5: 518.0, 6: 622.0, 7: 725.0, 8: 829.0, 9: 932.0, 10: 1036.0, 20: 2071.0}},
        "1":   {"dia_mm": 13.25, "areas_by_count": {1: 138.0, 2: 276.0, 3: 414.0, 4: 552.0, 5: 690.0, 6: 828.0, 7: 966.0, 8: 1104.0, 9: 1241.0, 10: 1379.0, 20: 2758.0}},
        "1/0": {"dia_mm": 14.28, "areas_by_count": {1: 161.0, 2: 321.0, 3: 481.0, 4: 641.0, 5: 801.0, 6: 961.0, 7: 1122.0, 8: 1282.0, 9: 1442.0, 10: 1602.0, 20: 3204.0}},
        "2/0": {"dia_mm": 15.45, "areas_by_count": {1: 188.0, 2: 375.0, 3: 563.0, 4: 750.0, 5: 938.0, 6: 1125.0, 7: 1313.0, 8: 1500.0, 9: 1688.0, 10: 1875.0, 20: 3750.0}},
        "3/0": {"dia_mm": 16.76, "areas_by_count": {1: 221.0, 2: 442.0, 3: 662.0, 4: 883.0, 5: 1104.0, 6: 1324.0, 7: 1545.0, 8: 1765.0, 9: 1986.0, 10: 2207.0, 20: 4413.0}},
        "4/0": {"dia_mm": 18.28, "areas_by_count": {1: 263.0, 2: 525.0, 3: 788.0, 4: 1050.0, 5: 1313.0, 6: 1575.0, 7: 1838.0, 8: 2100.0, 9: 2363.0, 10: 2625.0, 20: 5249.0}},
        "250": {"dia_mm": 20.20, "areas_by_count": {1: 321.0, 2: 641.0, 3: 962.0, 4: 1282.0, 5: 1603.0, 6: 1923.0, 7: 2244.0, 8: 2564.0, 9: 2885.0, 10: 3205.0, 20: 6410.0}},
        "300": {"dia_mm": 21.54, "areas_by_count": {1: 365.0, 2: 729.0, 3: 1094.0, 4: 1458.0, 5: 1823.0, 6: 2187.0, 7: 2551.0, 8: 2916.0, 9: 3280.0, 10: 3645.0, 20: 7289.0}},
        "350": {"dia_mm": 22.81, "areas_by_count": {1: 409.0, 2: 818.0, 3: 1226.0, 4: 1635.0, 5: 2044.0, 6: 2452.0, 7: 2861.0, 8: 3270.0, 9: 3678.0, 10: 4087.0, 20: 8173.0}},
        "400": {"dia_mm": 24.07, "areas_by_count": {1: 456.0, 2: 911.0, 3: 1366.0, 4: 1821.0, 5: 2276.0, 6: 2731.0, 7: 3186.0, 8: 3641.0, 9: 4096.0, 10: 4551.0, 20: 9101.0}},
        "450": {"dia_mm": 25.19, "areas_by_count": {1: 499.0, 2: 997.0, 3: 1496.0, 4: 1994.0, 5: 2492.0, 6: 2991.0, 7: 3489.0, 8: 3987.0, 9: 4486.0, 10: 4984.0, 20: 9968.0}},
        "500":  {"dia_mm": 26.24, "areas_by_count": {1: 541.0, 2: 1082.0, 3: 1623.0, 4: 2164.0, 5: 2704.0, 6: 3245.0, 7: 3786.0, 8: 4327.0, 9: 4867.0, 10: 5408.0, 20: 10816.0}},
        "600":  {"dia_mm": 29.02, "areas_by_count": {1: 662.0, 2: 1323.0, 3: 1985.0, 4: 2646.0, 5: 3308.0, 6: 3969.0, 7: 4631.0, 8: 5292.0, 9: 5953.0, 10: 6615.0, 20: 13229.0}},
        "700":  {"dia_mm": 30.82, "areas_by_count": {1: 747.0, 2: 1493.0, 3: 2239.0, 4: 2985.0, 5: 3731.0, 6: 4477.0, 7: 5223.0, 8: 5969.0, 9: 6715.0, 10: 7461.0, 20: 14921.0}},
        "750":  {"dia_mm": 31.69, "areas_by_count": {1: 789.0, 2: 1578.0, 3: 2367.0, 4: 3155.0, 5: 3944.0, 6: 4733.0, 7: 5522.0, 8: 6310.0, 9: 7099.0, 10: 7888.0, 20: 15775.0}},
        "800":  {"dia_mm": 32.53, "areas_by_count": {1: 832.0, 2: 1663.0, 3: 2494.0, 4: 3325.0, 5: 4156.0, 6: 4987.0, 7: 5818.0, 8: 6649.0, 9: 7480.0, 10: 8312.0, 20: 16623.0}},
        "900":  {"dia_mm": 34.13, "areas_by_count": {1: 915.0, 2: 1830.0, 3: 2745.0, 4: 3660.0, 5: 4575.0, 6: 5490.0, 7: 6405.0, 8: 7320.0, 9: 8234.0, 10: 9149.0, 20: 18298.0}},
        "1000": {"dia_mm": 35.60, "areas_by_count": {1: 996.0, 2: 1991.0, 3: 2987.0, 4: 3982.0, 5: 4977.0, 6: 5973.0, 7: 6968.0, 8: 7964.0, 9: 8959.0, 10: 9954.0, 20: 19908.0}},
        "1250": {"dia_mm": 39.08, "areas_by_count": {1: 1200.0, 2: 2399.0, 3: 3599.0, 4: 4798.0, 5: 5998.0, 6: 7197.0, 7: 8397.0, 8: 9596.0, 9: 10796.0, 10: 11995.0, 20: 23990.0}},
        "1500": {"dia_mm": 42.96, "areas_by_count": {1: 1450.0, 2: 2900.0, 3: 4349.0, 4: 5799.0, 5: 7248.0, 6: 8698.0, 7: 10147.0, 8: 11597.0, 9: 13046.0, 10: 14496.0, 20: 28991.0}},
        "1750": {"dia_mm": 45.86, "areas_by_count": {1: 1652.0, 2: 3304.0, 3: 4956.0, 4: 6608.0, 5: 8260.0, 6: 9911.0, 7: 11563.0, 8: 13215.0, 9: 14867.0, 10: 16519.0, 20: 33037.0}},
        "2000": {"dia_mm": 48.55, "areas_by_count": {1: 1852.0, 2: 3703.0, 3: 5554.0, 4: 7406.0, 5: 9257.0, 6: 11108.0, 7: 12959.0, 8: 14811.0, 9: 16662.0, 10: 18513.0, 20: 37026.0}},
    },
    "solid": {
        "14": {"dia_mm": 4.67, "areas_by_count": {1: 17.2, 2: 34.3, 3: 51.4, 4: 68.6, 5: 85.7, 6: 103.0, 7: 120.0, 8: 138.0, 9: 155.0, 10: 172.0, 20: 343.0}},
        "12": {"dia_mm": 5.09, "areas_by_count": {1: 20.4, 2: 40.7, 3: 61.1, 4: 81.4, 5: 102.0, 6: 123.0, 7: 143.0, 8: 163.0, 9: 184.0, 10: 204.0, 20: 407.0}},
        "10": {"dia_mm": 5.63, "areas_by_count": {1: 24.9, 2: 49.8, 3: 74.7, 4: 99.6, 5: 125.0, 6: 150.0, 7: 175.0, 8: 200.0, 9: 225.0, 10: 249.0, 20: 498.0}},
    },
}


# --------------------------------------------------------------------------------------
# Table 6E (RPVU90 unjacketed 1000 V and 2000 V cables)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_6E: Dict[str, Dict[str, Dict[str, Any]]] = {
    "stranded": {
        "14":  {"dia_mm": 4.89, "areas_by_count": {1: 18.8, 2: 37.6, 3: 56.4, 4: 75.2, 5: 93.9, 6: 113.0, 7: 132.0, 8: 151.0, 9: 170.0, 10: 188.0, 20: 376.0}},
        "12":  {"dia_mm": 5.36, "areas_by_count": {1: 22.6, 2: 45.2, 3: 67.7, 4: 90.3, 5: 113.0, 6: 136.0, 7: 158.0, 8: 181.0, 9: 204.0, 10: 226.0, 20: 452.0}},
        "10":  {"dia_mm": 5.99, "areas_by_count": {1: 28.2, 2: 56.4, 3: 84.6, 4: 113.0, 5: 141.0, 6: 170.0, 7: 198.0, 8: 226.0, 9: 254.0, 10: 282.0, 20: 564.0}},
        "8":   {"dia_mm": 7.77, "areas_by_count": {1: 47.5, 2: 94.9, 3: 143.0, 4: 190.0, 5: 238.0, 6: 285.0, 7: 332.0, 8: 380.0, 9: 427.0, 10: 475.0, 20: 949.0}},
        "6":   {"dia_mm": 8.73, "areas_by_count": {1: 59.9, 2: 120.0, 3: 180.0, 4: 240.0, 5: 300.0, 6: 360.0, 7: 420.0, 8: 479.0, 9: 539.0, 10: 599.0, 20: 1198.0}},
        "4":   {"dia_mm": 9.95, "areas_by_count": {1: 77.8, 2: 156.0, 3: 234.0, 4: 312.0, 5: 389.0, 6: 467.0, 7: 545.0, 8: 623.0, 9: 700.0, 10: 778.0, 20: 1556.0}},
        "3":   {"dia_mm": 10.66, "areas_by_count": {1: 89.3, 2: 179.0, 3: 268.0, 4: 357.0, 5: 447.0, 6: 536.0, 7: 625.0, 8: 714.0, 9: 804.0, 10: 893.0, 20: 1785.0}},
        "2":   {"dia_mm": 11.48, "areas_by_count": {1: 104.0, 2: 208.0, 3: 311.0, 4: 415.0, 5: 518.0, 6: 622.0, 7: 725.0, 8: 829.0, 9: 932.0, 10: 1036.0, 20: 2071.0}},
        "1":   {"dia_mm": 13.25, "areas_by_count": {1: 138.0, 2: 276.0, 3: 414.0, 4: 552.0, 5: 690.0, 6: 828.0, 7: 966.0, 8: 1104.0, 9: 1241.0, 10: 1379.0, 20: 2758.0}},
        "1/0": {"dia_mm": 14.27, "areas_by_count": {1: 160.0, 2: 320.0, 3: 480.0, 4: 640.0, 5: 800.0, 6: 960.0, 7: 1120.0, 8: 1280.0, 9: 1440.0, 10: 1600.0, 20: 3199.0}},
        "2/0": {"dia_mm": 15.44, "areas_by_count": {1: 188.0, 2: 375.0, 3: 562.0, 4: 749.0, 5: 937.0, 6: 1124.0, 7: 1311.0, 8: 1498.0, 9: 1686.0, 10: 1873.0, 20: 3745.0}},
        "3/0": {"dia_mm": 16.76, "areas_by_count": {1: 221.0, 2: 442.0, 3: 662.0, 4: 883.0, 5: 1104.0, 6: 1324.0, 7: 1545.0, 8: 1765.0, 9: 1986.0, 10: 2207.0, 20: 4413.0}},
        "4/0": {"dia_mm": 18.23, "areas_by_count": {1: 262.0, 2: 523.0, 3: 784.0, 4: 1045.0, 5: 1306.0, 6: 1567.0, 7: 1828.0, 8: 2089.0, 9: 2350.0, 10: 2611.0, 20: 5221.0}},
        "250": {"dia_mm": 20.18, "areas_by_count": {1: 320.0, 2: 640.0, 3: 960.0, 4: 1280.0, 5: 1600.0, 6: 1920.0, 7: 2239.0, 8: 2559.0, 9: 2879.0, 10: 3199.0, 20: 6397.0}},
        "300": {"dia_mm": 21.58, "areas_by_count": {1: 366.0, 2: 732.0, 3: 1098.0, 4: 1464.0, 5: 1829.0, 6: 2195.0, 7: 2561.0, 8: 2927.0, 9: 3292.0, 10: 3658.0, 20: 7316.0}},
        "350": {"dia_mm": 22.88, "areas_by_count": {1: 412.0, 2: 823.0, 3: 1234.0, 4: 1645.0, 5: 2056.0, 6: 2467.0, 7: 2879.0, 8: 3290.0, 9: 3701.0, 10: 4112.0, 20: 8224.0}},
        "400": {"dia_mm": 24.07, "areas_by_count": {1: 456.0, 2: 911.0, 3: 1366.0, 4: 1821.0, 5: 2276.0, 6: 2731.0, 7: 3186.0, 8: 3641.0, 9: 4096.0, 10: 4551.0, 20: 9101.0}},
        "450": {"dia_mm": 25.19, "areas_by_count": {1: 499.0, 2: 997.0, 3: 1496.0, 4: 1994.0, 5: 2492.0, 6: 2991.0, 7: 3489.0, 8: 3987.0, 9: 4486.0, 10: 4984.0, 20: 9968.0}},
        "500": {"dia_mm": 26.23, "areas_by_count": {1: 541.0, 2: 1081.0, 3: 1622.0, 4: 2162.0, 5: 2702.0, 6: 3243.0, 7: 3783.0, 8: 4323.0, 9: 4864.0, 10: 5404.0, 20: 10808.0}},
        "600": {"dia_mm": 29.04, "areas_by_count": {1: 663.0, 2: 1325.0, 3: 1988.0, 4: 2650.0, 5: 3312.0, 6: 3975.0, 7: 4637.0, 8: 5299.0, 9: 5962.0, 10: 6624.0, 20: 13247.0}},
        "700": {"dia_mm": 30.85, "areas_by_count": {1: 748.0, 2: 1495.0, 3: 2243.0, 4: 2990.0, 5: 3738.0, 6: 4485.0, 7: 5233.0, 8: 5980.0, 9: 6728.0, 10: 7475.0, 20: 14950.0}},
        "750": {"dia_mm": 31.71, "areas_by_count": {1: 790.0, 2: 1580.0, 3: 2370.0, 4: 3159.0, 5: 3949.0, 6: 4739.0, 7: 5529.0, 8: 6318.0, 9: 7108.0, 10: 7898.0, 20: 15795.0}},
        "800": {"dia_mm": 32.52, "areas_by_count": {1: 831.0, 2: 1662.0, 3: 2492.0, 4: 3323.0, 5: 4153.0, 6: 4984.0, 7: 5815.0, 8: 6645.0, 9: 7476.0, 10: 8306.0, 20: 16612.0}},
        "900": {"dia_mm": 34.15, "areas_by_count": {1: 916.0, 2: 1832.0, 3: 2748.0, 4: 3664.0, 5: 4580.0, 6: 5496.0, 7: 6412.0, 8: 7328.0, 9: 8244.0, 10: 9160.0, 20: 18319.0}},
        "1000": {"dia_mm": 35.62, "areas_by_count": {1: 997.0, 2: 1993.0, 3: 2990.0, 4: 3986.0, 5: 4983.0, 6: 5980.0, 7: 6976.0, 8: 7973.0, 9: 8969.0, 10: 9966.0, 20: 19931.0}},
        "1250": {"dia_mm": 39.86, "areas_by_count": {1: 1248.0, 2: 2496.0, 3: 3744.0, 4: 4992.0, 5: 6240.0, 6: 7488.0, 7: 8735.0, 8: 9983.0, 9: 11231.0, 10: 12479.0, 20: 24958.0}},
        "1500": {"dia_mm": 42.98, "areas_by_count": {1: 1451.0, 2: 2902.0, 3: 4353.0, 4: 5804.0, 5: 7255.0, 6: 8706.0, 7: 10156.0, 8: 11607.0, 9: 13058.0, 10: 14509.0, 20: 29018.0}},
        "1750": {"dia_mm": 45.88, "areas_by_count": {1: 1654.0, 2: 3307.0, 3: 4960.0, 4: 6613.0, 5: 8267.0, 6: 9920.0, 7: 11573.0, 8: 13226.0, 9: 14880.0, 10: 16533.0, 20: 33065.0}},
        "2000": {"dia_mm": 48.57, "areas_by_count": {1: 1853.0, 2: 3706.0, 3: 5559.0, 4: 7412.0, 5: 9264.0, 6: 11117.0, 7: 12970.0, 8: 14823.0, 9: 16676.0, 10: 18528.0, 20: 37056.0}},
    }
}


# --------------------------------------------------------------------------------------
# Table 6F (RPVU90 jacketed 1000 V and 2000 V cables)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_6F: Dict[str, Dict[str, Dict[str, Any]]] = {
    "stranded": {
        "14":  {"dia_mm": 5.65, "areas_by_count": {1: 25.1, 2: 50.2, 3: 75.3, 4: 101.0, 5: 126.0, 6: 151.0, 7: 176.0, 8: 201.0, 9: 226.0, 10: 251.0, 20: 502.0}},
        "12":  {"dia_mm": 6.12, "areas_by_count": {1: 29.5, 2: 58.9, 3: 88.3, 4: 118.0, 5: 148.0, 6: 177.0, 7: 206.0, 8: 236.0, 9: 265.0, 10: 295.0, 20: 589.0}},
        "10":  {"dia_mm": 6.75, "areas_by_count": {1: 35.8, 2: 71.6, 3: 108.0, 4: 144.0, 5: 179.0, 6: 215.0, 7: 251.0, 8: 287.0, 9: 323.0, 10: 358.0, 20: 716.0}},
        "8":   {"dia_mm": 9.29, "areas_by_count": {1: 67.8, 2: 136.0, 3: 204.0, 4: 272.0, 5: 339.0, 6: 407.0, 7: 475.0, 8: 543.0, 9: 611.0, 10: 678.0, 20: 1356.0}},
        "6":   {"dia_mm": 10.25, "areas_by_count": {1: 82.6, 2: 166.0, 3: 248.0, 4: 331.0, 5: 413.0, 6: 496.0, 7: 578.0, 8: 661.0, 9: 743.0, 10: 826.0, 20: 1651.0}},
        "4":   {"dia_mm": 11.47, "areas_by_count": {1: 104.0, 2: 207.0, 3: 310.0, 4: 414.0, 5: 517.0, 6: 620.0, 7: 724.0, 8: 827.0, 9: 930.0, 10: 1034.0, 20: 2067.0}},
        "3":   {"dia_mm": 12.18, "areas_by_count": {1: 117.0, 2: 234.0, 3: 350.0, 4: 467.0, 5: 583.0, 6: 700.0, 7: 816.0, 8: 933.0, 9: 1049.0, 10: 1166.0, 20: 2331.0}},
        "2":   {"dia_mm": 13.76, "areas_by_count": {1: 149.0, 2: 298.0, 3: 447.0, 4: 595.0, 5: 744.0, 6: 893.0, 7: 1041.0, 8: 1190.0, 9: 1339.0, 10: 1488.0, 20: 2975.0}},
        "1":   {"dia_mm": 15.53, "areas_by_count": {1: 190.0, 2: 379.0, 3: 569.0, 4: 758.9, 5: 948.0, 6: 1137.0, 7: 1326.0, 8: 1516.0, 9: 1705.0, 10: 1895.0, 20: 3789.0}},
        "1/0": {"dia_mm": 16.55, "areas_by_count": {1: 216.0, 2: 431.0, 3: 646.0, 4: 861.0, 5: 1076.0, 6: 1291.0, 7: 1506.0, 8: 1721.0, 9: 1937.0, 10: 2152.0, 20: 4303.0}},
        "2/0": {"dia_mm": 17.72, "areas_by_count": {1: 247.0, 2: 494.0, 3: 740.0, 4: 987.0, 5: 1234.0, 6: 1480.0, 7: 1727.0, 8: 1973.0, 9: 2220.0, 10: 2467.0, 20: 4933.0}},
        "3/0": {"dia_mm": 19.04, "areas_by_count": {1: 285.0, 2: 570.0, 3: 855.0, 4: 1139.0, 5: 1424.0, 6: 1709.0, 7: 1994.0, 8: 2278.0, 9: 2563.0, 10: 2848.0, 20: 5695.0}},
        "4/0": {"dia_mm": 21.53, "areas_by_count": {1: 365.0, 2: 729.0, 3: 1093.0, 4: 1457.0, 5: 1821.0, 6: 2185.0, 7: 2549.0, 8: 2913.0, 9: 3277.0, 10: 3641.0, 20: 7282.0}},
        "250": {"dia_mm": 23.48, "areas_by_count": {1: 433.0, 2: 866.0, 3: 1299.0, 4: 1732.0, 5: 2165.0, 6: 2598.0, 7: 3031.0, 8: 3464.0, 9: 3897.0, 10: 4330.0, 20: 8660.0}},
        "300": {"dia_mm": 24.88, "areas_by_count": {1: 487.0, 2: 973.0, 3: 1459.0, 4: 1945.0, 5: 2431.0, 6: 2918.4, 7: 3403.0, 8: 3890.0, 9: 4376.0, 10: 4862.0, 20: 9724.0}},
        "350": {"dia_mm": 26.18, "areas_by_count": {1: 539.0, 2: 1077.0, 3: 1615.0, 4: 2154.0, 5: 2692.0, 6: 3230.0, 7: 3769.0, 8: 4307.0, 9: 4845.0, 10: 5384.0, 20: 10767.0}},
        "400": {"dia_mm": 27.37, "areas_by_count": {1: 589.0, 2: 1177.0, 3: 1766.0, 4: 2354.0, 5: 2942.0, 6: 3531.0, 7: 4119.0, 8: 4707.0, 9: 5296.0, 10: 5884.0, 20: 11768.0}},
        "450": {"dia_mm": 28.49, "areas_by_count": {1: 638.0, 2: 1275.0, 3: 1913.0, 4: 2550.0, 5: 3188.0, 6: 3825.0, 7: 4463.0, 8: 5100.0, 9: 5738.0, 10: 6375.0, 20: 12750.0}},
        "500": {"dia_mm": 29.53, "areas_by_count": {1: 685.0, 2: 1370.0, 3: 2055.0, 4: 2740.0, 5: 3425.0, 6: 4110.0, 7: 4795.0, 8: 5480.0, 9: 6164.0, 10: 6849.0, 20: 13698.0}},
        "600": {"dia_mm": 32.34, "areas_by_count": {1: 822.0, 2: 1643.0, 3: 2465.0, 4: 3286.0, 5: 4108.0, 6: 4929.0, 7: 5751.0, 8: 6572.0, 9: 7393.0, 10: 8215.0, 20: 16429.0}},
        "700": {"dia_mm": 34.15, "areas_by_count": {1: 916.0, 2: 1832.0, 3: 2748.0, 4: 3664.0, 5: 4580.0, 6: 5496.0, 7: 6412.0, 8: 7328.0, 9: 8244.0, 10: 9160.0, 20: 18319.0}},
        "750": {"dia_mm": 35.01, "areas_by_count": {1: 963.0, 2: 1926.0, 3: 2888.0, 4: 3851.0, 5: 4814.0, 6: 5776.0, 7: 6739.0, 8: 7702.0, 9: 8664.0, 10: 9627.0, 20: 19254.0}},
        "800": {"dia_mm": 35.82, "areas_by_count": {1: 1008.0, 2: 2016.0, 3: 3024.0, 4: 4031.0, 5: 5039.1, 6: 6047.0, 7: 7055.0, 8: 8062.0, 9: 9070.0, 10: 10078.0, 20: 20155.0}},
        "900": {"dia_mm": 37.45, "areas_by_count": {1: 1102.0, 2: 2204.0, 3: 3305.0, 4: 4407.0, 5: 5508.0, 6: 6610.0, 7: 7711.0, 8: 8813.0, 9: 9914.0, 10: 11016.0, 20: 22031.0}},
        "1000": {"dia_mm": 38.92, "areas_by_count": {1: 1190.0, 2: 2380.0, 3: 3570.0, 4: 4759.0, 5: 5949.0, 6: 7139.0, 7: 8328.0, 8: 9518.0, 9: 10708.0, 10: 11897.0, 20: 23794.0}},
        "1250": {"dia_mm": 44.68, "areas_by_count": {1: 1568.0, 2: 3136.0, 3: 4704.0, 4: 6272.0, 5: 7840.0, 6: 9408.0, 7: 10976.0, 8: 12544.0, 9: 14112.0, 10: 15679.0, 20: 31358.0}},
        "1500": {"dia_mm": 47.80, "areas_by_count": {1: 1795.0, 2: 3590.0, 3: 5384.0, 4: 7179.0, 5: 8973.0, 6: 10768.0, 7: 12562.0, 8: 14357.0, 9: 16151.0, 10: 17946.0, 20: 35891.0}},
        "1750": {"dia_mm": 50.70, "areas_by_count": {1: 2019.0, 2: 4038.0, 3: 6057.0, 4: 8076.0, 5: 10095.0, 6: 12114.0, 7: 14133.0, 8: 16151.0, 9: 18170.0, 10: 20189.0, 20: 40378.0}},
        "2000": {"dia_mm": 53.39, "areas_by_count": {1: 2239.0, 2: 4478.0, 3: 6717.0, 4: 8956.0, 5: 11194.0, 6: 13433.0, 7: 15672.0, 8: 17911.0, 9: 20149.0, 10: 22388.0, 20: 44776.0}},
    }
}


# --------------------------------------------------------------------------------------
# Table 6G (RPV90 unjacketed 2000 V conductors)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_6G: Dict[str, Dict[str, Dict[str, Any]]] = {
    "stranded": {
        "14":  {"dia_mm": 4.89, "areas_by_count": {1: 18.8, 2: 37.6, 3: 56.4, 4: 75.2, 5: 93.9, 6: 113.0, 7: 132.0, 8: 151.0, 9: 170.0, 10: 188.0, 20: 376.0}},
        "12":  {"dia_mm": 5.36, "areas_by_count": {1: 22.6, 2: 45.2, 3: 67.7, 4: 90.3, 5: 113.0, 6: 136.0, 7: 158.0, 8: 181.0, 9: 204.0, 10: 226.0, 20: 452.0}},
        "10":  {"dia_mm": 5.99, "areas_by_count": {1: 28.2, 2: 56.4, 3: 84.6, 4: 113.0, 5: 141.0, 6: 170.0, 7: 198.0, 8: 226.0, 9: 254.0, 10: 282.0, 20: 564.0}},
        "8":   {"dia_mm": 7.27, "areas_by_count": {1: 41.6, 2: 83.1, 3: 125.0, 4: 167.0, 5: 208.0, 6: 250.0, 7: 291.0, 8: 333.0, 9: 374.0, 10: 416.0, 20: 831.0}},
        "6":   {"dia_mm": 8.23, "areas_by_count": {1: 53.2, 2: 107.0, 3: 160.0, 4: 213.0, 5: 266.0, 6: 320.0, 7: 373.0, 8: 426.0, 9: 479.0, 10: 532.0, 20: 1064.0}},
        "4":   {"dia_mm": 9.45, "areas_by_count": {1: 70.2, 2: 141.0, 3: 211.0, 4: 281.0, 5: 351.0, 6: 421.0, 7: 491.0, 8: 562.0, 9: 632.0, 10: 702.0, 20: 1403.0}},
        "3":   {"dia_mm": 10.16, "areas_by_count": {1: 81.1, 2: 163.0, 3: 244.0, 4: 325.0, 5: 406.0, 6: 487.0, 7: 568.0, 8: 649.0, 9: 730.0, 10: 811.0, 20: 1622.0}},
        "2":   {"dia_mm": 10.98, "areas_by_count": {1: 94.7, 2: 190.0, 3: 285.0, 4: 379.0, 5: 474.0, 6: 569.0, 7: 663.0, 8: 758.0, 9: 853.0, 10: 947.0, 20: 1894.0}},
        "1":   {"dia_mm": 13.01, "areas_by_count": {1: 133.0, 2: 266.0, 3: 399.0, 4: 532.0, 5: 665.0, 6: 798.0, 7: 931.0, 8: 1064.0, 9: 1197.0, 10: 1330.0, 20: 2659.0}},
        "1/0": {"dia_mm": 14.03, "areas_by_count": {1: 155.0, 2: 310.0, 3: 464.0, 4: 619.0, 5: 773.0, 6: 928.0, 7: 1083.0, 8: 1237.0, 9: 1392.0, 10: 1546.0, 20: 3092.0}},
        "2/0": {"dia_mm": 15.20, "areas_by_count": {1: 182.0, 2: 363.0, 3: 545.0, 4: 726.0, 5: 908.0, 6: 1089.0, 7: 1271.0, 8: 1452.0, 9: 1634.0, 10: 1815.0, 20: 3630.0}},
        "3/0": {"dia_mm": 16.52, "areas_by_count": {1: 215.0, 2: 429.0, 3: 644.0, 4: 858.0, 5: 1072.0, 6: 1287.0, 7: 1501.0, 8: 1715.0, 9: 1930.0, 10: 2144.0, 20: 4287.0}},
        "4/0": {"dia_mm": 17.99, "areas_by_count": {1: 255.0, 2: 509.0, 3: 763.0, 4: 1017.0, 5: 1271.0, 6: 1526.0, 7: 1780.0, 8: 2034.0, 9: 2288.0, 10: 2542.0, 20: 5084.0}},
        "250": {"dia_mm": 19.94, "areas_by_count": {1: 313.0, 2: 625.0, 3: 937.0, 4: 1250.0, 5: 1562.0, 6: 1874.0, 7: 2186.0, 8: 2499.0, 9: 2811.0, 10: 3123.0, 20: 6246.0}},
        "300": {"dia_mm": 21.34, "areas_by_count": {1: 358.0, 2: 716.0, 3: 1074.0, 4: 1431.0, 5: 1789.0, 6: 2147.0, 7: 2504.0, 8: 2862.0, 9: 3220.0, 10: 3577.0, 20: 7154.0}},
        "350": {"dia_mm": 22.64, "areas_by_count": {1: 403.0, 2: 806.0, 3: 1208.0, 4: 1611.0, 5: 2013.0, 6: 2416.0, 7: 2818.0, 8: 3221.0, 9: 3624.0, 10: 4026.0, 20: 8052.0}},
        "400": {"dia_mm": 23.83, "areas_by_count": {1: 447.0, 2: 893.0, 3: 1339.0, 4: 1785.0, 5: 2231.0, 6: 2677.0, 7: 3123.0, 8: 3569.0, 9: 4015.0, 10: 4461.0, 20: 8921.0}},
        "450": {"dia_mm": 24.95, "areas_by_count": {1: 489.0, 2: 978.0, 3: 1467.0, 4: 1956.0, 5: 2445.0, 6: 2934.0, 7: 3423.0, 8: 3912.0, 9: 4401.0, 10: 4890.0, 20: 9779.0}},
        "500": {"dia_mm": 25.99, "areas_by_count": {1: 531.0, 2: 1062.0, 3: 1592.0, 4: 2123.0, 5: 2653.0, 6: 3184.0, 7: 3714.0, 8: 4245.0, 9: 4775.0, 10: 5306.0, 20: 10611.0}},
        "600": {"dia_mm": 28.78, "areas_by_count": {1: 651.0, 2: 1302.0, 3: 1952.0, 4: 2603.0, 5: 3253.0, 6: 3904.0, 7: 4554.0, 8: 5205.0, 9: 5855.0, 10: 6506.0, 20: 13011.0}},
        "700": {"dia_mm": 30.59, "areas_by_count": {1: 735.0, 2: 1470.0, 3: 2205.0, 4: 2940.0, 5: 3675.0, 6: 4410.0, 7: 5145.0, 8: 5880.0, 9: 6615.0, 10: 7350.0, 20: 14699.0}},
        "750": {"dia_mm": 31.45, "areas_by_count": {1: 777.0, 2: 1554.0, 3: 2331.0, 4: 3108.0, 5: 3885.0, 6: 4662.0, 7: 5438.0, 8: 6215.0, 9: 6992.0, 10: 7769.0, 20: 15537.0}},
        "800": {"dia_mm": 32.26, "areas_by_count": {1: 818.0, 2: 1635.0, 3: 2453.0, 4: 3270.0, 5: 4087.0, 6: 4905.0, 7: 5722.0, 8: 6539.0, 9: 7357.0, 10: 8174.0, 20: 16348.0}},
        "900": {"dia_mm": 33.89, "areas_by_count": {1: 903.0, 2: 1805.0, 3: 2707.0, 4: 3609.0, 5: 4511.0, 6: 5413.0, 7: 6315.0, 8: 7217.0, 9: 8119.0, 10: 9021.0, 20: 18042.0}},
        "1000": {"dia_mm": 35.36, "areas_by_count": {1: 983.0, 2: 1965.0, 3: 2947.0, 4: 3929.0, 5: 4911.0, 6: 5893.0, 7: 6875.0, 8: 7857.0, 9: 8839.0, 10: 9821.0, 20: 19641.0}},
        "1250": {"dia_mm": 39.86, "areas_by_count": {1: 1248.0, 2: 2496.0, 3: 3744.0, 4: 4992.0, 5: 6240.0, 6: 7488.0, 7: 8735.0, 8: 9983.0, 9: 11231.0, 10: 12479.0, 20: 24958.0}},
        "1500": {"dia_mm": 42.98, "areas_by_count": {1: 1451.0, 2: 2902.0, 3: 4353.0, 4: 5804.0, 5: 7255.0, 6: 8706.0, 7: 10156.0, 8: 11607.0, 9: 13058.0, 10: 14509.0, 20: 29018.0}},
        "1750": {"dia_mm": 45.88, "areas_by_count": {1: 1654.0, 2: 3307.0, 3: 4960.0, 4: 6613.0, 5: 8267.0, 6: 9920.0, 7: 11573.0, 8: 13226.0, 9: 14880.0, 10: 16533.0, 20: 33065.0}},
        "2000": {"dia_mm": 48.57, "areas_by_count": {1: 1853.0, 2: 3706.0, 3: 5559.0, 4: 7412.0, 5: 9264.0, 6: 11117.0, 7: 12970.0, 8: 14823.0, 9: 16676.0, 10: 18528.0, 20: 37056.0}},
    }
}


# --------------------------------------------------------------------------------------
# Table 6H (RPV90 jacketed 1000 V insulated conductors)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_6H: Dict[str, Dict[str, Dict[str, Any]]] = {
    "stranded": {
        "14":  {"dia_mm": 4.89, "areas_by_count": {1: 18.8, 2: 37.6, 3: 56.4, 4: 75.2, 5: 93.9, 6: 113.0, 7: 132.0, 8: 151.0, 9: 170.0, 10: 188.0, 20: 376.0}},
        "12":  {"dia_mm": 5.36, "areas_by_count": {1: 22.6, 2: 45.2, 3: 67.7, 4: 90.3, 5: 113.0, 6: 136.0, 7: 158.0, 8: 181.0, 9: 204.0, 10: 226.0, 20: 452.0}},
        "10":  {"dia_mm": 5.99, "areas_by_count": {1: 28.2, 2: 56.4, 3: 84.6, 4: 113.0, 5: 141.0, 6: 170.0, 7: 198.0, 8: 226.0, 9: 254.0, 10: 282.0, 20: 564.0}},
        "8":   {"dia_mm": 7.51, "areas_by_count": {1: 44.3, 2: 88.6, 3: 133.0, 4: 178.0, 5: 222.0, 6: 266.0, 7: 311.0, 8: 355.0, 9: 399.0, 10: 443.0, 20: 886.0}},
        "6":   {"dia_mm": 9.23, "areas_by_count": {1: 67.0, 2: 134.0, 3: 201.0, 4: 268.0, 5: 335.0, 6: 402.0, 7: 469.0, 8: 536.0, 9: 603.0, 10: 670.0, 20: 1339.0}},
        "4":   {"dia_mm": 10.45, "areas_by_count": {1: 85.8, 2: 172.0, 3: 258.0, 4: 344.0, 5: 429.0, 6: 515.0, 7: 601.0, 8: 687.0, 9: 772.0, 10: 858.0, 20: 1716.0}},
        "3":   {"dia_mm": 11.16, "areas_by_count": {1: 97.9, 2: 196.0, 3: 294.0, 4: 392.0, 5: 490.0, 6: 587.0, 7: 685.0, 8: 783.0, 9: 881.0, 10: 979.0, 20: 1957.0}},
        "2":   {"dia_mm": 11.98, "areas_by_count": {1: 113.0, 2: 226.0, 3: 339.0, 4: 451.0, 5: 564.0, 6: 677.0, 7: 790.0, 8: 902.0, 9: 1015.0, 10: 1128.0, 20: 2255.0}},
        "1":   {"dia_mm": 14.77, "areas_by_count": {1: 172.0, 2: 343.0, 3: 515.0, 4: 686.0, 5: 857.0, 6: 1029.0, 7: 1200.0, 8: 1371.0, 9: 1543.0, 10: 1714.0, 20: 3427.0}},
        "1/0": {"dia_mm": 15.79, "areas_by_count": {1: 196.0, 2: 392.0, 3: 588.0, 4: 784.0, 5: 980.0, 6: 1175.0, 7: 1371.0, 8: 1567.0, 9: 1763.0, 10: 1959.0, 20: 3917.0}},
        "2/0": {"dia_mm": 16.96, "areas_by_count": {1: 226.0, 2: 452.0, 3: 678.0, 4: 904.0, 5: 1130.0, 6: 1356.0, 7: 1582.0, 8: 1808.0, 9: 2034.0, 10: 2260.0, 20: 4519.0}},
        "3/0": {"dia_mm": 18.28, "areas_by_count": {1: 263.0, 2: 525.0, 3: 788.0, 4: 1050.0, 5: 1313.0, 6: 1575.0, 7: 1838.0, 8: 2100.0, 9: 2363.0, 10: 2625.0, 20: 5249.0}},
        "4/0": {"dia_mm": 19.75, "areas_by_count": {1: 307.0, 2: 613.0, 3: 920.0, 4: 1226.0, 5: 1532.0, 6: 1839.0, 7: 2145.0, 8: 2451.0, 9: 2758.0, 10: 3064.0, 20: 6128.0}},
        "250": {"dia_mm": 22.46, "areas_by_count": {1: 397.0, 2: 793.0, 3: 1189.0, 4: 1585.0, 5: 1981.0, 6: 2378.0, 7: 2774.0, 8: 3170.0, 9: 3566.0, 10: 3962.0, 20: 7924.0}},
        "300": {"dia_mm": 23.86, "areas_by_count": {1: 448.0, 2: 895.0, 3: 1342.0, 4: 1789.0, 5: 2236.0, 6: 2683.0, 7: 3130.0, 8: 3578.0, 9: 4025.0, 10: 4472.0, 20: 8943.0}},
        "350": {"dia_mm": 25.16, "areas_by_count": {1: 498.0, 2: 995.0, 3: 1492.0, 4: 1989.0, 5: 2486.0, 6: 2984.0, 7: 3481.0, 8: 3978.0, 9: 4475.0, 10: 4972.0, 20: 9944.0}},
        "400": {"dia_mm": 26.35, "areas_by_count": {1: 546.0, 2: 1091.0, 3: 1636.0, 4: 2182.0, 5: 2727.0, 6: 3272.0, 7: 3818.0, 8: 4363.0, 9: 4908.0, 10: 5454.0, 20: 10907.0}},
        "450": {"dia_mm": 27.47, "areas_by_count": {1: 593.0, 2: 1186.0, 3: 1778.0, 4: 2371.0, 5: 2964.0, 6: 3556.0, 7: 4149.0, 8: 4742.0, 9: 5334.0, 10: 5927.0, 20: 11854.0}},
        "500": {"dia_mm": 28.51, "areas_by_count": {1: 639.0, 2: 1277.0, 3: 1916.0, 4: 2554.0, 5: 3192.0, 6: 3831.0, 7: 4469.0, 8: 5108.0, 9: 5746.0, 10: 6384.0, 20: 12768.0}},
        "600": {"dia_mm": 30.54, "areas_by_count": {1: 733.0, 2: 1466.0, 3: 2198.0, 4: 2931.0, 5: 3663.0, 6: 4396.0, 7: 5128.0, 8: 5861.0, 9: 6593.0, 10: 7326.0, 20: 14651.0}},
        "700": {"dia_mm": 32.35, "areas_by_count": {1: 822.0, 2: 1644.0, 3: 2466.0, 4: 3288.0, 5: 4110.0, 6: 4932.0, 7: 5754.0, 8: 6576.0, 9: 7398.0, 10: 8220.0, 20: 16439.0}},
        "750": {"dia_mm": 33.21, "areas_by_count": {1: 867.0, 2: 1733.0, 3: 2599.0, 4: 3465.0, 5: 4332.0, 6: 5198.0, 7: 6064.0, 8: 6930.0, 9: 7796.0, 10: 8663.0, 20: 17325.0}},
        "800": {"dia_mm": 34.02, "areas_by_count": {1: 909.0, 2: 1818.0, 3: 2727.0, 4: 3636.0, 5: 4545.0, 6: 5454.0, 7: 6363.0, 8: 7272.0, 9: 8181.0, 10: 9090.0, 20: 18180.0}},
        "900": {"dia_mm": 35.65, "areas_by_count": {1: 999.0, 2: 1997.0, 3: 2995.0, 4: 3993.0, 5: 4991.0, 6: 5990.0, 7: 6988.0, 8: 7986.0, 9: 8984.0, 10: 9982.0, 20: 19964.0}},
        "1000": {"dia_mm": 37.12, "areas_by_count": {1: 1083.0, 2: 2165.0, 3: 3247.0, 4: 4329.0, 5: 5411.0, 6: 6494.0, 7: 7576.0, 8: 8658.0, 9: 9740.0, 10: 10822.0, 20: 21644.0}},
        "1250": {"dia_mm": 43.14, "areas_by_count": {1: 1462.0, 2: 2924.0, 3: 4386.0, 4: 5847.0, 5: 7309.0, 6: 8771.0, 7: 10232.0, 8: 11694.0, 9: 13156.0, 10: 14617.0, 20: 29234.0}},
        "1500": {"dia_mm": 46.26, "areas_by_count": {1: 1681.0, 2: 3362.0, 3: 5043.0, 4: 6723.0, 5: 8404.0, 6: 10085.0, 7: 11766.0, 8: 13446.0, 9: 15127.0, 10: 16808.0, 20: 33615.0}},
        "1750": {"dia_mm": 49.16, "areas_by_count": {1: 1899.0, 2: 3797.0, 3: 5695.0, 4: 7593.0, 5: 9491.0, 6: 11389.0, 7: 13287.0, 8: 15185.0, 9: 17083.0, 10: 18981.0, 20: 37962.0}},
        "2000": {"dia_mm": 51.85, "areas_by_count": {1: 2112.0, 2: 4223.0, 3: 6335.0, 4: 8446.0, 5: 10558.0, 6: 12669.0, 7: 14781.0, 8: 16892.0, 9: 19004.0, 10: 21115.0, 20: 42230.0}},
    }
}


# --------------------------------------------------------------------------------------
# Table 6I (RPV90 jacketed 2000 V insulated conductors)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_6I: Dict[str, Dict[str, Dict[str, Any]]] = {
    "stranded": {
        "14":  {"dia_mm": 5.65, "areas_by_count": {1: 25.1, 2: 50.2, 3: 75.3, 4: 101.0, 5: 126.0, 6: 151.0, 7: 176.0, 8: 201.0, 9: 226.0, 10: 251.0, 20: 502.0}},
        "12":  {"dia_mm": 6.12, "areas_by_count": {1: 29.5, 2: 58.9, 3: 88.3, 4: 118.0, 5: 148.0, 6: 177.0, 7: 206.0, 8: 236.0, 9: 265.0, 10: 295.0, 20: 589.0}},
        "10":  {"dia_mm": 7.51, "areas_by_count": {1: 44.3, 2: 88.6, 3: 133.0, 4: 178.0, 5: 222.0, 6: 266.0, 7: 311.0, 8: 355.0, 9: 399.0, 10: 443.0, 20: 886.0}},
        "8":   {"dia_mm": 8.79, "areas_by_count": {1: 60.7, 2: 122.0, 3: 183.0, 4: 243.0, 5: 304.0, 6: 365.0, 7: 425.0, 8: 486.0, 9: 547.0, 10: 607.0, 20: 1214.0}},
        "6":   {"dia_mm": 9.75, "areas_by_count": {1: 74.7, 2: 150.0, 3: 224.0, 4: 299.0, 5: 374.0, 6: 448.0, 7: 523.0, 8: 598.0, 9: 672.0, 10: 747.0, 20: 1494.0}},
        "4":   {"dia_mm": 10.97, "areas_by_count": {1: 94.6, 2: 190.0, 3: 284.0, 4: 379.0, 5: 473.0, 6: 568.0, 7: 662.0, 8: 757.0, 9: 851.0, 10: 946.0, 20: 1891.0}},
        "3":   {"dia_mm": 11.68, "areas_by_count": {1: 108.0, 2: 215.0, 3: 322.0, 4: 429.0, 5: 536.0, 6: 643.0, 7: 751.0, 8: 858.0, 9: 965.0, 10: 1072.0, 20: 2143.0}},
        "2":   {"dia_mm": 13.26, "areas_by_count": {1: 139.0, 2: 277.0, 3: 415.0, 4: 553.0, 5: 691.0, 6: 829.0, 7: 967.0, 8: 1105.0, 9: 1243.0, 10: 1381.0, 20: 2762.0}},
        "1":   {"dia_mm": 15.29, "areas_by_count": {1: 184.0, 2: 368.0, 3: 551.0, 4: 735.0, 5: 919.0, 6: 1102.0, 7: 1286.0, 8: 1469.0, 9: 1653.0, 10: 1837.0, 20: 3673.0}},
        "1/0": {"dia_mm": 16.31, "areas_by_count": {1: 209.0, 2: 418.0, 3: 627.0, 4: 836.0, 5: 1045.0, 6: 1254.0, 7: 1463.0, 8: 1672.0, 9: 1881.0, 10: 2090.0, 20: 4179.0}},
        "2/0": {"dia_mm": 17.48, "areas_by_count": {1: 240.0, 2: 480.0, 3: 720.0, 4: 960.0, 5: 1200.0, 6: 1440.0, 7: 1680.0, 8: 1920.0, 9: 2160.0, 10: 2400.0, 20: 4800.0}},
        "3/0": {"dia_mm": 18.80, "areas_by_count": {1: 278.0, 2: 556.0, 3: 833.0, 4: 1111.0, 5: 1388.0, 6: 1666.0, 7: 1944.0, 8: 2221.0, 9: 2499.0, 10: 2776.0, 20: 5552.0}},
        "4/0": {"dia_mm": 21.29, "areas_by_count": {1: 356.0, 2: 712.0, 3: 1068.0, 4: 1424.0, 5: 1780.0, 6: 2136.0, 7: 2492.0, 8: 2848.0, 9: 3204.0, 10: 3560.0, 20: 7120.0}},
        "250": {"dia_mm": 23.24, "areas_by_count": {1: 425.0, 2: 849.0, 3: 1273.0, 4: 1697.0, 5: 2121.0, 6: 2546.0, 7: 2970.0, 8: 3394.0, 9: 3818.0, 10: 4242.0, 20: 8484.0}},
        "300": {"dia_mm": 24.64, "areas_by_count": {1: 477.0, 2: 954.0, 3: 1431.0, 4: 1908.0, 5: 2385.0, 6: 2862.0, 7: 3338.0, 8: 3815.0, 9: 4292.0, 10: 4769.0, 20: 9537.0}},
        "350": {"dia_mm": 25.94, "areas_by_count": {1: 529.0, 2: 1057.0, 3: 1586.0, 4: 2114.0, 5: 2643.0, 6: 3171.0, 7: 3700.0, 8: 4228.0, 9: 4757.0, 10: 5285.0, 20: 10570.0}},
        "400": {"dia_mm": 27.13, "areas_by_count": {1: 579.0, 2: 1157.0, 3: 1735.0, 4: 2313.0, 5: 2891.0, 6: 3469.0, 7: 4047.0, 8: 4625.0, 9: 5203.0, 10: 5781.0, 20: 11562.0}},
        "450": {"dia_mm": 28.25, "areas_by_count": {1: 627.0, 2: 1254.0, 3: 1881.0, 4: 2508.0, 5: 3134.0, 6: 3761.0, 7: 4388.0, 8: 5015.0, 9: 5642.0, 10: 6268.0, 20: 12536.0}},
        "500": {"dia_mm": 29.29, "areas_by_count": {1: 674.0, 2: 1348.0, 3: 2022.0, 4: 2696.0, 5: 3369.0, 6: 4043.0, 7: 4717.0, 8: 5391.0, 9: 6065.0, 10: 6738.0, 20: 13476.0}},
        "600": {"dia_mm": 32.08, "areas_by_count": {1: 809.0, 2: 1617.0, 3: 2425.0, 4: 3234.0, 5: 4042.0, 6: 4850.0, 7: 5658.0, 8: 6467.0, 9: 7275.0, 10: 8083.0, 20: 16166.0}},
        "700": {"dia_mm": 33.89, "areas_by_count": {1: 903.0, 2: 1805.0, 3: 2707.0, 4: 3609.0, 5: 4511.0, 6: 5413.0, 7: 6315.0, 8: 7217.0, 9: 8119.0, 10: 9021.0, 20: 18042.0}},
        "750": {"dia_mm": 34.75, "areas_by_count": {1: 949.0, 2: 1897.0, 3: 2846.0, 4: 3794.0, 5: 4743.0, 6: 5691.0, 7: 6639.0, 8: 7588.0, 9: 8536.0, 10: 9485.0, 20: 18969.0}},
        "800": {"dia_mm": 35.56, "areas_by_count": {1: 994.0, 2: 1987.0, 3: 2980.0, 4: 3973.0, 5: 4966.0, 6: 5959.0, 7: 6953.0, 8: 7946.0, 9: 8939.0, 10: 9932.0, 20: 19863.0}},
        "900": {"dia_mm": 37.19, "areas_by_count": {1: 1087.0, 2: 2173.0, 3: 3259.0, 4: 4346.0, 5: 5432.0, 6: 6518.0, 7: 7604.0, 8: 8691.0, 9: 9777.0, 10: 10863.0, 20: 21726.0}},
        "1000": {"dia_mm": 38.66, "areas_by_count": {1: 1174.0, 2: 2348.0, 3: 3522.0, 4: 4696.0, 5: 5870.0, 6: 7044.0, 7: 8217.0, 8: 9391.0, 9: 10565.0, 10: 11739.0, 20: 23478.0}},
        "1250": {"dia_mm": 44.68, "areas_by_count": {1: 1568.0, 2: 3136.0, 3: 4704.0, 4: 6272.0, 5: 7840.0, 6: 9408.0, 7: 10976.0, 8: 12544.0, 9: 14112.0, 10: 15679.0, 20: 31358.0}},
        "1500": {"dia_mm": 47.80, "areas_by_count": {1: 1795.0, 2: 3590.0, 3: 5384.0, 4: 7179.0, 5: 8973.0, 6: 10768.0, 7: 12562.0, 8: 14357.0, 9: 16151.0, 10: 17946.0, 20: 35891.0}},
        "1750": {"dia_mm": 50.70, "areas_by_count": {1: 2019.0, 2: 4038.0, 3: 6057.0, 4: 8076.0, 5: 10095.0, 6: 12114.0, 7: 14133.0, 8: 16151.0, 9: 18170.0, 10: 20189.0, 20: 40378.0}},
        "2000": {"dia_mm": 53.39, "areas_by_count": {1: 2239.0, 2: 4478.0, 3: 6717.0, 4: 8956.0, 5: 11194.0, 6: 13433.0, 7: 15672.0, 8: 17911.0, 9: 20149.0, 10: 22388.0, 20: 44776.0}},
    }
}


# --------------------------------------------------------------------------------------
# Table 6J (TW, TW75 insulated conductors)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_6J: Dict[str, Dict[str, Dict[str, Any]]] = {
    "stranded": {
        "14":  {"dia_mm": 3.36, "areas_by_count": {1: 8.9, 2: 17.8, 3: 26.6, 4: 35.5, 5: 44.4, 6: 53.2, 7: 62.1, 8: 71.0, 9: 79.8, 10: 88.7, 20: 178.0}},
        "12":  {"dia_mm": 3.84, "areas_by_count": {1: 11.6, 2: 23.2, 3: 34.8, 4: 46.4, 5: 58.0, 6: 69.5, 7: 81.1, 8: 92.7, 9: 105.0, 10: 116.0, 20: 232.0}},
        "10":  {"dia_mm": 4.47, "areas_by_count": {1: 15.7, 2: 31.4, 3: 47.1, 4: 62.8, 5: 78.5, 6: 94.2, 7: 110.0, 8: 126.0, 9: 142.0, 10: 157.0, 20: 314.0}},
        "8":   {"dia_mm": 5.99, "areas_by_count": {1: 28.2, 2: 56.4, 3: 84.6, 4: 113.0, 5: 141.0, 6: 170.0, 7: 198.0, 8: 226.0, 9: 254.0, 10: 282.0, 20: 564.0}},
        "6":   {"dia_mm": 7.71, "areas_by_count": {1: 46.7, 2: 93.4, 3: 141.0, 4: 187.0, 5: 234.0, 6: 281.0, 7: 327.0, 8: 374.0, 9: 421.0, 10: 467.0, 20: 934.0}},
        "4":   {"dia_mm": 8.93, "areas_by_count": {1: 62.7, 2: 126.0, 3: 188.0, 4: 251.0, 5: 314.0, 6: 376.0, 7: 439.0, 8: 502.0, 9: 564.0, 10: 627.0, 20: 1253.0}},
        "3":   {"dia_mm": 9.64, "areas_by_count": {1: 73.0, 2: 146.0, 3: 219.0, 4: 292.0, 5: 365.0, 6: 438.0, 7: 511.0, 8: 584.0, 9: 657.0, 10: 730.0, 20: 1460.0}},
        "2":   {"dia_mm": 10.46, "areas_by_count": {1: 86.0, 2: 172.0, 3: 258.0, 4: 344.0, 5: 430.0, 6: 516.0, 7: 602.0, 8: 688.0, 9: 774.0, 10: 860.0, 20: 1719.0}},
        "1":   {"dia_mm": 12.49, "areas_by_count": {1: 123.0, 2: 246.0, 3: 368.0, 4: 491.0, 5: 613.0, 6: 736.0, 7: 858.0, 8: 981.0, 9: 1103.0, 10: 1226.0, 20: 2451.0}},
        "1/0": {"dia_mm": 13.53, "areas_by_count": {1: 144.0, 2: 288.0, 3: 432.0, 4: 576.0, 5: 719.0, 6: 863.0, 7: 1007.0, 8: 1151.0, 9: 1294.0, 10: 1438.0, 20: 2876.0}},
        "2/0": {"dia_mm": 14.70, "areas_by_count": {1: 170.0, 2: 340.0, 3: 510.0, 4: 679.0, 5: 849.0, 6: 1019.0, 7: 1189.0, 8: 1358.0, 9: 1528.0, 10: 1698.0, 20: 3395.0}},
        "3/0": {"dia_mm": 16.00, "areas_by_count": {1: 202.0, 2: 403.0, 3: 604.0, 4: 805.0, 5: 1006.0, 6: 1207.0, 7: 1408.0, 8: 1609.0, 9: 1810.0, 10: 2011.0, 20: 4022.0}},
        "4/0": {"dia_mm": 17.47, "areas_by_count": {1: 240.0, 2: 480.0, 3: 720.0, 4: 959.0, 5: 1199.0, 6: 1439.0, 7: 1678.0, 8: 1918.0, 9: 2158.0, 10: 2398.0, 20: 4795.0}},
        "250": {"dia_mm": 19.43, "areas_by_count": {1: 297.0, 2: 594.0, 3: 890.0, 4: 1187.0, 5: 1483.0, 6: 1780.0, 7: 2076.0, 8: 2373.0, 9: 2669.0, 10: 2966.0, 20: 5931.0}},
        "300": {"dia_mm": 20.82, "areas_by_count": {1: 341.0, 2: 681.0, 3: 1022.0, 4: 1362.0, 5: 1703.0, 6: 2043.0, 7: 2384.0, 8: 2724.0, 9: 3065.0, 10: 3405.0, 20: 6809.0}},
        "350": {"dia_mm": 22.05, "areas_by_count": {1: 382.0, 2: 764.0, 3: 1146.0, 4: 1528.0, 5: 1910.0, 6: 2292.0, 7: 2674.0, 8: 3055.0, 9: 3437.0, 10: 3819.0, 20: 7638.0}},
        "400": {"dia_mm": 23.31, "areas_by_count": {1: 427.0, 2: 854.0, 3: 1281.0, 4: 1708.0, 5: 2134.0, 6: 2561.0, 7: 2988.0, 8: 3415.0, 9: 3841.0, 10: 4268.0, 20: 8536.0}},
        "450": {"dia_mm": 24.43, "areas_by_count": {1: 469.0, 2: 938.0, 3: 1407.0, 4: 1875.0, 5: 2344.0, 6: 2813.0, 7: 3282.0, 8: 3750.0, 9: 4219.0, 10: 4688.0, 20: 9375.0}},
        "500": {"dia_mm": 25.47, "areas_by_count": {1: 510.0, 2: 1020.0, 3: 1529.0, 4: 2039.0, 5: 2548.0, 6: 3058.0, 7: 3567.0, 8: 4077.0, 9: 4586.0, 10: 5096.0, 20: 10191.0}},
        "600": {"dia_mm": 28.26, "areas_by_count": {1: 628.0, 2: 1255.0, 3: 1882.0, 4: 2509.0, 5: 3137.0, 6: 3764.0, 7: 4391.0, 8: 5018.0, 9: 5646.0, 10: 6272.0, 20: 12545.0}},
        "700": {"dia_mm": 30.07, "areas_by_count": {1: 711.0, 2: 1421.0, 3: 2131.0, 4: 2841.0, 5: 3551.0, 6: 4261.0, 7: 4972.0, 8: 5682.0, 9: 6392.0, 10: 7102.0, 20: 14204.0}},
        "750": {"dia_mm": 30.93, "areas_by_count": {1: 752.0, 2: 1503.0, 3: 2255.0, 4: 3006.0, 5: 3757.0, 6: 4509.0, 7: 5260.0, 8: 6011.0, 9: 6763.0, 10: 7514.0, 20: 15028.0}},
        "800": {"dia_mm": 31.77, "areas_by_count": {1: 793.0, 2: 1586.0, 3: 2379.0, 4: 3171.0, 5: 3964.0, 6: 4757.0, 7: 5550.0, 8: 6342.0, 9: 7135.0, 10: 7928.0, 20: 15855.0}},
        "900": {"dia_mm": 33.37, "areas_by_count": {1: 875.0, 2: 1750.0, 3: 2624.0, 4: 3499.0, 5: 4373.0, 6: 5248.0, 7: 6123.0, 8: 6997.0, 9: 7872.0, 10: 8746.0, 20: 17492.0}},
        "1000": {"dia_mm": 34.84, "areas_by_count": {1: 954.0, 2: 1907.0, 3: 2861.0, 4: 3814.0, 5: 4767.0, 6: 5721.0, 7: 6674.0, 8: 7627.0, 9: 8581.0, 10: 9534.0, 20: 19067.0}},
        "1250": {"dia_mm": 39.08, "areas_by_count": {1: 1200.0, 2: 2399.0, 3: 3599.0, 4: 4798.0, 5: 5998.0, 6: 7197.0, 7: 8397.0, 8: 9596.0, 9: 10796.0, 10: 11995.0, 20: 23990.0}},
        "1500": {"dia_mm": 42.20, "areas_by_count": {1: 1399.0, 2: 2798.0, 3: 4197.0, 4: 5595.0, 5: 6994.0, 6: 8393.0, 7: 9791.0, 8: 11190.0, 9: 12589.0, 10: 13987.0, 20: 27974.0}},
        "1750": {"dia_mm": 45.10, "areas_by_count": {1: 1598.0, 2: 3196.0, 3: 4793.0, 4: 6391.0, 5: 7988.0, 6: 9586.0, 7: 11183.0, 8: 12781.0, 9: 14378.0, 10: 15976.0, 20: 31951.0}},
        "2000": {"dia_mm": 47.79, "areas_by_count": {1: 1794.0, 2: 3588.0, 3: 5382.0, 4: 7176.0, 5: 8969.0, 6: 10763.0, 7: 12557.0, 8: 14351.0, 9: 16144.0, 10: 17938.0, 20: 35876.0}},
    },
    "solid": {
        "14": {"dia_mm": 3.15, "areas_by_count": {1: 7.79, 2: 15.6, 3: 23.4, 4: 31.2, 5: 39.0, 6: 46.8, 7: 54.6, 8: 62.4, 9: 70.2, 10: 78.0, 20: 156.0}},
        "12": {"dia_mm": 3.57, "areas_by_count": {1: 10.1, 2: 20.1, 3: 30.1, 4: 40.1, 5: 50.1, 6: 60.1, 7: 70.1, 8: 80.1, 9: 90.1, 10: 101.0, 20: 201.0}},
        "10": {"dia_mm": 4.11, "areas_by_count": {1: 13.3, 2: 26.6, 3: 39.9, 4: 53.1, 5: 66.4, 6: 79.6, 7: 92.9, 8: 107.0, 9: 120.0, 10: 133.0, 20: 266.0}},
    }
}


# --------------------------------------------------------------------------------------
# Table 6K (Class C TWN75, T90 NYLON insulated conductors)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_6K: Dict[str, Dict[str, Dict[str, Any]]] = {
    "stranded": {
        "14":  {"dia_mm": 2.80, "areas_by_count": {1: 6.16, 2: 12.4, 3: 18.5, 4: 24.7, 5: 30.8, 6: 37.0, 7: 43.1, 8: 49.3, 9: 55.5, 10: 61.6, 20: 124.0}},
        "12":  {"dia_mm": 3.28, "areas_by_count": {1: 8.45, 2: 16.9, 3: 25.4, 4: 33.8, 5: 42.3, 6: 50.7, 7: 59.2, 8: 67.6, 9: 76.1, 10: 84.5, 20: 169.0}},
        "10":  {"dia_mm": 4.17, "areas_by_count": {1: 13.7, 2: 27.4, 3: 41.0, 4: 54.7, 5: 68.3, 6: 82.0, 7: 95.6, 8: 110.0, 9: 123.0, 10: 137.0, 20: 274.0}},
        "8":   {"dia_mm": 5.49, "areas_by_count": {1: 23.7, 2: 47.4, 3: 71.1, 4: 94.7, 5: 119.0, 6: 143.0, 7: 166.0, 8: 190.0, 9: 214.0, 10: 237.0, 20: 474.0}},
        "6":   {"dia_mm": 6.45, "areas_by_count": {1: 32.7, 2: 65.4, 3: 98.1, 4: 131.0, 5: 164.0, 6: 197.5, 7: 229.0, 8: 262.0, 9: 295.0, 10: 327.0, 20: 654.0}},
        "4":   {"dia_mm": 8.23, "areas_by_count": {1: 53.2, 2: 107.0, 3: 160.0, 4: 213.0, 5: 266.0, 6: 320.0, 7: 373.0, 8: 426.0, 9: 479.0, 10: 532.0, 20: 1064.0}},
        "3":   {"dia_mm": 8.94, "areas_by_count": {1: 62.8, 2: 126.0, 3: 189.0, 4: 252.0, 5: 314.0, 6: 377.0, 7: 440.0, 8: 503.0, 9: 565.0, 10: 628.0, 20: 1256.0}},
        "2":   {"dia_mm": 9.76, "areas_by_count": {1: 74.9, 2: 150.0, 3: 225.0, 4: 300.0, 5: 375.8, 6: 449.0, 7: 524.0, 8: 599.0, 9: 674.0, 10: 749.0, 20: 1497.0}},
        "1":   {"dia_mm": 11.33, "areas_by_count": {1: 101.0, 2: 202.0, 3: 303.0, 4: 404.0, 5: 505.0, 6: 605.0, 7: 706.0, 8: 807.0, 9: 908.0, 10: 1009.0, 20: 2017.0}},
        "1/0": {"dia_mm": 12.37, "areas_by_count": {1: 121.0, 2: 241.0, 3: 361.0, 4: 481.0, 5: 601.0, 6: 722.0, 7: 842.0, 8: 962.0, 9: 1082.0, 10: 1202.0, 20: 2404.0}},
        "2/0": {"dia_mm": 13.54, "areas_by_count": {1: 144.0, 2: 288.0, 3: 432.0, 4: 576.0, 5: 720.0, 6: 864.0, 7: 1008.0, 8: 1152.0, 9: 1296.0, 10: 1440.0, 20: 2880.0}},
        "3/0": {"dia_mm": 14.84, "areas_by_count": {1: 173.0, 2: 346.0, 3: 519.0, 4: 692.0, 5: 865.0, 6: 1038.0, 7: 1211.0, 8: 1384.0, 9: 1557.0, 10: 1730.0, 20: 3460.0}},
        "4/0": {"dia_mm": 16.31, "areas_by_count": {1: 209.0, 2: 418.0, 3: 627.0, 4: 836.0, 5: 1045.0, 6: 1254.0, 7: 1463.0, 8: 1672.0, 9: 1881.0, 10: 2090.0, 20: 4179.0}},
        "250": {"dia_mm": 18.04, "areas_by_count": {1: 256.0, 2: 512.0, 3: 767.0, 4: 1023.0, 5: 1279.0, 6: 1534.0, 7: 1790.0, 8: 2045.0, 9: 2301.0, 10: 2557.0, 20: 5113.0}},
        "300": {"dia_mm": 19.44, "areas_by_count": {1: 297.0, 2: 594.0, 3: 891.0, 4: 1188.0, 5: 1485.0, 6: 1781.0, 7: 2078.0, 8: 2375.0, 9: 2672.0, 10: 2969.0, 20: 5937.0}},
        "350": {"dia_mm": 20.67, "areas_by_count": {1: 336.0, 2: 672.0, 3: 1007.0, 4: 1343.0, 5: 1678.0, 6: 2014.0, 7: 2349.0, 8: 2685.0, 9: 3021.0, 10: 3356.0, 20: 6712.0}},
        "400": {"dia_mm": 21.93, "areas_by_count": {1: 378.0, 2: 756.0, 3: 1134.0, 4: 1511.0, 5: 1889.0, 6: 2267.0, 7: 2645.0, 8: 3022.0, 9: 3400.0, 10: 3778.0, 20: 7555.0}},
        "450": {"dia_mm": 23.05, "areas_by_count": {1: 418.0, 2: 835.0, 3: 1252.0, 4: 1670.0, 5: 2087.0, 6: 2504.0, 7: 2921.0, 8: 3339.0, 9: 3756.0, 10: 4173.0, 20: 8346.0}},
        "500": {"dia_mm": 24.09, "areas_by_count": {1: 456.0, 2: 912.0, 3: 1368.0, 4: 1824.0, 5: 2279.0, 6: 2735.0, 7: 3191.0, 8: 3647.0, 9: 4103.0, 10: 4558.0, 20: 9116.0}},
    },
    "solid": {
        "14": {"dia_mm": 2.59, "areas_by_count": {1: 5.27, 2: 10.6, 3: 15.9, 4: 21.1, 5: 26.4, 6: 31.7, 7: 36.9, 8: 42.2, 9: 47.5, 10: 52.7, 20: 106.0}},
        "12": {"dia_mm": 3.01, "areas_by_count": {1: 7.12, 2: 14.3, 3: 21.4, 4: 28.5, 5: 35.6, 6: 42.7, 7: 49.9, 8: 57.0, 9: 64.1, 10: 71.2, 20: 143.0}},
        "10": {"dia_mm": 3.81, "areas_by_count": {1: 11.4, 2: 22.8, 3: 34.2, 4: 45.6, 5: 57.0, 6: 68.5, 7: 79.9, 8: 91.3, 9: 103.0, 10: 115.0, 20: 229.0}},
    },
}


# --------------------------------------------------------------------------------------
# Convenience lookup helpers
# --------------------------------------------------------------------------------------
def get_table_entry(
    table: Dict[str, Dict[str, Dict[str, Any]]],
    construction: str,
    size: str
) -> Optional[Dict[str, Any]]:
    """
    Generic table entry lookup (for TABLE_6A, TABLE_6B, TABLE_6C, etc.).
    construction: "solid" or "stranded" (case-insensitive)
    size: e.g. "14", "1/0", "250"
    """
    c = (construction or "").strip().lower()
    s = (size or "").strip()
    return table.get(c, {}).get(s)


def get_table_area_mm2(
    table: Dict[str, Dict[str, Dict[str, Any]]],
    construction: str,
    size: str,
    n_conductors: int
) -> Optional[float]:
    """
    Generic lookup for area (mm²) for a given table, construction, size, and number of conductors.
    n_conductors must be one of: 1,2,3,4,5,6,7,8,9,10,20 (as extracted).
    """
    entry = get_table_entry(table, construction, size)
    if not entry:
        return None
    try:
        n = int(n_conductors)
    except Exception:
        return None
    return entry.get("areas_by_count", {}).get(n)


def get_table_diameter_mm(
    table: Dict[str, Dict[str, Dict[str, Any]]],
    construction: str,
    size: str
) -> Optional[float]:
    """Generic lookup for diameter (mm) for a given table, construction, and size."""
    entry = get_table_entry(table, construction, size)
    if not entry:
        return None
    try:
        return float(entry.get("dia_mm"))
    except Exception:
        return None


# --------------------------------------------------------------------------------------
# Table 9A — Internal diameter and cross-sectional areas of trade conduit and tubing
# (100% fill values, as listed)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_9A = {
    # Nominal trade size (mm)
    12: {
        "flexible_metal":               {"id_mm": 9.52,  "area_mm2": 71},
        "metallic_liquid_tight_flex":   {"id_mm": 12.29, "area_mm2": 119},
        "nonmetallic_liquid_tight_flex":{"id_mm": 12.07, "area_mm2": 114},
    },
    16: {
        "rigid_metal":                  {"id_mm": 16.05, "area_mm2": 202},
        "flexible_metal":               {"id_mm": 15.88, "area_mm2": 198},
        "rigid_pvc":                    {"id_mm": 14.57, "area_mm2": 167},
        "metallic_liquid_tight_flex":   {"id_mm": 15.80, "area_mm2": 196},
        "nonmetallic_liquid_tight_flex":{"id_mm": 15.49, "area_mm2": 188},
        "emt":                          {"id_mm": 15.40, "area_mm2": 186},
        "ent":                          {"id_mm": 14.58, "area_mm2": 167},
    },
    21: {
        "rigid_metal":                  {"id_mm": 21.23, "area_mm2": 354},
        "flexible_metal":               {"id_mm": 20.62, "area_mm2": 334},
        "rigid_pvc":                    {"id_mm": 19.77, "area_mm2": 307},
        "metallic_liquid_tight_flex":   {"id_mm": 20.83, "area_mm2": 341},
        "nonmetallic_liquid_tight_flex":{"id_mm": 20.45, "area_mm2": 328},
        "emt":                          {"id_mm": 20.50, "area_mm2": 330},
        "ent":                          {"id_mm": 19.66, "area_mm2": 304},
    },
    27: {
        "rigid_metal":                  {"id_mm": 27.00, "area_mm2": 573},
        "flexible_metal":               {"id_mm": 25.40, "area_mm2": 507},
        "rigid_pvc":                    {"id_mm": 25.40, "area_mm2": 507},
        "metallic_liquid_tight_flex":   {"id_mm": 26.44, "area_mm2": 549},
        "nonmetallic_liquid_tight_flex":{"id_mm": 25.91, "area_mm2": 527},
        "emt":                          {"id_mm": 26.20, "area_mm2": 539},
        "ent":                          {"id_mm": 25.37, "area_mm2": 506},
    },
    35: {
        "rigid_metal":                  {"id_mm": 35.41, "area_mm2": 985},
        "flexible_metal":               {"id_mm": 31.75, "area_mm2": 792},
        "rigid_pvc":                    {"id_mm": 31.75, "area_mm2": 792},
        "metallic_liquid_tight_flex":   {"id_mm": 35.05, "area_mm2": 965},
        "nonmetallic_liquid_tight_flex":{"id_mm": 34.54, "area_mm2": 937},
        "emt":                          {"id_mm": 34.60, "area_mm2": 940},
        "ent":                          {"id_mm": 33.73, "area_mm2": 894},
    },
    41: {
        "rigid_metal":                  {"id_mm": 41.25, "area_mm2": 1336},
        "flexible_metal":               {"id_mm": 38.10, "area_mm2": 1140},
        "rigid_pvc":                    {"id_mm": 38.10, "area_mm2": 1140},
        "metallic_liquid_tight_flex":   {"id_mm": 40.01, "area_mm2": 1257},
        "nonmetallic_liquid_tight_flex":{"id_mm": 40.01, "area_mm2": 1257},
        "emt":                          {"id_mm": 40.50, "area_mm2": 1288},
        "ent":                          {"id_mm": 39.57, "area_mm2": 1230},
    },
    53: {
        "rigid_metal":                  {"id_mm": 52.91, "area_mm2": 2199},
        "flexible_metal":               {"id_mm": 50.80, "area_mm2": 2027},
        "rigid_pvc":                    {"id_mm": 50.80, "area_mm2": 2027},
        "rigid_pvc_db2_es2":             {"id_mm": 50.80, "area_mm2": 2027},
        "metallic_liquid_tight_flex":   {"id_mm": 51.31, "area_mm2": 2068},
        "nonmetallic_liquid_tight_flex":{"id_mm": 51.69, "area_mm2": 2098},
        "emt":                          {"id_mm": 52.10, "area_mm2": 2132},
        "ent":                          {"id_mm": 51.18, "area_mm2": 2057},
    },
    63: {
        "rigid_metal":                  {"id_mm": 63.22, "area_mm2": 3139},
        "flexible_metal":               {"id_mm": 63.50, "area_mm2": 3167},
        "rigid_pvc":                    {"id_mm": 61.30, "area_mm2": 2951},
        "metallic_liquid_tight_flex":   {"id_mm": 62.99, "area_mm2": 3116},
        "emt":                          {"id_mm": 69.40, "area_mm2": 3783},
    },
    78: {
        "rigid_metal":                  {"id_mm": 78.49, "area_mm2": 4839},
        "flexible_metal":               {"id_mm": 76.20, "area_mm2": 4560},
        "rigid_pvc":                    {"id_mm": 76.20, "area_mm2": 4560},
        "rigid_pvc_db2_es2":             {"id_mm": 76.20, "area_mm2": 4560},
        "metallic_liquid_tight_flex":   {"id_mm": 77.98, "area_mm2": 4776},
        "emt":                          {"id_mm": 85.20, "area_mm2": 5701},
    },
    91: {
        "rigid_metal":                  {"id_mm": 90.68, "area_mm2": 6458},
        "flexible_metal":               {"id_mm": 88.90, "area_mm2": 6207},
        "rigid_pvc":                    {"id_mm": 88.40, "area_mm2": 6138},
        "rigid_pvc_db2_es2":             {"id_mm": 88.40, "area_mm2": 6138},
        "metallic_liquid_tight_flex":   {"id_mm": 88.90, "area_mm2": 6207},
        "emt":                          {"id_mm": 97.40, "area_mm2": 7451},
    },
    103: {
        "rigid_metal":                  {"id_mm": 102.87, "area_mm2": 8311},
        "flexible_metal":               {"id_mm": 101.60, "area_mm2": 8107},
        "rigid_pvc":                    {"id_mm": 100.10, "area_mm2": 7870},
        "rigid_pvc_db2_es2":             {"id_mm": 100.10, "area_mm2": 7870},
        "metallic_liquid_tight_flex":   {"id_mm": 101.60, "area_mm2": 8107},
        "emt":                          {"id_mm": 110.00, "area_mm2": 9503},
    },
    129: {
        "rigid_metal":                  {"id_mm": 128.85, "area_mm2": 13039},
        "rigid_pvc":                    {"id_mm": 125.85, "area_mm2": 12439},
        "rigid_pvc_db2_es2":             {"id_mm": 126.35, "area_mm2": 12538},
        "emt":                          {"id_mm": 128.90, "area_mm2": 13050},
    },
    155: {
        "rigid_metal":                  {"id_mm": 154.76, "area_mm2": 18811},
        "rigid_pvc":                    {"id_mm": 149.75, "area_mm2": 17613},
        "rigid_pvc_db2_es2":             {"id_mm": 149.75, "area_mm2": 17613},
        "emt":                          {"id_mm": 154.80, "area_mm2": 18821},
    },
    200: {
        "rigid_pvc":                    {"id_mm": 199.39, "area_mm2": 31225},
    },
}


# --------------------------------------------------------------------------------------
# Table 9B — Internal diameter and cross-sectional areas of trade conduit and tubing
# (HDPE, RTRC variants — 100% fill values)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_9B = {
    # Nominal trade size (mm)
    16: {
        "rtrc_ips":        {"id_mm": 17.27, "area_mm2": 234},
        "rtrc_id":         {"id_mm": 11.94, "area_mm2": 112},
        "hdpe_sch40":      {"id_mm": 14.67, "area_mm2": 169},
        "hdpe_sch80":      {"id_mm": 12.75, "area_mm2": 128},
        "hdpe_dr9":        {"id_mm": 15.47, "area_mm2": 188},
        "hdpe_dr11":       {"id_mm": 16.30, "area_mm2": 209},
        "hdpe_dr13_5":     {"id_mm": 17.02, "area_mm2": 228},
        "hdpe_dr15_5":     {"id_mm": 17.43, "area_mm2": 239},
    },
    21: {
        "rtrc_ips":        {"id_mm": 22.61, "area_mm2": 402},
        "rtrc_id":         {"id_mm": 18.29, "area_mm2": 263},
        "hdpe_sch40":      {"id_mm": 19.78, "area_mm2": 307},
        "hdpe_sch80":      {"id_mm": 17.70, "area_mm2": 246},
        "hdpe_dr9":        {"id_mm": 19.65, "area_mm2": 303},
        "hdpe_dr11":       {"id_mm": 20.73, "area_mm2": 338},
        "hdpe_dr13_5":     {"id_mm": 21.63, "area_mm2": 367},
        "hdpe_dr15_5":     {"id_mm": 22.14, "area_mm2": 385},
    },
    27: {
        "rtrc_ips":        {"id_mm": 29.34, "area_mm2": 676},
        "rtrc_id":         {"id_mm": 24.64, "area_mm2": 477},
        "hdpe_sch40":      {"id_mm": 25.40, "area_mm2": 507},
        "hdpe_sch80":      {"id_mm": 23.06, "area_mm2": 418},
        "hdpe_dr9":        {"id_mm": 24.86, "area_mm2": 485},
        "hdpe_dr11":       {"id_mm": 26.21, "area_mm2": 540},
        "hdpe_dr13_5":     {"id_mm": 27.33, "area_mm2": 587},
        "hdpe_dr15_5":     {"id_mm": 27.97, "area_mm2": 614},
    },
    35: {
        "rtrc_ips":        {"id_mm": 38.10, "area_mm2": 1140},
        "rtrc_id":         {"id_mm": 30.99, "area_mm2": 754},
        "hdpe_sch40":      {"id_mm": 33.82, "area_mm2": 898},
        "hdpe_sch80":      {"id_mm": 31.10, "area_mm2": 760},
        "hdpe_dr9":        {"id_mm": 31.51, "area_mm2": 780},
        "hdpe_dr11":       {"id_mm": 33.31, "area_mm2": 871},
        "hdpe_dr13_5":     {"id_mm": 34.73, "area_mm2": 947},
        "hdpe_dr15_5":     {"id_mm": 35.54, "area_mm2": 992},
    },
    41: {
        "rtrc_ips":        {"id_mm": 44.20, "area_mm2": 1534},
        "rtrc_id":         {"id_mm": 37.34, "area_mm2": 1095},
        "hdpe_sch40":      {"id_mm": 39.63, "area_mm2": 1233},
        "hdpe_sch80":      {"id_mm": 36.63, "area_mm2": 1054},
        "hdpe_dr9":        {"id_mm": 36.10, "area_mm2": 1024},
        "hdpe_dr11":       {"id_mm": 38.27, "area_mm2": 1150},
        "hdpe_dr13_5":     {"id_mm": 39.93, "area_mm2": 1252},
        "hdpe_dr15_5":     {"id_mm": 40.85, "area_mm2": 1311},
    },
    53: {
        "rtrc_ips":        {"id_mm": 56.26, "area_mm2": 2486},
        "rtrc_id":         {"id_mm": 50.29, "area_mm2": 1986},
        "hdpe_sch40":      {"id_mm": 51.18, "area_mm2": 2057},
        "hdpe_sch80":      {"id_mm": 47.82, "area_mm2": 1796},
        "hdpe_dr9":        {"id_mm": 45.19, "area_mm2": 1604},
        "hdpe_dr11":       {"id_mm": 47.91, "area_mm2": 1803},
        "hdpe_dr13_5":     {"id_mm": 50.18, "area_mm2": 1978},
        "hdpe_dr15_5":     {"id_mm": 51.40, "area_mm2": 2075},
    },
    63: {
        "rtrc_ips":        {"id_mm": 69.60, "area_mm2": 3805},
        "rtrc_id":         {"id_mm": 63.00, "area_mm2": 3117},
        "hdpe_sch40":      {"id_mm": 61.13, "area_mm2": 2935},
        "hdpe_sch80":      {"id_mm": 56.97, "area_mm2": 2549},
        "hdpe_dr9":        {"id_mm": 54.63, "area_mm2": 2344},
        "hdpe_dr11":       {"id_mm": 57.92, "area_mm2": 2635},
        "hdpe_dr13_5":     {"id_mm": 60.68, "area_mm2": 2892},
        "hdpe_dr15_5":     {"id_mm": 62.24, "area_mm2": 3042},
    },
    78: {
        "rtrc_ips":        {"id_mm": 84.84, "area_mm2": 5653},
        "rtrc_id":         {"id_mm": 75.69, "area_mm2": 4500},
        "hdpe_sch40":      {"id_mm": 76.14, "area_mm2": 4553},
        "hdpe_sch80":      {"id_mm": 71.38, "area_mm2": 4002},
        "hdpe_dr9":        {"id_mm": 66.56, "area_mm2": 3479},
        "hdpe_dr11":       {"id_mm": 70.60, "area_mm2": 3915},
        "hdpe_dr13_5":     {"id_mm": 73.95, "area_mm2": 4295},
        "hdpe_dr15_5":     {"id_mm": 75.85, "area_mm2": 4519},
    },
    103: {
        "rtrc_ips":        {"id_mm": 109.72, "area_mm2": 9455},
        "rtrc_id":         {"id_mm": 101.09, "area_mm2": 8026},
        "hdpe_sch40":      {"id_mm": 100.26, "area_mm2": 7895},
        "hdpe_sch80":      {"id_mm": 94.56, "area_mm2": 7023},
        "hdpe_dr9":        {"id_mm": 85.36, "area_mm2": 5723},
        "hdpe_dr11":       {"id_mm": 90.52, "area_mm2": 6435},
        "hdpe_dr13_5":     {"id_mm": 94.83, "area_mm2": 7063},
        "hdpe_dr15_5":     {"id_mm": 97.29, "area_mm2": 7434},
    },
    129: {
        "rtrc_ips":        {"id_mm": 136.14, "area_mm2": 14557},
        "rtrc_id":         {"id_mm": 126.24, "area_mm2": 12517},
        "hdpe_sch40":      {"id_mm": 125.91, "area_mm2": 12451},
        "hdpe_sch80":      {"id_mm": 119.25, "area_mm2": 11169},
        "hdpe_dr9":        {"id_mm": 105.54, "area_mm2": 8748},
        "hdpe_dr11":       {"id_mm": 111.93, "area_mm2": 9840},
        "hdpe_dr13_5":     {"id_mm": 117.25, "area_mm2": 10797},
        "hdpe_dr15_5":     {"id_mm": 120.29, "area_mm2": 11364},
    },
    155: {
        "rtrc_ips":        {"id_mm": 162.05, "area_mm2": 20625},
        "hdpe_sch40":      {"id_mm": 151.50, "area_mm2": 18027},
        "hdpe_sch80":      {"id_mm": 142.86, "area_mm2": 16029},
        "hdpe_dr9":        {"id_mm": 125.63, "area_mm2": 12396},
        "hdpe_dr11":       {"id_mm": 133.22, "area_mm2": 13939},
        "hdpe_dr13_5":     {"id_mm": 139.57, "area_mm2": 15299},
        "hdpe_dr15_5":     {"id_mm": 143.19, "area_mm2": 16103},
    },
    200: {
        "hdpe_sch40":      {"id_mm": 199.64, "area_mm2": 31303},
        "hdpe_dr9":        {"id_mm": 163.58, "area_mm2": 21016},
        "hdpe_dr11":       {"id_mm": 173.49, "area_mm2": 23640},
        "hdpe_dr13_5":     {"id_mm": 181.74, "area_mm2": 25941},
        "hdpe_dr15_5":     {"id_mm": 186.43, "area_mm2": 27297},
    },
    275: {
        "hdpe_dr9":        {"id_mm": 203.84, "area_mm2": 32634},
        "hdpe_dr11":       {"id_mm": 216.19, "area_mm2": 36708},
        "hdpe_dr13_5":     {"id_mm": 226.49, "area_mm2": 40289},
        "hdpe_dr15_5":     {"id_mm": 232.35, "area_mm2": 42401},
    },
    325: {
        "hdpe_dr9":        {"id_mm": 241.79, "area_mm2": 45916},
        "hdpe_dr11":       {"id_mm": 256.46, "area_mm2": 51657},
        "hdpe_dr13_5":     {"id_mm": 268.66, "area_mm2": 56689},
        "hdpe_dr15_5":     {"id_mm": 275.59, "area_mm2": 59651},
    },
}


# --------------------------------------------------------------------------------------
# Table 9C — 53% allowable fill areas for single conductor or multiconductor cable
# (non lead-sheathed)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_9C = {
    # Nominal trade size (mm)
    12: {
        "flexible_metal":               {"id_mm": 9.52,  "area_mm2": 37.73},
        "metallic_liquid_tight_flex":   {"id_mm": 12.29, "area_mm2": 62.87},
        "nonmetallic_liquid_tight_flex":{"id_mm": 12.07, "area_mm2": 60.64},
    },
    16: {
        "rigid_metal":                  {"id_mm": 16.05, "area_mm2": 107.23},
        "flexible_metal":               {"id_mm": 15.88, "area_mm2": 104.97},
        "rigid_pvc":                    {"id_mm": 14.57, "area_mm2": 88.37},
        "metallic_liquid_tight_flex":   {"id_mm": 15.80, "area_mm2": 103.92},
        "nonmetallic_liquid_tight_flex":{"id_mm": 15.49, "area_mm2": 99.88},
        "emt":                          {"id_mm": 15.40, "area_mm2": 98.72},
        "ent":                          {"id_mm": 14.58, "area_mm2": 88.49},
    },
    21: {
        "rigid_metal":                  {"id_mm": 21.23, "area_mm2": 187.61},
        "flexible_metal":               {"id_mm": 20.62, "area_mm2": 176.99},
        "rigid_pvc":                    {"id_mm": 19.77, "area_mm2": 162.70},
        "metallic_liquid_tight_flex":   {"id_mm": 20.83, "area_mm2": 180.61},
        "nonmetallic_liquid_tight_flex":{"id_mm": 20.45, "area_mm2": 174.08},
        "emt":                          {"id_mm": 20.50, "area_mm2": 174.93},
        "ent":                          {"id_mm": 19.66, "area_mm2": 160.89},
    },
    27: {
        "rigid_metal":                  {"id_mm": 27.00, "area_mm2": 303.45},
        "flexible_metal":               {"id_mm": 25.40, "area_mm2": 268.55},
        "rigid_pvc":                    {"id_mm": 25.40, "area_mm2": 268.55},
        "metallic_liquid_tight_flex":   {"id_mm": 26.44, "area_mm2": 291.00},
        "nonmetallic_liquid_tight_flex":{"id_mm": 25.91, "area_mm2": 279.45},
        "emt":                          {"id_mm": 26.20, "area_mm2": 285.74},
        "ent":                          {"id_mm": 25.37, "area_mm2": 267.92},
    },
    35: {
        "rigid_metal":                  {"id_mm": 35.41, "area_mm2": 521.94},
        "flexible_metal":               {"id_mm": 31.75, "area_mm2": 419.62},
        "rigid_pvc":                    {"id_mm": 31.75, "area_mm2": 419.62},
        "metallic_liquid_tight_flex":   {"id_mm": 35.05, "area_mm2": 511.38},
        "nonmetallic_liquid_tight_flex":{"id_mm": 34.54, "area_mm2": 496.60},
        "emt":                          {"id_mm": 34.60, "area_mm2": 498.33},
        "ent":                          {"id_mm": 33.73, "area_mm2": 473.59},
    },
    41: {
        "rigid_metal":                  {"id_mm": 41.25, "area_mm2": 708.29},
        "flexible_metal":               {"id_mm": 38.10, "area_mm2": 604.25},
        "rigid_pvc":                    {"id_mm": 38.10, "area_mm2": 604.25},
        "metallic_liquid_tight_flex":   {"id_mm": 40.01, "area_mm2": 666.35},
        "nonmetallic_liquid_tight_flex":{"id_mm": 40.01, "area_mm2": 666.35},
        "emt":                          {"id_mm": 40.50, "area_mm2": 682.77},
        "ent":                          {"id_mm": 39.57, "area_mm2": 651.78},
    },
    53: {
        "rigid_metal":                  {"id_mm": 52.91, "area_mm2": 1165.31},
        "flexible_metal":               {"id_mm": 50.80, "area_mm2": 1074.22},
        "rigid_pvc":                    {"id_mm": 50.80, "area_mm2": 1074.22},
        "rigid_pvc_db2_es2":             {"id_mm": 50.80, "area_mm2": 1074.22},
        "metallic_liquid_tight_flex":   {"id_mm": 51.31, "area_mm2": 1095.90},
        "nonmetallic_liquid_tight_flex":{"id_mm": 51.69, "area_mm2": 1112.19},
        "emt":                          {"id_mm": 52.10, "area_mm2": 1129.90},
        "ent":                          {"id_mm": 51.18, "area_mm2": 1090.35},
    },
    63: {
        "rigid_metal":                  {"id_mm": 63.22, "area_mm2": 1663.70},
        "flexible_metal":               {"id_mm": 63.50, "area_mm2": 1678.47},
        "rigid_pvc":                    {"id_mm": 61.30, "area_mm2": 1564.18},
        "metallic_liquid_tight_flex":   {"id_mm": 62.99, "area_mm2": 1651.62},
        "emt":                          {"id_mm": 69.40, "area_mm2": 2004.86},
    },
    78: {
        "rigid_metal":                  {"id_mm": 78.49, "area_mm2": 2564.45},
        "flexible_metal":               {"id_mm": 76.20, "area_mm2": 2416.99},
        "rigid_pvc":                    {"id_mm": 76.20, "area_mm2": 2416.99},
        "rigid_pvc_db2_es2":             {"id_mm": 76.20, "area_mm2": 2416.99},
        "metallic_liquid_tight_flex":   {"id_mm": 77.98, "area_mm2": 2531.23},
        "emt":                          {"id_mm": 85.20, "area_mm2": 3021.66},
    },
    91: {
        "rigid_metal":                  {"id_mm": 90.68, "area_mm2": 3422.86},
        "flexible_metal":               {"id_mm": 88.90, "area_mm2": 3289.80},
        "rigid_pvc":                    {"id_mm": 88.40, "area_mm2": 3252.90},
        "rigid_pvc_db2_es2":             {"id_mm": 88.40, "area_mm2": 3252.90},
        "metallic_liquid_tight_flex":   {"id_mm": 88.90, "area_mm2": 3289.80},
        "emt":                          {"id_mm": 97.40, "area_mm2": 3948.97},
    },
    103: {
        "rigid_metal":                  {"id_mm": 102.87, "area_mm2": 4404.97},
        "flexible_metal":               {"id_mm": 101.60, "area_mm2": 4296.88},
        "rigid_pvc":                    {"id_mm": 100.10, "area_mm2": 4170.94},
        "rigid_pvc_db2_es2":             {"id_mm": 100.10, "area_mm2": 4170.94},
        "metallic_liquid_tight_flex":   {"id_mm": 101.60, "area_mm2": 4296.88},
        "emt":                          {"id_mm": 110.00, "area_mm2": 5036.76},
    },
    129: {
        "rigid_metal":                  {"id_mm": 128.85, "area_mm2": 6910.90},
        "rigid_pvc":                    {"id_mm": 125.85, "area_mm2": 6592.83},
        "rigid_pvc_db2_es2":             {"id_mm": 126.35, "area_mm2": 6645.33},
        "emt":                          {"id_mm": 128.90, "area_mm2": 6916.00},
    },
    155: {
        "rigid_metal":                  {"id_mm": 154.76, "area_mm2": 9969.73},
        "rigid_pvc":                    {"id_mm": 149.75, "area_mm2": 9334.68},
        "rigid_pvc_db2_es2":             {"id_mm": 149.75, "area_mm2": 9334.68},
        "emt":                          {"id_mm": 154.80, "area_mm2": 9975.00},
    },
    200: {
        "rigid_pvc":                    {"id_mm": 199.39, "area_mm2": 16549.03},
    },
}


# --------------------------------------------------------------------------------------
# Table 9D — 53% allowable fill areas for single conductor or multiconductor cable
# (HDPE / RTRC conduits — not lead-sheathed)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_9D = {
    16: {
        "rtrc_ips":    {"id_mm": 17.27, "area_mm2": 124.15},
        "rtrc_id":     {"id_mm": 11.94, "area_mm2": 59.34},
        "hdpe_sch40":  {"id_mm": 14.67, "area_mm2": 89.58},
        "hdpe_sch80":  {"id_mm": 12.75, "area_mm2": 67.67},
        "hdpe_dr9":    {"id_mm": 15.47, "area_mm2": 99.62},
        "hdpe_dr11":   {"id_mm": 16.30, "area_mm2": 110.60},
        "hdpe_dr13_5": {"id_mm": 17.02, "area_mm2": 120.58},
        "hdpe_dr15_5": {"id_mm": 17.43, "area_mm2": 126.46},
    },
    21: {
        "rtrc_ips":    {"id_mm": 22.61, "area_mm2": 212.80},
        "rtrc_id":     {"id_mm": 18.29, "area_mm2": 139.25},
        "hdpe_sch40":  {"id_mm": 19.78, "area_mm2": 162.86},
        "hdpe_sch80":  {"id_mm": 17.70, "area_mm2": 130.41},
        "hdpe_dr9":    {"id_mm": 19.65, "area_mm2": 160.73},
        "hdpe_dr11":   {"id_mm": 20.73, "area_mm2": 178.88},
        "hdpe_dr13_5": {"id_mm": 21.63, "area_mm2": 194.75},
        "hdpe_dr15_5": {"id_mm": 22.14, "area_mm2": 204.04},
    },
    27: {
        "rtrc_ips":    {"id_mm": 29.34, "area_mm2": 358.33},
        "rtrc_id":     {"id_mm": 24.64, "area_mm2": 252.72},
        "hdpe_sch40":  {"id_mm": 25.40, "area_mm2": 268.55},
        "hdpe_sch80":  {"id_mm": 23.06, "area_mm2": 221.35},
        "hdpe_dr9":    {"id_mm": 24.86, "area_mm2": 257.26},
        "hdpe_dr11":   {"id_mm": 26.21, "area_mm2": 285.96},
        "hdpe_dr13_5": {"id_mm": 27.33, "area_mm2": 310.92},
        "hdpe_dr15_5": {"id_mm": 27.97, "area_mm2": 325.65},
    },
    35: {
        "rtrc_ips":    {"id_mm": 38.10, "area_mm2": 604.25},
        "rtrc_id":     {"id_mm": 30.99, "area_mm2": 399.77},
        "hdpe_sch40":  {"id_mm": 33.82, "area_mm2": 476.12},
        "hdpe_sch80":  {"id_mm": 31.10, "area_mm2": 402.61},
        "hdpe_dr9":    {"id_mm": 31.51, "area_mm2": 413.30},
        "hdpe_dr11":   {"id_mm": 33.31, "area_mm2": 461.86},
        "hdpe_dr13_5": {"id_mm": 34.73, "area_mm2": 502.08},
        "hdpe_dr15_5": {"id_mm": 35.54, "area_mm2": 525.78},
    },
    41: {
        "rtrc_ips":    {"id_mm": 44.20, "area_mm2": 813.22},
        "rtrc_id":     {"id_mm": 37.34, "area_mm2": 580.38},
        "hdpe_sch40":  {"id_mm": 39.63, "area_mm2": 653.75},
        "hdpe_sch80":  {"id_mm": 36.63, "area_mm2": 558.52},
        "hdpe_dr9":    {"id_mm": 36.10, "area_mm2": 542.48},
        "hdpe_dr11":   {"id_mm": 38.27, "area_mm2": 609.65},
        "hdpe_dr13_5": {"id_mm": 39.93, "area_mm2": 663.69},
        "hdpe_dr15_5": {"id_mm": 40.85, "area_mm2": 694.62},
    },
    53: {
        "rtrc_ips":    {"id_mm": 56.26, "area_mm2": 1317.54},
        "rtrc_id":     {"id_mm": 50.29, "area_mm2": 1052.76},
        "hdpe_sch40":  {"id_mm": 51.18, "area_mm2": 1090.35},
        "hdpe_sch80":  {"id_mm": 47.82, "area_mm2": 951.89},
        "hdpe_dr9":    {"id_mm": 45.19, "area_mm2": 850.06},
        "hdpe_dr11":   {"id_mm": 47.91, "area_mm2": 955.47},
        "hdpe_dr13_5": {"id_mm": 50.18, "area_mm2": 1048.16},
        "hdpe_dr15_5": {"id_mm": 51.40, "area_mm2": 1099.74},
    },
    63: {
        "rtrc_ips":    {"id_mm": 69.60, "area_mm2": 2016.44},
        "rtrc_id":     {"id_mm": 63.00, "area_mm2": 1652.14},
        "hdpe_sch40":  {"id_mm": 61.13, "area_mm2": 1555.52},
        "hdpe_sch80":  {"id_mm": 56.97, "area_mm2": 1351.01},
        "hdpe_dr9":    {"id_mm": 54.63, "area_mm2": 1242.30},
        "hdpe_dr11":   {"id_mm": 57.92, "area_mm2": 1396.44},
        "hdpe_dr13_5": {"id_mm": 60.68, "area_mm2": 1532.70},
        "hdpe_dr15_5": {"id_mm": 62.24, "area_mm2": 1612.52},
    },
    78: {
        "rtrc_ips":    {"id_mm": 84.84, "area_mm2": 2996.17},
        "rtrc_id":     {"id_mm": 75.69, "area_mm2": 2384.75},
        "hdpe_sch40":  {"id_mm": 76.14, "area_mm2": 2413.19},
        "hdpe_sch80":  {"id_mm": 71.38, "area_mm2": 2120.89},
        "hdpe_dr9":    {"id_mm": 66.56, "area_mm2": 1844.13},
        "hdpe_dr11":   {"id_mm": 70.60, "area_mm2": 2074.79},
        "hdpe_dr13_5": {"id_mm": 73.95, "area_mm2": 2276.37},
        "hdpe_dr15_5": {"id_mm": 75.85, "area_mm2": 2394.84},
    },
    103: {
        "rtrc_ips":    {"id_mm": 109.72, "area_mm2": 5011.15},
        "rtrc_id":     {"id_mm": 101.09, "area_mm2": 4253.85},
        "hdpe_sch40":  {"id_mm": 100.26, "area_mm2": 4184.28},
        "hdpe_sch80":  {"id_mm": 94.56, "area_mm2": 3722.04},
        "hdpe_dr9":    {"id_mm": 85.36, "area_mm2": 3033.02},
        "hdpe_dr11":   {"id_mm": 90.52, "area_mm2": 3410.79},
        "hdpe_dr13_5": {"id_mm": 94.83, "area_mm2": 3743.32},
        "hdpe_dr15_5": {"id_mm": 97.29, "area_mm2": 3940.05},
    },
    129: {
        "rtrc_ips":    {"id_mm": 136.14, "area_mm2": 7715.02},
        "rtrc_id":     {"id_mm": 126.24, "area_mm2": 6633.76},
        "hdpe_sch40":  {"id_mm": 125.91, "area_mm2": 6599.12},
        "hdpe_sch80":  {"id_mm": 119.25, "area_mm2": 5919.47},
        "hdpe_dr9":    {"id_mm": 105.54, "area_mm2": 4636.60},
        "hdpe_dr11":   {"id_mm": 111.93, "area_mm2": 5215.05},
        "hdpe_dr13_5": {"id_mm": 117.25, "area_mm2": 5722.57},
        "hdpe_dr15_5": {"id_mm": 120.29, "area_mm2": 6023.17},
    },
    155: {
        "rtrc_ips":    {"id_mm": 162.05, "area_mm2": 10931.10},
        "hdpe_sch40":  {"id_mm": 151.50, "area_mm2": 9554.13},
        "hdpe_sch80":  {"id_mm": 142.86, "area_mm2": 8495.46},
        "hdpe_dr9":    {"id_mm": 125.63, "area_mm2": 6569.80},
        "hdpe_dr11":   {"id_mm": 133.22, "area_mm2": 7387.62},
        "hdpe_dr13_5": {"id_mm": 139.57, "area_mm2": 8108.68},
        "hdpe_dr15_5": {"id_mm": 143.19, "area_mm2": 8534.76},
    },
    200: {
        "hdpe_sch40":  {"id_mm": 199.64, "area_mm2": 16590.55},
        "hdpe_dr9":    {"id_mm": 163.58, "area_mm2": 11138.49},
        "hdpe_dr11":   {"id_mm": 173.49, "area_mm2": 12528.95},
        "hdpe_dr13_5": {"id_mm": 181.74, "area_mm2": 13748.86},
        "hdpe_dr15_5": {"id_mm": 186.43, "area_mm2": 14467.63},
    },
    275: {
        "hdpe_dr9":    {"id_mm": 203.84, "area_mm2": 17295.96},
        "hdpe_dr11":   {"id_mm": 216.19, "area_mm2": 19455.26},
        "hdpe_dr13_5": {"id_mm": 226.49, "area_mm2": 21353.24},
        "hdpe_dr15_5": {"id_mm": 232.35, "area_mm2": 22472.49},
    },
}


# --------------------------------------------------------------------------------------
# Table 9E — 31% allowable fill areas for two conductors or multiconductor cables
# (metal / PVC / EMT / ENT — not lead-sheathed)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_9E = {
    12: {
        "flexible_metal":               {"id_mm": 9.52,  "area_mm2": 22.07},
        "metallic_liquid_tight_flex":   {"id_mm": 12.29, "area_mm2": 36.78},
        "nonmetallic_liquid_tight_flex":{"id_mm": 12.07, "area_mm2": 35.47},
    },
    16: {
        "rigid_metal":                  {"id_mm": 16.05, "area_mm2": 62.72},
        "flexible_metal":               {"id_mm": 15.88, "area_mm2": 61.40},
        "rigid_pvc":                    {"id_mm": 14.57, "area_mm2": 51.69},
        "metallic_liquid_tight_flex":   {"id_mm": 15.80, "area_mm2": 60.78},
        "nonmetallic_liquid_tight_flex":{"id_mm": 15.49, "area_mm2": 58.42},
        "emt":                          {"id_mm": 15.40, "area_mm2": 57.74},
        "ent":                          {"id_mm": 14.58, "area_mm2": 51.76},
    },
    21: {
        "rigid_metal":                  {"id_mm": 21.23, "area_mm2": 109.74},
        "flexible_metal":               {"id_mm": 20.62, "area_mm2": 103.52},
        "rigid_pvc":                    {"id_mm": 19.77, "area_mm2": 95.16},
        "metallic_liquid_tight_flex":   {"id_mm": 20.83, "area_mm2": 105.64},
        "nonmetallic_liquid_tight_flex":{"id_mm": 20.45, "area_mm2": 101.82},
        "emt":                          {"id_mm": 20.50, "area_mm2": 102.32},
        "ent":                          {"id_mm": 19.66, "area_mm2": 94.11},
    },
    27: {
        "rigid_metal":                  {"id_mm": 27.00, "area_mm2": 177.49},
        "flexible_metal":               {"id_mm": 25.40, "area_mm2": 157.08},
        "rigid_pvc":                    {"id_mm": 25.40, "area_mm2": 157.08},
        "metallic_liquid_tight_flex":   {"id_mm": 26.44, "area_mm2": 170.21},
        "nonmetallic_liquid_tight_flex":{"id_mm": 25.91, "area_mm2": 163.45},
        "emt":                          {"id_mm": 26.20, "area_mm2": 167.13},
        "ent":                          {"id_mm": 25.37, "area_mm2": 156.71},
    },
    35: {
        "rigid_metal":                  {"id_mm": 35.41, "area_mm2": 305.28},
        "flexible_metal":               {"id_mm": 31.75, "area_mm2": 245.44},
        "rigid_pvc":                    {"id_mm": 31.75, "area_mm2": 245.44},
        "metallic_liquid_tight_flex":   {"id_mm": 35.05, "area_mm2": 299.11},
        "nonmetallic_liquid_tight_flex":{"id_mm": 34.54, "area_mm2": 290.47},
        "emt":                          {"id_mm": 34.60, "area_mm2": 291.48},
        "ent":                          {"id_mm": 33.73, "area_mm2": 277.00},
    },
    41: {
        "rigid_metal":                  {"id_mm": 41.25, "area_mm2": 414.29},
        "flexible_metal":               {"id_mm": 38.10, "area_mm2": 353.43},
        "rigid_pvc":                    {"id_mm": 38.10, "area_mm2": 353.43},
        "metallic_liquid_tight_flex":   {"id_mm": 40.01, "area_mm2": 389.75},
        "nonmetallic_liquid_tight_flex":{"id_mm": 40.01, "area_mm2": 389.75},
        "emt":                          {"id_mm": 40.50, "area_mm2": 399.36},
        "ent":                          {"id_mm": 39.57, "area_mm2": 381.23},
    },
    53: {
        "rigid_metal":                  {"id_mm": 52.91, "area_mm2": 681.60},
        "flexible_metal":               {"id_mm": 50.80, "area_mm2": 628.32},
        "rigid_pvc":                    {"id_mm": 50.80, "area_mm2": 628.32},
        "rigid_pvc_db2_es2":             {"id_mm": 50.80, "area_mm2": 628.32},
        "metallic_liquid_tight_flex":   {"id_mm": 51.31, "area_mm2": 641.00},
        "nonmetallic_liquid_tight_flex":{"id_mm": 51.69, "area_mm2": 650.53},
        "emt":                          {"id_mm": 52.10, "area_mm2": 660.89},
        "ent":                          {"id_mm": 51.18, "area_mm2": 637.75},
    },
    63: {
        "rigid_metal":                  {"id_mm": 63.22, "area_mm2": 973.11},
        "flexible_metal":               {"id_mm": 63.50, "area_mm2": 981.75},
        "rigid_pvc":                    {"id_mm": 61.30, "area_mm2": 914.90},
        "metallic_liquid_tight_flex":   {"id_mm": 62.99, "area_mm2": 966.04},
        "emt":                          {"id_mm": 69.40, "area_mm2": 1172.66},
    },
    78: {
        "rigid_metal":                  {"id_mm": 78.49, "area_mm2": 1499.96},
        "flexible_metal":               {"id_mm": 76.20, "area_mm2": 1413.71},
        "rigid_pvc":                    {"id_mm": 76.20, "area_mm2": 1413.71},
        "rigid_pvc_db2_es2":             {"id_mm": 76.20, "area_mm2": 1413.71},
        "metallic_liquid_tight_flex":   {"id_mm": 77.98, "area_mm2": 1480.53},
        "emt":                          {"id_mm": 85.20, "area_mm2": 1767.38},
    },
    91: {
        "rigid_metal":                  {"id_mm": 90.68, "area_mm2": 2002.05},
        "flexible_metal":               {"id_mm": 88.90, "area_mm2": 1924.22},
        "rigid_pvc":                    {"id_mm": 88.40, "area_mm2": 1902.64},
        "rigid_pvc_db2_es2":             {"id_mm": 88.40, "area_mm2": 1902.64},
        "metallic_liquid_tight_flex":   {"id_mm": 88.90, "area_mm2": 1924.22},
        "emt":                          {"id_mm": 97.40, "area_mm2": 2309.77},
    },
    103: {
        "rigid_metal":                  {"id_mm": 102.87, "area_mm2": 2576.49},
        "flexible_metal":               {"id_mm": 101.60, "area_mm2": 2513.27},
        "rigid_pvc":                    {"id_mm": 100.10, "area_mm2": 2439.61},
        "rigid_pvc_db2_es2":             {"id_mm": 100.10, "area_mm2": 2439.61},
        "metallic_liquid_tight_flex":   {"id_mm": 101.60, "area_mm2": 2513.27},
        "emt":                          {"id_mm": 110.00, "area_mm2": 2946.03},
    },
    129: {
        "rigid_metal":                  {"id_mm": 128.85, "area_mm2": 4042.22},
        "rigid_pvc":                    {"id_mm": 125.85, "area_mm2": 3856.19},
        "rigid_pvc_db2_es2":             {"id_mm": 126.35, "area_mm2": 3886.89},
        "emt":                          {"id_mm": 128.90, "area_mm2": 4045.00},
    },
    155: {
        "rigid_metal":                  {"id_mm": 154.76, "area_mm2": 5831.35},
        "rigid_pvc":                    {"id_mm": 149.75, "area_mm2": 5459.91},
        "rigid_pvc_db2_es2":             {"id_mm": 149.75, "area_mm2": 5459.91},
        "emt":                          {"id_mm": 154.80, "area_mm2": 5834.00},
    },
    200: {
        "rigid_pvc":                    {"id_mm": 199.39, "area_mm2": 9679.62},
    },
}


# --------------------------------------------------------------------------------------
# Table 9F — 31% allowable fill areas for two conductors or multiconductor cables
# (HDPE / RTRC conduits — not lead-sheathed)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_9F = {
    16: {
        "rtrc_ips":    {"id_mm": 17.27, "area_mm2": 72.62},
        "rtrc_id":     {"id_mm": 11.94, "area_mm2": 34.71},
        "hdpe_sch40":  {"id_mm": 14.67, "area_mm2": 52.40},
        "hdpe_sch80":  {"id_mm": 12.75, "area_mm2": 39.58},
        "hdpe_dr9":    {"id_mm": 15.47, "area_mm2": 58.27},
        "hdpe_dr11":   {"id_mm": 16.30, "area_mm2": 64.69},
        "hdpe_dr13_5": {"id_mm": 17.02, "area_mm2": 70.53},
        "hdpe_dr15_5": {"id_mm": 17.43, "area_mm2": 73.97},
    },
    21: {
        "rtrc_ips":    {"id_mm": 22.61, "area_mm2": 124.47},
        "rtrc_id":     {"id_mm": 18.29, "area_mm2": 81.45},
        "hdpe_sch40":  {"id_mm": 19.78, "area_mm2": 95.26},
        "hdpe_sch80":  {"id_mm": 17.70, "area_mm2": 76.28},
        "hdpe_dr9":    {"id_mm": 19.65, "area_mm2": 94.01},
        "hdpe_dr11":   {"id_mm": 20.73, "area_mm2": 104.63},
        "hdpe_dr13_5": {"id_mm": 21.63, "area_mm2": 113.91},
        "hdpe_dr15_5": {"id_mm": 22.14, "area_mm2": 119.35},
    },
    27: {
        "rtrc_ips":    {"id_mm": 29.34, "area_mm2": 209.59},
        "rtrc_id":     {"id_mm": 24.64, "area_mm2": 147.82},
        "hdpe_sch40":  {"id_mm": 25.40, "area_mm2": 157.08},
        "hdpe_sch80":  {"id_mm": 23.06, "area_mm2": 129.47},
        "hdpe_dr9":    {"id_mm": 24.86, "area_mm2": 150.47},
        "hdpe_dr11":   {"id_mm": 26.21, "area_mm2": 167.26},
        "hdpe_dr13_5": {"id_mm": 27.33, "area_mm2": 181.86},
        "hdpe_dr15_5": {"id_mm": 27.97, "area_mm2": 190.47},
    },
    35: {
        "rtrc_ips":    {"id_mm": 38.10, "area_mm2": 353.43},
        "rtrc_id":     {"id_mm": 30.99, "area_mm2": 233.83},
        "hdpe_sch40":  {"id_mm": 33.82, "area_mm2": 278.48},
        "hdpe_sch80":  {"id_mm": 31.10, "area_mm2": 235.49},
        "hdpe_dr9":    {"id_mm": 31.51, "area_mm2": 241.74},
        "hdpe_dr11":   {"id_mm": 33.31, "area_mm2": 270.15},
        "hdpe_dr13_5": {"id_mm": 34.73, "area_mm2": 293.67},
        "hdpe_dr15_5": {"id_mm": 35.54, "area_mm2": 307.53},
    },
    41: {
        "rtrc_ips":    {"id_mm": 44.20, "area_mm2": 475.66},
        "rtrc_id":     {"id_mm": 37.34, "area_mm2": 339.47},
        "hdpe_sch40":  {"id_mm": 39.63, "area_mm2": 382.38},
        "hdpe_sch80":  {"id_mm": 36.63, "area_mm2": 326.68},
        "hdpe_dr9":    {"id_mm": 36.10, "area_mm2": 317.30},
        "hdpe_dr11":   {"id_mm": 38.27, "area_mm2": 356.59},
        "hdpe_dr13_5": {"id_mm": 39.93, "area_mm2": 388.20},
        "hdpe_dr15_5": {"id_mm": 40.85, "area_mm2": 406.29},
    },
    53: {
        "rtrc_ips":    {"id_mm": 56.26, "area_mm2": 770.64},
        "rtrc_id":     {"id_mm": 50.29, "area_mm2": 615.76},
        "hdpe_sch40":  {"id_mm": 51.18, "area_mm2": 637.75},
        "hdpe_sch80":  {"id_mm": 47.82, "area_mm2": 556.76},
        "hdpe_dr9":    {"id_mm": 45.19, "area_mm2": 497.21},
        "hdpe_dr11":   {"id_mm": 47.91, "area_mm2": 558.86},
        "hdpe_dr13_5": {"id_mm": 50.18, "area_mm2": 613.07},
        "hdpe_dr15_5": {"id_mm": 51.40, "area_mm2": 643.25},
    },
    63: {
        "rtrc_ips":    {"id_mm": 69.60, "area_mm2": 1179.42},
        "rtrc_id":     {"id_mm": 63.00, "area_mm2": 966.35},
        "hdpe_sch40":  {"id_mm": 61.13, "area_mm2": 909.83},
        "hdpe_sch80":  {"id_mm": 56.97, "area_mm2": 790.21},
        "hdpe_dr9":    {"id_mm": 54.63, "area_mm2": 726.63},
        "hdpe_dr11":   {"id_mm": 57.92, "area_mm2": 816.79},
        "hdpe_dr13_5": {"id_mm": 60.68, "area_mm2": 896.48},
        "hdpe_dr15_5": {"id_mm": 62.24, "area_mm2": 943.17},
    },
    78: {
        "rtrc_ips":    {"id_mm": 84.84, "area_mm2": 1752.48},
        "rtrc_id":     {"id_mm": 75.69, "area_mm2": 1394.85},
        "hdpe_sch40":  {"id_mm": 76.14, "area_mm2": 1411.49},
        "hdpe_sch80":  {"id_mm": 71.38, "area_mm2": 1240.52},
        "hdpe_dr9":    {"id_mm": 66.56, "area_mm2": 1078.64},
        "hdpe_dr11":   {"id_mm": 70.60, "area_mm2": 1213.56},
        "hdpe_dr13_5": {"id_mm": 73.95, "area_mm2": 1331.46},
        "hdpe_dr15_5": {"id_mm": 75.85, "area_mm2": 1400.76},
    },
    103: {
        "rtrc_ips":    {"id_mm": 109.72, "area_mm2": 2931.05},
        "rtrc_id":     {"id_mm": 101.09, "area_mm2": 2488.10},
        "hdpe_sch40":  {"id_mm": 100.26, "area_mm2": 2447.41},
        "hdpe_sch80":  {"id_mm": 94.56, "area_mm2": 2177.04},
        "hdpe_dr9":    {"id_mm": 85.36, "area_mm2": 1774.03},
        "hdpe_dr11":   {"id_mm": 90.52, "area_mm2": 1994.99},
        "hdpe_dr13_5": {"id_mm": 94.83, "area_mm2": 2189.49},
        "hdpe_dr15_5": {"id_mm": 97.29, "area_mm2": 2304.56},
    },
    129: {
        "rtrc_ips":    {"id_mm": 136.14, "area_mm2": 4512.56},
        "rtrc_id":     {"id_mm": 126.24, "area_mm2": 3880.12},
        "hdpe_sch40":  {"id_mm": 125.91, "area_mm2": 3859.86},
        "hdpe_sch80":  {"id_mm": 119.25, "area_mm2": 3462.33},
        "hdpe_dr9":    {"id_mm": 105.54, "area_mm2": 2711.98},
        "hdpe_dr11":   {"id_mm": 111.93, "area_mm2": 3050.31},
        "hdpe_dr13_5": {"id_mm": 117.25, "area_mm2": 3347.17},
        "hdpe_dr15_5": {"id_mm": 120.29, "area_mm2": 3522.98},
    },
    155: {
        "rtrc_ips":    {"id_mm": 162.05, "area_mm2": 6393.66},
        "hdpe_sch40":  {"id_mm": 151.50, "area_mm2": 5588.26},
        "hdpe_sch80":  {"id_mm": 142.86, "area_mm2": 4969.04},
        "hdpe_dr9":    {"id_mm": 125.63, "area_mm2": 3842.72},
        "hdpe_dr11":   {"id_mm": 133.22, "area_mm2": 4321.06},
        "hdpe_dr13_5": {"id_mm": 139.57, "area_mm2": 4742.81},
        "hdpe_dr15_5": {"id_mm": 143.19, "area_mm2": 4992.03},
    },
    200: {
        "hdpe_sch40":  {"id_mm": 199.64, "area_mm2": 9703.91},
        "hdpe_dr9":    {"id_mm": 163.58, "area_mm2": 6514.96},
        "hdpe_dr11":   {"id_mm": 173.49, "area_mm2": 7328.25},
        "hdpe_dr13_5": {"id_mm": 181.74, "area_mm2": 8041.79},
        "hdpe_dr15_5": {"id_mm": 186.43, "area_mm2": 8462.20},
    },
    275: {
        "hdpe_dr9":    {"id_mm": 203.84, "area_mm2": 10116.50},
        "hdpe_dr11":   {"id_mm": 216.19, "area_mm2": 11379.49},
        "hdpe_dr13_5": {"id_mm": 226.49, "area_mm2": 12489.63},
        "hdpe_dr15_5": {"id_mm": 232.35, "area_mm2": 13144.28},
    },
}


# --------------------------------------------------------------------------------------
# Table 9G — 40% allowable fill areas for three or more conductors
# (metal / PVC / EMT / ENT — not lead-sheathed)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_9G = {
    12: {
        "flexible_metal":               {"id_mm": 9.52,  "area_mm2": 28.47},
        "metallic_liquid_tight_flex":   {"id_mm": 12.29, "area_mm2": 47.45},
        "nonmetallic_liquid_tight_flex":{"id_mm": 12.07, "area_mm2": 45.77},
    },
    16: {
        "rigid_metal":                  {"id_mm": 16.05, "area_mm2": 80.93},
        "flexible_metal":               {"id_mm": 15.88, "area_mm2": 79.22},
        "rigid_pvc":                    {"id_mm": 14.57, "area_mm2": 66.69},
        "metallic_liquid_tight_flex":   {"id_mm": 15.80, "area_mm2": 78.43},
        "nonmetallic_liquid_tight_flex":{"id_mm": 15.49, "area_mm2": 75.38},
        "emt":                          {"id_mm": 15.40, "area_mm2": 74.51},
        "ent":                          {"id_mm": 14.58, "area_mm2": 66.78},
    },
    21: {
        "rigid_metal":                  {"id_mm": 21.23, "area_mm2": 141.60},
        "flexible_metal":               {"id_mm": 20.62, "area_mm2": 133.58},
        "rigid_pvc":                    {"id_mm": 19.77, "area_mm2": 122.79},
        "metallic_liquid_tight_flex":   {"id_mm": 20.83, "area_mm2": 136.31},
        "nonmetallic_liquid_tight_flex":{"id_mm": 20.45, "area_mm2": 131.38},
        "emt":                          {"id_mm": 20.50, "area_mm2": 132.03},
        "ent":                          {"id_mm": 19.66, "area_mm2": 121.43},
    },
    27: {
        "rigid_metal":                  {"id_mm": 27.00, "area_mm2": 229.02},
        "flexible_metal":               {"id_mm": 25.40, "area_mm2": 202.68},
        "rigid_pvc":                    {"id_mm": 25.40, "area_mm2": 202.68},
        "metallic_liquid_tight_flex":   {"id_mm": 26.44, "area_mm2": 219.62},
        "nonmetallic_liquid_tight_flex":{"id_mm": 25.91, "area_mm2": 210.90},
        "emt":                          {"id_mm": 26.20, "area_mm2": 215.65},
        "ent":                          {"id_mm": 25.37, "area_mm2": 202.20},
    },
    35: {
        "rigid_metal":                  {"id_mm": 35.41, "area_mm2": 393.91},
        "flexible_metal":               {"id_mm": 31.75, "area_mm2": 316.69},
        "rigid_pvc":                    {"id_mm": 31.75, "area_mm2": 316.69},
        "metallic_liquid_tight_flex":   {"id_mm": 35.05, "area_mm2": 385.95},
        "nonmetallic_liquid_tight_flex":{"id_mm": 34.54, "area_mm2": 374.80},
        "emt":                          {"id_mm": 34.60, "area_mm2": 376.10},
        "ent":                          {"id_mm": 33.73, "area_mm2": 357.42},
    },
    41: {
        "rigid_metal":                  {"id_mm": 41.25, "area_mm2": 534.56},
        "flexible_metal":               {"id_mm": 38.10, "area_mm2": 456.04},
        "rigid_pvc":                    {"id_mm": 38.10, "area_mm2": 456.04},
        "metallic_liquid_tight_flex":   {"id_mm": 40.01, "area_mm2": 502.91},
        "nonmetallic_liquid_tight_flex":{"id_mm": 40.01, "area_mm2": 502.91},
        "emt":                          {"id_mm": 40.50, "area_mm2": 515.30},
        "ent":                          {"id_mm": 39.57, "area_mm2": 491.91},
    },
    53: {
        "rigid_metal":                  {"id_mm": 52.91, "area_mm2": 879.48},
        "flexible_metal":               {"id_mm": 50.80, "area_mm2": 810.73},
        "rigid_pvc":                    {"id_mm": 50.80, "area_mm2": 810.73},
        "rigid_pvc_db2_es2":             {"id_mm": 50.80, "area_mm2": 810.73},
        "metallic_liquid_tight_flex":   {"id_mm": 51.31, "area_mm2": 827.09},
        "nonmetallic_liquid_tight_flex":{"id_mm": 51.69, "area_mm2": 839.39},
        "emt":                          {"id_mm": 52.10, "area_mm2": 852.76},
        "ent":                          {"id_mm": 51.18, "area_mm2": 822.91},
    },
    63: {
        "rigid_metal":                  {"id_mm": 63.22, "area_mm2": 1255.62},
        "flexible_metal":               {"id_mm": 63.50, "area_mm2": 1266.77},
        "rigid_pvc":                    {"id_mm": 61.30, "area_mm2": 1180.51},
        "metallic_liquid_tight_flex":   {"id_mm": 62.99, "area_mm2": 1246.50},
        "emt":                          {"id_mm": 69.40, "area_mm2": 1513.10},
    },
    78: {
        "rigid_metal":                  {"id_mm": 78.49, "area_mm2": 1935.43},
        "flexible_metal":               {"id_mm": 76.20, "area_mm2": 1824.15},
        "rigid_pvc":                    {"id_mm": 76.20, "area_mm2": 1824.15},
        "rigid_pvc_db2_es2":             {"id_mm": 76.20, "area_mm2": 1824.15},
        "metallic_liquid_tight_flex":   {"id_mm": 77.98, "area_mm2": 1910.36},
        "emt":                          {"id_mm": 85.20, "area_mm2": 2280.49},
    },
    91: {
        "rigid_metal":                  {"id_mm": 90.68, "area_mm2": 2583.29},
        "flexible_metal":               {"id_mm": 88.90, "area_mm2": 2482.87},
        "rigid_pvc":                    {"id_mm": 88.40, "area_mm2": 2455.02},
        "rigid_pvc_db2_es2":             {"id_mm": 88.40, "area_mm2": 2455.02},
        "metallic_liquid_tight_flex":   {"id_mm": 88.90, "area_mm2": 2482.87},
        "emt":                          {"id_mm": 97.40, "area_mm2": 2980.35},
    },
    103: {
        "rigid_metal":                  {"id_mm": 102.87, "area_mm2": 3324.51},
        "flexible_metal":               {"id_mm": 101.60, "area_mm2": 3242.93},
        "rigid_pvc":                    {"id_mm": 100.10, "area_mm2": 3147.88},
        "rigid_pvc_db2_es2":             {"id_mm": 100.10, "area_mm2": 3147.88},
        "metallic_liquid_tight_flex":   {"id_mm": 101.60, "area_mm2": 3242.93},
        "emt":                          {"id_mm": 110.00, "area_mm2": 3801.33},
    },
    129: {
        "rigid_metal":                  {"id_mm": 128.85, "area_mm2": 5215.77},
        "rigid_pvc":                    {"id_mm": 125.85, "area_mm2": 4975.72},
        "rigid_pvc_db2_es2":             {"id_mm": 126.35, "area_mm2": 5015.34},
        "emt":                          {"id_mm": 128.90, "area_mm2": 5520.00},
    },
    155: {
        "rigid_metal":                  {"id_mm": 154.76, "area_mm2": 7524.32},
        "rigid_pvc":                    {"id_mm": 149.75, "area_mm2": 7045.04},
        "rigid_pvc_db2_es2":             {"id_mm": 149.75, "area_mm2": 7045.04},
        "emt":                          {"id_mm": 154.80, "area_mm2": 7528.00},
    },
    200: {
        "rigid_pvc":                    {"id_mm": 199.39, "area_mm2": 12489.83},
    },
}


# --------------------------------------------------------------------------------------
# Table 9H — 40% allowable fill areas for three or more conductors
# (HDPE / RTRC conduits — not lead-sheathed)
# — extracted from provided images
# --------------------------------------------------------------------------------------
TABLE_9H = {
    16: {
        "rtrc_ips":    {"id_mm": 17.27, "area_mm2": 93.70},
        "rtrc_id":     {"id_mm": 11.94, "area_mm2": 44.79},
        "hdpe_sch40":  {"id_mm": 14.67, "area_mm2": 67.61},
        "hdpe_sch80":  {"id_mm": 12.75, "area_mm2": 51.07},
        "hdpe_dr9":    {"id_mm": 15.47, "area_mm2": 75.18},
        "hdpe_dr11":   {"id_mm": 16.30, "area_mm2": 83.47},
        "hdpe_dr13_5": {"id_mm": 17.02, "area_mm2": 91.01},
        "hdpe_dr15_5": {"id_mm": 17.43, "area_mm2": 95.44},
    },
    21: {
        "rtrc_ips":    {"id_mm": 22.61, "area_mm2": 160.60},
        "rtrc_id":     {"id_mm": 18.29, "area_mm2": 105.09},
        "hdpe_sch40":  {"id_mm": 19.78, "area_mm2": 122.91},
        "hdpe_sch80":  {"id_mm": 17.70, "area_mm2": 98.42},
        "hdpe_dr9":    {"id_mm": 19.65, "area_mm2": 121.30},
        "hdpe_dr11":   {"id_mm": 20.73, "area_mm2": 135.00},
        "hdpe_dr13_5": {"id_mm": 21.63, "area_mm2": 146.98},
        "hdpe_dr15_5": {"id_mm": 22.14, "area_mm2": 153.99},
    },
    27: {
        "rtrc_ips":    {"id_mm": 29.34, "area_mm2": 270.44},
        "rtrc_id":     {"id_mm": 24.64, "area_mm2": 190.74},
        "hdpe_sch40":  {"id_mm": 25.40, "area_mm2": 202.68},
        "hdpe_sch80":  {"id_mm": 23.06, "area_mm2": 167.06},
        "hdpe_dr9":    {"id_mm": 24.86, "area_mm2": 194.16},
        "hdpe_dr11":   {"id_mm": 26.21, "area_mm2": 215.82},
        "hdpe_dr13_5": {"id_mm": 27.33, "area_mm2": 234.65},
        "hdpe_dr15_5": {"id_mm": 27.97, "area_mm2": 245.77},
    },
    35: {
        "rtrc_ips":    {"id_mm": 38.10, "area_mm2": 456.04},
        "rtrc_id":     {"id_mm": 30.99, "area_mm2": 301.71},
        "hdpe_sch40":  {"id_mm": 33.82, "area_mm2": 359.33},
        "hdpe_sch80":  {"id_mm": 31.10, "area_mm2": 303.86},
        "hdpe_dr9":    {"id_mm": 31.51, "area_mm2": 311.92},
        "hdpe_dr11":   {"id_mm": 33.31, "area_mm2": 348.58},
        "hdpe_dr13_5": {"id_mm": 34.73, "area_mm2": 378.93},
        "hdpe_dr15_5": {"id_mm": 35.54, "area_mm2": 396.81},
    },
    41: {
        "rtrc_ips":    {"id_mm": 44.20, "area_mm2": 613.75},
        "rtrc_id":     {"id_mm": 37.34, "area_mm2": 438.02},
        "hdpe_sch40":  {"id_mm": 39.63, "area_mm2": 493.40},
        "hdpe_sch80":  {"id_mm": 36.63, "area_mm2": 421.53},
        "hdpe_dr9":    {"id_mm": 36.10, "area_mm2": 409.42},
        "hdpe_dr11":   {"id_mm": 38.27, "area_mm2": 460.12},
        "hdpe_dr13_5": {"id_mm": 39.93, "area_mm2": 500.90},
        "hdpe_dr15_5": {"id_mm": 40.85, "area_mm2": 524.24},
    },
    53: {
        "rtrc_ips":    {"id_mm": 56.26, "area_mm2": 994.37},
        "rtrc_id":     {"id_mm": 50.29, "area_mm2": 794.54},
        "hdpe_sch40":  {"id_mm": 51.18, "area_mm2": 822.91},
        "hdpe_sch80":  {"id_mm": 47.82, "area_mm2": 718.40},
        "hdpe_dr9":    {"id_mm": 45.19, "area_mm2": 641.56},
        "hdpe_dr11":   {"id_mm": 47.91, "area_mm2": 721.11},
        "hdpe_dr13_5": {"id_mm": 50.18, "area_mm2": 791.06},
        "hdpe_dr15_5": {"id_mm": 51.40, "area_mm2": 830.00},
    },
    63: {
        "rtrc_ips":    {"id_mm": 69.60, "area_mm2": 1521.84},
        "rtrc_id":     {"id_mm": 63.00, "area_mm2": 1246.90},
        "hdpe_sch40":  {"id_mm": 61.13, "area_mm2": 1173.97},
        "hdpe_sch80":  {"id_mm": 56.97, "area_mm2": 1019.63},
        "hdpe_dr9":    {"id_mm": 54.63, "area_mm2": 937.59},
        "hdpe_dr11":   {"id_mm": 57.92, "area_mm2": 1053.92},
        "hdpe_dr13_5": {"id_mm": 60.68, "area_mm2": 1156.75},
        "hdpe_dr15_5": {"id_mm": 62.24, "area_mm2": 1217.00},
    },
    78: {
        "rtrc_ips":    {"id_mm": 84.84, "area_mm2": 2261.26},
        "rtrc_id":     {"id_mm": 75.69, "area_mm2": 1799.81},
        "hdpe_sch40":  {"id_mm": 76.14, "area_mm2": 1821.28},
        "hdpe_sch80":  {"id_mm": 71.38, "area_mm2": 1600.67},
        "hdpe_dr9":    {"id_mm": 66.56, "area_mm2": 1391.80},
        "hdpe_dr11":   {"id_mm": 70.60, "area_mm2": 1565.88},
        "hdpe_dr13_5": {"id_mm": 73.95, "area_mm2": 1718.01},
        "hdpe_dr15_5": {"id_mm": 75.85, "area_mm2": 1807.43},
    },
    103: {
        "rtrc_ips":    {"id_mm": 109.72, "area_mm2": 3782.00},
        "rtrc_id":     {"id_mm": 101.09, "area_mm2": 3210.45},
        "hdpe_sch40":  {"id_mm": 100.26, "area_mm2": 3157.95},
        "hdpe_sch80":  {"id_mm": 94.56, "area_mm2": 2809.08},
        "hdpe_dr9":    {"id_mm": 85.36, "area_mm2": 2289.07},
        "hdpe_dr11":   {"id_mm": 90.52, "area_mm2": 2574.18},
        "hdpe_dr13_5": {"id_mm": 94.83, "area_mm2": 2825.15},
        "hdpe_dr15_5": {"id_mm": 97.29, "area_mm2": 2973.63},
    },
    129: {
        "rtrc_ips":    {"id_mm": 136.14, "area_mm2": 5822.66},
        "rtrc_id":     {"id_mm": 126.24, "area_mm2": 5006.61},
        "hdpe_sch40":  {"id_mm": 125.91, "area_mm2": 4980.47},
        "hdpe_sch80":  {"id_mm": 119.25, "area_mm2": 4467.52},
        "hdpe_dr9":    {"id_mm": 105.54, "area_mm2": 3499.32},
        "hdpe_dr11":   {"id_mm": 111.93, "area_mm2": 3935.89},
        "hdpe_dr13_5": {"id_mm": 117.25, "area_mm2": 4318.92},
        "hdpe_dr15_5": {"id_mm": 120.29, "area_mm2": 4545.79},
    },
    155: {
        "rtrc_ips":    {"id_mm": 162.05, "area_mm2": 8249.89},
        "hdpe_sch40":  {"id_mm": 151.50, "area_mm2": 7210.66},
        "hdpe_sch80":  {"id_mm": 142.86, "area_mm2": 6411.67},
        "hdpe_dr9":    {"id_mm": 125.63, "area_mm2": 4958.34},
        "hdpe_dr11":   {"id_mm": 133.22, "area_mm2": 5575.56},
        "hdpe_dr13_5": {"id_mm": 139.57, "area_mm2": 6119.75},
        "hdpe_dr15_5": {"id_mm": 143.19, "area_mm2": 6441.33},
    },
    200: {
        "hdpe_sch40":  {"id_mm": 199.64, "area_mm2": 12521.17},
        "hdpe_dr9":    {"id_mm": 163.58, "area_mm2": 8406.40},
        "hdpe_dr11":   {"id_mm": 173.49, "area_mm2": 9455.81},
        "hdpe_dr13_5": {"id_mm": 181.74, "area_mm2": 10376.50},
        "hdpe_dr15_5": {"id_mm": 186.43, "area_mm2": 10918.96},
    },
    275: {
        "hdpe_dr9":    {"id_mm": 203.84, "area_mm2": 13053.55},
        "hdpe_dr11":   {"id_mm": 216.19, "area_mm2": 14683.21},
        "hdpe_dr13_5": {"id_mm": 226.49, "area_mm2": 16115.65},
        "hdpe_dr15_5": {"id_mm": 232.35, "area_mm2": 16960.37},
    },
}





# Backwards-compatible helpers (Table 6A)
def get_table_6a_entry(construction: str, size: str) -> Optional[Dict[str, Any]]:
    return get_table_entry(TABLE_6A, construction, size)


def get_table_6a_area_mm2(construction: str, size: str, n_conductors: int) -> Optional[float]:
    return get_table_area_mm2(TABLE_6A, construction, size, n_conductors)


# Helpers (Table 6B)
def get_table_6b_entry(construction: str, size: str) -> Optional[Dict[str, Any]]:
    return get_table_entry(TABLE_6B, construction, size)


def get_table_6b_area_mm2(construction: str, size: str, n_conductors: int) -> Optional[float]:
    return get_table_area_mm2(TABLE_6B, construction, size, n_conductors)


# Helpers (Table 6C)
def get_table_6c_entry(construction: str, size: str) -> Optional[Dict[str, Any]]:
    return get_table_entry(TABLE_6C, construction, size)


def get_table_6c_area_mm2(construction: str, size: str, n_conductors: int) -> Optional[float]:
    return get_table_area_mm2(TABLE_6C, construction, size, n_conductors)


# Helpers (Table 6D)
def get_table_6d_entry(construction: str, size: str) -> Optional[Dict[str, Any]]:
    return get_table_entry(TABLE_6D, construction, size)

def get_table_6d_area_mm2(construction: str, size: str, n_conductors: int) -> Optional[float]:
    return get_table_area_mm2(TABLE_6D, construction, size, n_conductors)


# Helpers (Table 6E)
def get_table_6e_entry(construction: str, size: str) -> Optional[Dict[str, Any]]:
    return get_table_entry(TABLE_6E, construction, size)

def get_table_6e_area_mm2(construction: str, size: str, n_conductors: int) -> Optional[float]:
    return get_table_area_mm2(TABLE_6E, construction, size, n_conductors)


# Helpers (Table 6F)
def get_table_6f_entry(construction: str, size: str) -> Optional[Dict[str, Any]]:
    return get_table_entry(TABLE_6F, construction, size)

def get_table_6f_area_mm2(construction: str, size: str, n_conductors: int) -> Optional[float]:
    return get_table_area_mm2(TABLE_6F, construction, size, n_conductors)


# Helpers (Table 6G)
def get_table_6g_entry(construction: str, size: str) -> Optional[Dict[str, Any]]:
    return get_table_entry(TABLE_6G, construction, size)

def get_table_6g_area_mm2(construction: str, size: str, n_conductors: int) -> Optional[float]:
    return get_table_area_mm2(TABLE_6G, construction, size, n_conductors)


# Helpers (Table 6H)
def get_table_6h_entry(construction: str, size: str) -> Optional[Dict[str, Any]]:
    return get_table_entry(TABLE_6H, construction, size)

def get_table_6h_area_mm2(construction: str, size: str, n_conductors: int) -> Optional[float]:
    return get_table_area_mm2(TABLE_6H, construction, size, n_conductors)


# Helpers (Table 6I)
def get_table_6i_entry(construction: str, size: str) -> Optional[Dict[str, Any]]:
    return get_table_entry(TABLE_6I, construction, size)

def get_table_6i_area_mm2(construction: str, size: str, n_conductors: int) -> Optional[float]:
    return get_table_area_mm2(TABLE_6I, construction, size, n_conductors)


# Helpers (Table 6J)
def get_table_6j_entry(construction: str, size: str) -> Optional[Dict[str, Any]]:
    return get_table_entry(TABLE_6J, construction, size)

def get_table_6j_area_mm2(construction: str, size: str, n_conductors: int) -> Optional[float]:
    return get_table_area_mm2(TABLE_6J, construction, size, n_conductors)


# Helpers (Table 6K)
def get_table_6k_entry(construction: str, size: str) -> Optional[Dict[str, Any]]:
    return get_table_entry(TABLE_6K, construction, size)

def get_table_6k_area_mm2(construction: str, size: str, n_conductors: int) -> Optional[float]:
    return get_table_area_mm2(TABLE_6K, construction, size, n_conductors)


# --------------------------------------------------------------------------------------
# Unified helper for Table 9A + 9B
# --------------------------------------------------------------------------------------

# Optional: a friendly map for UI labels -> internal keys
CONDUIT_TYPE_LABELS = {
    # 9A
    "Rigid metal conduit (RMC)": "rigid_metal",
    "Flexible metal conduit (FMC)": "flexible_metal",
    "Rigid PVC conduit": "rigid_pvc",
    "Rigid PVC (Type EB1 / DB2 / ES2)": "rigid_pvc_db2_es2",
    "Liquid-tight flexible metal conduit (LFMC)": "metallic_liquid_tight_flex",
    "Liquid-tight flexible nonmetallic conduit (LFNC)": "nonmetallic_liquid_tight_flex",
    "Electrical metallic tubing (EMT)": "emt",
    "Electrical nonmetallic tubing (ENT)": "ent",

    # 9B
    "Rigid RTRC marked IPS": "rtrc_ips",
    "Rigid RTRC marked ID": "rtrc_id",
    "HDPE Schedule 40": "hdpe_sch40",
    "HDPE Schedule 80": "hdpe_sch80",
    "HDPE DR9": "hdpe_dr9",
    "HDPE DR11": "hdpe_dr11",
    "HDPE DR13.5": "hdpe_dr13_5",
    "HDPE DR15.5": "hdpe_dr15_5",
}

# Which conduit types belong to which table (handy for UI filtering)
TABLE_9A_TYPES = {
    "rigid_metal",
    "flexible_metal",
    "rigid_pvc",
    "rigid_pvc_db2_es2",
    "metallic_liquid_tight_flex",
    "nonmetallic_liquid_tight_flex",
    "emt",
    "ent",
}
TABLE_9B_TYPES = {
    "rtrc_ips",
    "rtrc_id",
    "hdpe_sch40",
    "hdpe_sch80",
    "hdpe_dr9",
    "hdpe_dr11",
    "hdpe_dr13_5",
    "hdpe_dr15_5",
}


def get_conduit_9a9b(conduit_type: str, trade_size_mm: int):
    """
    Unified lookup for Tables 9A and 9B (100% fill ID and Area).
    Returns dict: {"id_mm": float, "area_mm2": float/int} or None.

    conduit_type: one of the internal keys (see CONDUIT_TYPE_LABELS values)
    trade_size_mm: nominal trade size (e.g., 16, 21, 27, 35, ...)
    """
    if conduit_type in TABLE_9A_TYPES:
        return TABLE_9A.get(trade_size_mm, {}).get(conduit_type)
    if conduit_type in TABLE_9B_TYPES:
        return TABLE_9B.get(trade_size_mm, {}).get(conduit_type)
    return None


def get_conduit_area_mm2(conduit_type: str, trade_size_mm: int, fill_fraction: float = 1.0):
    """
    Convenience helper: returns the usable area (mm²) after applying fill_fraction.
    Example fill_fraction:
      - 1.00 for '100%' (table value)
      - 0.53 for 1 conductor
      - 0.31 for 2 conductors
      - 0.40 for 3+ conductors
    """
    entry = get_conduit_9a9b(conduit_type, trade_size_mm)
    if not entry:
        return None
    try:
        return float(entry["area_mm2"]) * float(fill_fraction)
    except Exception:
        return None


def get_conduit_id_mm(conduit_type: str, trade_size_mm: int):
    """Convenience helper: returns internal diameter (mm) or None."""
    entry = get_conduit_9a9b(conduit_type, trade_size_mm)
    if not entry:
        return None
    try:
        return float(entry["id_mm"])
    except Exception:
        return None


# Helper for Table 9C (53% fill, single conductor or multiconductor cable)
def get_table_9c(conduit_type: str, trade_size_mm: int):
    """
    Returns dict with keys: 'id_mm', 'area_mm2' at 53% fill.
    conduit_type keys match those used in Tables 9A / 9B helpers.
    """
    return TABLE_9C.get(trade_size_mm, {}).get(conduit_type)

# Helper for Table 9D (53% fill, HDPE / RTRC)
def get_table_9d(conduit_type: str, trade_size_mm: int):
    """
    Returns dict with keys: 'id_mm', 'area_mm2' at 53% fill.
    conduit_type keys match those used in Table 9B.
    """
    return TABLE_9D.get(trade_size_mm, {}).get(conduit_type)


# Helper for Table 9E (31% fill)
def get_table_9e(conduit_type: str, trade_size_mm: int):
    """
    Returns dict with keys: 'id_mm', 'area_mm2' at 31% fill.
    conduit_type keys match those used in Tables 9A / 9C helpers.
    """
    return TABLE_9E.get(trade_size_mm, {}).get(conduit_type)


# Helper for Table 9F (31% fill, HDPE / RTRC)
def get_table_9f(conduit_type: str, trade_size_mm: int):
    """
    Returns dict with keys: 'id_mm', 'area_mm2' at 31% fill.
    conduit_type keys match those used in Table 9B.
    """
    return TABLE_9F.get(trade_size_mm, {}).get(conduit_type)


# Helper for Table 9G (40% fill)
def get_table_9g(conduit_type: str, trade_size_mm: int):
    """
    Returns dict with keys: 'id_mm', 'area_mm2' at 40% fill.
    conduit_type keys match those used in Tables 9A / 9C / 9E helpers.
    """
    return TABLE_9G.get(trade_size_mm, {}).get(conduit_type)


# Helper for Table 9H (40% fill, HDPE / RTRC)
def get_table_9h(conduit_type: str, trade_size_mm: int):
    """
    Returns dict with keys: 'id_mm', 'area_mm2' at 40% fill.
    conduit_type keys match those used in Table 9B.
    """
    return TABLE_9H.get(trade_size_mm, {}).get(conduit_type)



def get_allowable_conduit_area_mm2(conduit_type: str, trade_size_mm: int, n_conductors: int):
    """
    Returns the maximum allowable conductor area (mm²) for a conduit,
    based on OESC Tables 9A–9H.

    Rules:
    - 1 conductor  → 53% tables (9C or 9D)
    - 2 conductors → 31% tables (9E or 9F)
    - ≥3 conductors → 40% tables (9G or 9H)

    conduit_type must match the unified conduit keys used throughout
    (rigid_metal, emt, hdpe_dr11, rtrc_ips, etc.)
    """

    # One conductor → 53%
    if n_conductors == 1:
        if conduit_type in TABLE_9A_TYPES:
            entry = get_table_9c(conduit_type, trade_size_mm)
        else:
            entry = get_table_9d(conduit_type, trade_size_mm)

    # Two conductors → 31%
    elif n_conductors == 2:
        if conduit_type in TABLE_9A_TYPES:
            entry = get_table_9e(conduit_type, trade_size_mm)
        else:
            entry = get_table_9f(conduit_type, trade_size_mm)

    # Three or more conductors → 40%
    else:
        if conduit_type in TABLE_9A_TYPES:
            entry = get_table_9g(conduit_type, trade_size_mm)
        else:
            entry = get_table_9h(conduit_type, trade_size_mm)

    if not entry:
        return None

    return entry["area_mm2"]


# =============================================================================
# Table Library (Tables 1–72+): Registry + unified access helpers
# =============================================================================
# This section adds:
#   - New embedded OESC tables (1, 2, 5A–5D, 7, 8)
#   - A registry so the Streamlit app can browse/search all tables in one place
#   - Backwards-compatible: does NOT change existing helpers used elsewhere
#
# NOTE: Table values were transcribed from the provided table images.
# =============================================================================

from typing import Any, Dict, List, Optional, Tuple

def _try_import_pandas():
    try:
        import pandas as pd  # type: ignore
        return pd
    except Exception:
        return None

def _df(rows: List[Dict[str, Any]]):
    pd = _try_import_pandas()
    if pd is None:
        return rows
    return pd.DataFrame(rows)

# ----------------------------
# New tables (embedded)
# ----------------------------

TABLE_1 = {
    "title": "Table 1 — Ampacities for single copper conductors in free air (30°C)",
    "units": "A",
    "columns": ["60°C", "75°C", "90°C", "110°C", "125°C", "200°C"],
    "rows": [
        {"Size (AWG/kcmil)": "14**", "60°C": 25, "75°C": 30, "90°C": 35, "110°C": 40, "125°C": 40, "200°C": 50},
        {"Size (AWG/kcmil)": "12**", "60°C": 30, "75°C": 35, "90°C": 40, "110°C": 45, "125°C": 45, "200°C": 55},
        {"Size (AWG/kcmil)": "10**", "60°C": 40, "75°C": 50, "90°C": 55, "110°C": 65, "125°C": 65, "200°C": 80},
        {"Size (AWG/kcmil)": "8", "60°C": 60, "75°C": 70, "90°C": 80, "110°C": 90, "125°C": 95, "200°C": 115},
        {"Size (AWG/kcmil)": "6", "60°C": 80, "75°C": 95, "90°C": 105, "110°C": 120, "125°C": 130, "200°C": 155},
        {"Size (AWG/kcmil)": "4", "60°C": 105, "75°C": 125, "90°C": 140, "110°C": 160, "125°C": 170, "200°C": 205},
        {"Size (AWG/kcmil)": "3", "60°C": 120, "75°C": 145, "90°C": 165, "110°C": 185, "125°C": 195, "200°C": 240},
        {"Size (AWG/kcmil)": "2", "60°C": 140, "75°C": 170, "90°C": 190, "110°C": 215, "125°C": 230, "200°C": 280},
        {"Size (AWG/kcmil)": "1", "60°C": 165, "75°C": 195, "90°C": 220, "110°C": 245, "125°C": 265, "200°C": 320},
        {"Size (AWG/kcmil)": "0", "60°C": 195, "75°C": 230, "90°C": 260, "110°C": 290, "125°C": 310, "200°C": 375},
        {"Size (AWG/kcmil)": "00", "60°C": 220, "75°C": 265, "90°C": 300, "110°C": 335, "125°C": 355, "200°C": 435},
        {"Size (AWG/kcmil)": "000", "60°C": 260, "75°C": 310, "90°C": 350, "110°C": 390, "125°C": 420, "200°C": 510},
        {"Size (AWG/kcmil)": "0000", "60°C": 300, "75°C": 360, "90°C": 405, "110°C": 455, "125°C": 485, "200°C": 590},
        {"Size (AWG/kcmil)": "250", "60°C": 340, "75°C": 405, "90°C": 455, "110°C": 510, "125°C": 545, "200°C": None},
        {"Size (AWG/kcmil)": "300", "60°C": 370, "75°C": 445, "90°C": 500, "110°C": 560, "125°C": 600, "200°C": None},
        {"Size (AWG/kcmil)": "350", "60°C": 425, "75°C": 505, "90°C": 570, "110°C": 640, "125°C": 680, "200°C": None},
        {"Size (AWG/kcmil)": "400", "60°C": 455, "75°C": 545, "90°C": 615, "110°C": 690, "125°C": 735, "200°C": None},
        {"Size (AWG/kcmil)": "500", "60°C": 520, "75°C": 620, "90°C": 700, "110°C": 785, "125°C": 835, "200°C": None},
        {"Size (AWG/kcmil)": "600", "60°C": 580, "75°C": 690, "90°C": 780, "110°C": 870, "125°C": 930, "200°C": None},
        {"Size (AWG/kcmil)": "700", "60°C": 630, "75°C": 755, "90°C": 850, "110°C": 955, "125°C": 1020, "200°C": None},
        {"Size (AWG/kcmil)": "750", "60°C": 655, "75°C": 785, "90°C": 885, "110°C": 990, "125°C": 1060, "200°C": None},
        {"Size (AWG/kcmil)": "800", "60°C": 680, "75°C": 815, "90°C": 920, "110°C": 1030, "125°C": 1100, "200°C": None},
        {"Size (AWG/kcmil)": "900", "60°C": 730, "75°C": 870, "90°C": 980, "110°C": 1100, "125°C": 1175, "200°C": None},
        {"Size (AWG/kcmil)": "1000", "60°C": 785, "75°C": 935, "90°C": 1055, "110°C": 1180, "125°C": 1260, "200°C": None},
        {"Size (AWG/kcmil)": "1250", "60°C": 890, "75°C": 1065, "90°C": 1200, "110°C": 1345, "125°C": None, "200°C": None},
        {"Size (AWG/kcmil)": "1500", "60°C": 985, "75°C": 1175, "90°C": 1325, "110°C": 1485, "125°C": None, "200°C": None},
        {"Size (AWG/kcmil)": "1750", "60°C": 1070, "75°C": 1280, "90°C": 1445, "110°C": 1620, "125°C": None, "200°C": None},
        {"Size (AWG/kcmil)": "2000", "60°C": 1160, "75°C": 1385, "90°C": 1560, "110°C": 1750, "125°C": None, "200°C": None},
    ],
}

TABLE_2 = {
    "title": "Table 2 — Ampacities (≤3 insulated copper conductors) in raceway/cable (30°C)",
    "units": "A",
    "columns": ["60°C", "75°C", "90°C", "110°C", "125°C", "200°C"],
    "rows": [
        {"Size (AWG/kcmil)": "14s", "60°C": 15, "75°C": 20, "90°C": 25, "110°C": 25, "125°C": 30, "200°C": 35},
        {"Size (AWG/kcmil)": "12s", "60°C": 20, "75°C": 25, "90°C": 30, "110°C": 30, "125°C": 35, "200°C": 40},
        {"Size (AWG/kcmil)": "10s", "60°C": 30, "75°C": 35, "90°C": 40, "110°C": 45, "125°C": 45, "200°C": 60},
        {"Size (AWG/kcmil)": "8", "60°C": 40, "75°C": 50, "90°C": 55, "110°C": 65, "125°C": 65, "200°C": 80},
        {"Size (AWG/kcmil)": "6", "60°C": 55, "75°C": 65, "90°C": 75, "110°C": 80, "125°C": 90, "200°C": 110},
        {"Size (AWG/kcmil)": "4", "60°C": 70, "75°C": 85, "90°C": 95, "110°C": 105, "125°C": 115, "200°C": 140},
        {"Size (AWG/kcmil)": "3", "60°C": 85, "75°C": 100, "90°C": 115, "110°C": 125, "125°C": 135, "200°C": 165},
        {"Size (AWG/kcmil)": "2", "60°C": 95, "75°C": 115, "90°C": 130, "110°C": 145, "125°C": 155, "200°C": 190},
        {"Size (AWG/kcmil)": "1", "60°C": 110, "75°C": 130, "90°C": 145, "110°C": 165, "125°C": 175, "200°C": 215},
        {"Size (AWG/kcmil)": "0", "60°C": 125, "75°C": 150, "90°C": 170, "110°C": 190, "125°C": 200, "200°C": 245},
        {"Size (AWG/kcmil)": "00", "60°C": 145, "75°C": 175, "90°C": 195, "110°C": 220, "125°C": 235, "200°C": 290},
        {"Size (AWG/kcmil)": "000", "60°C": 165, "75°C": 200, "90°C": 225, "110°C": 255, "125°C": 270, "200°C": 330},
        {"Size (AWG/kcmil)": "0000", "60°C": 195, "75°C": 230, "90°C": 260, "110°C": 290, "125°C": 310, "200°C": 380},
        {"Size (AWG/kcmil)": "250", "60°C": 215, "75°C": 255, "90°C": 290, "110°C": 320, "125°C": 345, "200°C": None},
        {"Size (AWG/kcmil)": "300", "60°C": 240, "75°C": 285, "90°C": 320, "110°C": 360, "125°C": 385, "200°C": None},
        {"Size (AWG/kcmil)": "350", "60°C": 260, "75°C": 310, "90°C": 350, "110°C": 390, "125°C": 420, "200°C": None},
        {"Size (AWG/kcmil)": "400", "60°C": 280, "75°C": 335, "90°C": 380, "110°C": 425, "125°C": 450, "200°C": None},
        {"Size (AWG/kcmil)": "500", "60°C": 320, "75°C": 380, "90°C": 430, "110°C": 480, "125°C": 510, "200°C": None},
        {"Size (AWG/kcmil)": "600", "60°C": 350, "75°C": 420, "90°C": 475, "110°C": 530, "125°C": 565, "200°C": None},
        {"Size (AWG/kcmil)": "700", "60°C": 385, "75°C": 460, "90°C": 520, "110°C": 580, "125°C": 620, "200°C": None},
        {"Size (AWG/kcmil)": "750", "60°C": 400, "75°C": 475, "90°C": 535, "110°C": 600, "125°C": 640, "200°C": None},
        {"Size (AWG/kcmil)": "800", "60°C": 410, "75°C": 490, "90°C": 555, "110°C": 620, "125°C": 660, "200°C": None},
        {"Size (AWG/kcmil)": "900", "60°C": 435, "75°C": 520, "90°C": 585, "110°C": 655, "125°C": 700, "200°C": None},
        {"Size (AWG/kcmil)": "1000", "60°C": 455, "75°C": 545, "90°C": 615, "110°C": 690, "125°C": 735, "200°C": None},
        {"Size (AWG/kcmil)": "1250", "60°C": 495, "75°C": 590, "90°C": 665, "110°C": 745, "125°C": None, "200°C": None},
        {"Size (AWG/kcmil)": "1500", "60°C": 525, "75°C": 625, "90°C": 705, "110°C": 790, "125°C": None, "200°C": None},
        {"Size (AWG/kcmil)": "1750", "60°C": 545, "75°C": 650, "90°C": 735, "110°C": 820, "125°C": None, "200°C": None},
        {"Size (AWG/kcmil)": "2000", "60°C": 555, "75°C": 665, "90°C": 750, "110°C": 840, "125°C": None, "200°C": None},
    ],
}

TABLE_5A = {
    "title": "Table 5A — Ampacity correction factors for ambient temperatures above 30°C",
    "units": "factor",
    "columns": ["60°C", "75°C", "90°C", "105°C", "110°C", "125°C", "150°C", "200°C", "250°C"],
    "rows": [
        {"Ambient (°C)": 35, "60°C": 0.91, "75°C": 0.94, "90°C": 0.96, "105°C": 0.97, "110°C": 0.97, "125°C": 0.97, "150°C": 0.98, "200°C": 0.99, "250°C": 0.99},
        {"Ambient (°C)": 40, "60°C": 0.82, "75°C": 0.88, "90°C": 0.91, "105°C": 0.93, "110°C": 0.94, "125°C": 0.95, "150°C": 0.96, "200°C": 0.97, "250°C": 0.98},
        {"Ambient (°C)": 45, "60°C": 0.71, "75°C": 0.82, "90°C": 0.87, "105°C": 0.89, "110°C": 0.90, "125°C": 0.92, "150°C": 0.93, "200°C": 0.95, "250°C": 0.97},
        {"Ambient (°C)": 50, "60°C": 0.58, "75°C": 0.75, "90°C": 0.82, "105°C": 0.86, "110°C": 0.87, "125°C": 0.89, "150°C": 0.91, "200°C": 0.94, "250°C": 0.95},
        {"Ambient (°C)": 55, "60°C": 0.41, "75°C": 0.67, "90°C": 0.76, "105°C": 0.82, "110°C": 0.83, "125°C": 0.86, "150°C": 0.89, "200°C": 0.92, "250°C": 0.94},
        {"Ambient (°C)": 60, "60°C": None, "75°C": 0.58, "90°C": 0.71, "105°C": 0.77, "110°C": 0.79, "125°C": 0.83, "150°C": 0.87, "200°C": 0.91, "250°C": 0.93},
        {"Ambient (°C)": 65, "60°C": None, "75°C": 0.47, "90°C": 0.65, "105°C": 0.73, "110°C": 0.75, "125°C": 0.79, "150°C": 0.84, "200°C": 0.89, "250°C": 0.92},
        {"Ambient (°C)": 70, "60°C": None, "75°C": 0.33, "90°C": 0.58, "105°C": 0.68, "110°C": 0.71, "125°C": 0.76, "150°C": 0.82, "200°C": 0.87, "250°C": 0.90},
        {"Ambient (°C)": 75, "60°C": None, "75°C": None, "90°C": 0.50, "105°C": 0.63, "110°C": 0.66, "125°C": 0.73, "150°C": 0.79, "200°C": 0.86, "250°C": 0.89},
        {"Ambient (°C)": 80, "60°C": None, "75°C": None, "90°C": 0.41, "105°C": 0.58, "110°C": 0.61, "125°C": 0.69, "150°C": 0.76, "200°C": 0.84, "250°C": 0.88},
        {"Ambient (°C)": 90, "60°C": None, "75°C": None, "90°C": None, "105°C": 0.45, "110°C": 0.50, "125°C": 0.61, "150°C": 0.71, "200°C": 0.80, "250°C": 0.85},
        {"Ambient (°C)": 100, "60°C": None, "75°C": None, "90°C": None, "105°C": 0.26, "110°C": 0.35, "125°C": 0.51, "150°C": 0.65, "200°C": 0.77, "250°C": 0.83},
        {"Ambient (°C)": 110, "60°C": None, "75°C": None, "90°C": None, "105°C": None, "110°C": None, "125°C": 0.40, "150°C": 0.58, "200°C": 0.73, "250°C": 0.80},
        {"Ambient (°C)": 120, "60°C": None, "75°C": None, "90°C": None, "105°C": None, "110°C": None, "125°C": 0.23, "150°C": 0.50, "200°C": 0.69, "250°C": 0.77},
        {"Ambient (°C)": 130, "60°C": None, "75°C": None, "90°C": None, "105°C": None, "110°C": None, "125°C": None, "150°C": 0.41, "200°C": 0.64, "250°C": 0.74},
        {"Ambient (°C)": 140, "60°C": None, "75°C": None, "90°C": None, "105°C": None, "110°C": None, "125°C": None, "150°C": 0.29, "200°C": 0.59, "250°C": 0.71},
    ],
}

TABLE_5B = {
    "title": "Table 5B — Correction factors (Tables 1 & 3) for 2–4 single insulated conductors (spaced <25%)",
    "units": "factor",
    "columns": ["Number of conductors", "Correction factor"],
    "rows": [
        {"Number of conductors": 2, "Correction factor": 0.90},
        {"Number of conductors": 3, "Correction factor": 0.85},
        {"Number of conductors": 4, "Correction factor": 0.80},
    ],
}

TABLE_5C = {
    "title": "Table 5C — Ampacity correction factors for Tables 2 & 4 (number of insulated conductors)",
    "units": "factor",
    "columns": ["Number of insulated conductors", "Ampacity correction factor"],
    "rows": [
        {"Number of insulated conductors": "1–3", "Ampacity correction factor": 1.00},
        {"Number of insulated conductors": "4–6", "Ampacity correction factor": 0.80},
        {"Number of insulated conductors": "7–24", "Ampacity correction factor": 0.70},
        {"Number of insulated conductors": "25–42", "Ampacity correction factor": 0.60},
        {"Number of insulated conductors": "43 and up", "Ampacity correction factor": 0.50},
    ],
}

TABLE_5D = {
    "title": "Table 5D — Current rating correction factors where spacings are maintained (ventilated/ladder trays)",
    "units": "factor",
    "columns": ["Vertical layers", "Horizontal count", "Correction factor"],
    "rows": [
        {"Vertical layers": 1, "Horizontal count": 1, "Correction factor": 1.00},
        {"Vertical layers": 1, "Horizontal count": 2, "Correction factor": 0.93},
        {"Vertical layers": 1, "Horizontal count": 3, "Correction factor": 0.87},
        {"Vertical layers": 1, "Horizontal count": 4, "Correction factor": 0.84},
        {"Vertical layers": 1, "Horizontal count": 5, "Correction factor": 0.83},
        {"Vertical layers": 1, "Horizontal count": 6, "Correction factor": 0.82},
        {"Vertical layers": 2, "Horizontal count": 1, "Correction factor": 0.89},
        {"Vertical layers": 2, "Horizontal count": 2, "Correction factor": 0.83},
        {"Vertical layers": 2, "Horizontal count": 3, "Correction factor": 0.79},
        {"Vertical layers": 2, "Horizontal count": 4, "Correction factor": 0.76},
        {"Vertical layers": 2, "Horizontal count": 5, "Correction factor": 0.75},
        {"Vertical layers": 2, "Horizontal count": 6, "Correction factor": 0.74},
    ],
}

TABLE_7 = {
    "title": "Table 7 — Radius of conduit or tubing bends",
    "units": "mm",
    "columns": ["Size (mm)", "Minimum radius to centre (mm)"],
    "rows": [
        {"Size (mm)": 16, "Minimum radius to centre (mm)": 102},
        {"Size (mm)": 21, "Minimum radius to centre (mm)": 114},
        {"Size (mm)": 27, "Minimum radius to centre (mm)": 146},
        {"Size (mm)": 35, "Minimum radius to centre (mm)": 184},
        {"Size (mm)": 41, "Minimum radius to centre (mm)": 210},
        {"Size (mm)": 53, "Minimum radius to centre (mm)": 241},
        {"Size (mm)": 63, "Minimum radius to centre (mm)": 267},
        {"Size (mm)": 78, "Minimum radius to centre (mm)": 330},
        {"Size (mm)": 91, "Minimum radius to centre (mm)": 381},
        {"Size (mm)": 103, "Minimum radius to centre (mm)": 406},
        {"Size (mm)": 129, "Minimum radius to centre (mm)": 610},
        {"Size (mm)": 155, "Minimum radius to centre (mm)": 762},
    ],
}

TABLE_8 = {
    "title": "Table 8 — Maximum allowable conduit/tubing fill (%)",
    "units": "%",
    "columns": ["Cable type", "1", "2", "3", "4", "Over 4"],
    "rows": [
        {"Cable type": "Insulated conductors or multi-conductor cables (not lead-sheathed)", "1": 53, "2": 31, "3": 40, "4": 40, "Over 4": 40},
        {"Cable type": "Lead-sheathed single conductor cables or multi-conductor cables", "1": 55, "2": 30, "3": 40, "4": 38, "Over 4": 35},
    ],
}

TABLE_37 = {
    "title": "Table 37 — Motor supply conductor insulation minimum temperature rating, °C (based on an ambient temperature of 30 °C)",
    "units": "°C",
    "columns": ["Motor enclosure", "A", "B", "F", "H"],
    "rows": [
        {"Motor enclosure": "All except totally enclosed non-ventilated", "A": 75, "B": 75, "F": 90, "H": 110},
        {"Motor enclosure": "Totally enclosed non-ventilated", "A": 75, "B": 90, "F": 110, "H": 110},
    ],
}

TABLE_44 = {
    "title": "Table 44 — Three-phase ac motors (AC motor full load current, A)",
    "units": "A",
    "columns": ["Motor rating (hp)", "Induction 115V", "Induction 200V", "Induction 208V", "Induction 230V", "Induction 460V", "Induction 575V", "Induction 2300V", "Synchronous 200V", "Synchronous 230V", "Synchronous 460V", "Synchronous 575V", "Synchronous 2300V"],
    "rows": [
        {"Motor rating (hp)": "1/2", "Induction 115V": 4.4, "Induction 200V": 2.5, "Induction 208V": 2.4, "Induction 230V": 2.2, "Induction 460V": 1.0, "Induction 575V": 0.9, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "3/4", "Induction 115V": 6.4, "Induction 200V": 3.7, "Induction 208V": 3.5, "Induction 230V": 3.2, "Induction 460V": 1.4, "Induction 575V": 1.3, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "1", "Induction 115V": 8.4, "Induction 200V": 4.8, "Induction 208V": 4.6, "Induction 230V": 4.2, "Induction 460V": 1.8, "Induction 575V": 1.7, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "1-1/2", "Induction 115V": 12.0, "Induction 200V": 6.9, "Induction 208V": 6.6, "Induction 230V": 6.0, "Induction 460V": 2.6, "Induction 575V": 2.4, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "2", "Induction 115V": 13.6, "Induction 200V": 7.8, "Induction 208V": 7.5, "Induction 230V": 6.8, "Induction 460V": 3.4, "Induction 575V": 2.7, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "3", "Induction 115V": 19.2, "Induction 200V": 11.0, "Induction 208V": 10.6, "Induction 230V": 9.6, "Induction 460V": 4.8, "Induction 575V": 3.9, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "5", "Induction 115V": 30.4, "Induction 200V": 17.5, "Induction 208V": 16.7, "Induction 230V": 15.2, "Induction 460V": 7.6, "Induction 575V": 6.1, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "7-1/2", "Induction 115V": 44.0, "Induction 200V": 25.3, "Induction 208V": 24.2, "Induction 230V": 22.0, "Induction 460V": 11.0, "Induction 575V": 9.0, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "10", "Induction 115V": 56.0, "Induction 200V": 32.2, "Induction 208V": 30.8, "Induction 230V": 28.0, "Induction 460V": 14.0, "Induction 575V": 11.0, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "15", "Induction 115V": 84.0, "Induction 200V": 48.3, "Induction 208V": 46.2, "Induction 230V": 42.0, "Induction 460V": 21.0, "Induction 575V": 17.0, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "20", "Induction 115V": 108.0, "Induction 200V": 62.1, "Induction 208V": 59.4, "Induction 230V": 54.0, "Induction 460V": 27.0, "Induction 575V": 22.0, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "25", "Induction 115V": 136.0, "Induction 200V": 78.2, "Induction 208V": 74.8, "Induction 230V": 68.0, "Induction 460V": 34.0, "Induction 575V": 27.0, "Induction 2300V": None, "Synchronous 200V": 62.0, "Synchronous 230V": 54.0, "Synchronous 460V": 27.0, "Synchronous 575V": 22.0, "Synchronous 2300V": None},
        {"Motor rating (hp)": "30", "Induction 115V": 160.0, "Induction 200V": 92.0, "Induction 208V": 88.0, "Induction 230V": 80.0, "Induction 460V": 40.0, "Induction 575V": 32.0, "Induction 2300V": None, "Synchronous 200V": 75.0, "Synchronous 230V": 65.0, "Synchronous 460V": 33.0, "Synchronous 575V": 26.0, "Synchronous 2300V": None},
        {"Motor rating (hp)": "40", "Induction 115V": 208.0, "Induction 200V": 120.0, "Induction 208V": 114.0, "Induction 230V": 104.0, "Induction 460V": 52.0, "Induction 575V": 41.0, "Induction 2300V": None, "Synchronous 200V": 99.0, "Synchronous 230V": 86.0, "Synchronous 460V": 43.0, "Synchronous 575V": 35.0, "Synchronous 2300V": None},
        {"Motor rating (hp)": "50", "Induction 115V": 260.0, "Induction 200V": 150.0, "Induction 208V": 143.0, "Induction 230V": 130.0, "Induction 460V": 65.0, "Induction 575V": 52.0, "Induction 2300V": None, "Synchronous 200V": 124.0, "Synchronous 230V": 108.0, "Synchronous 460V": 54.0, "Synchronous 575V": 44.0, "Synchronous 2300V": None},
        {"Motor rating (hp)": "60", "Induction 115V": None, "Induction 200V": 177.0, "Induction 208V": 169.0, "Induction 230V": 154.0, "Induction 460V": 77.0, "Induction 575V": 62.0, "Induction 2300V": 16.0, "Synchronous 200V": 147.0, "Synchronous 230V": 128.0, "Synchronous 460V": 64.0, "Synchronous 575V": 51.0, "Synchronous 2300V": 12.0},
        {"Motor rating (hp)": "75", "Induction 115V": None, "Induction 200V": 221.0, "Induction 208V": 211.0, "Induction 230V": 192.0, "Induction 460V": 96.0, "Induction 575V": 77.0, "Induction 2300V": 20.0, "Synchronous 200V": 185.0, "Synchronous 230V": 161.0, "Synchronous 460V": 81.0, "Synchronous 575V": 65.0, "Synchronous 2300V": 15.0},
        {"Motor rating (hp)": "100", "Induction 115V": None, "Induction 200V": 285.0, "Induction 208V": 273.0, "Induction 230V": 248.0, "Induction 460V": 124.0, "Induction 575V": 99.0, "Induction 2300V": 26.0, "Synchronous 200V": 243.0, "Synchronous 230V": 211.0, "Synchronous 460V": 106.0, "Synchronous 575V": 85.0, "Synchronous 2300V": 20.0},
        {"Motor rating (hp)": "125", "Induction 115V": None, "Induction 200V": 359.0, "Induction 208V": 343.0, "Induction 230V": 312.0, "Induction 460V": 156.0, "Induction 575V": 125.0, "Induction 2300V": 31.0, "Synchronous 200V": 304.0, "Synchronous 230V": 264.0, "Synchronous 460V": 132.0, "Synchronous 575V": 106.0, "Synchronous 2300V": 25.0},
        {"Motor rating (hp)": "150", "Induction 115V": None, "Induction 200V": 414.0, "Induction 208V": 396.0, "Induction 230V": 360.0, "Induction 460V": 180.0, "Induction 575V": 144.0, "Induction 2300V": 37.0, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": 158.0, "Synchronous 575V": 127.0, "Synchronous 2300V": 30.0},
        {"Motor rating (hp)": "200", "Induction 115V": None, "Induction 200V": 552.0, "Induction 208V": 528.0, "Induction 230V": 480.0, "Induction 460V": 240.0, "Induction 575V": 192.0, "Induction 2300V": 49.0, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": 210.0, "Synchronous 575V": 168.0, "Synchronous 2300V": 40.0},
        {"Motor rating (hp)": "250", "Induction 115V": None, "Induction 200V": None, "Induction 208V": None, "Induction 230V": 604.0, "Induction 460V": 302.0, "Induction 575V": 242.0, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "300", "Induction 115V": None, "Induction 200V": None, "Induction 208V": None, "Induction 230V": 722.0, "Induction 460V": 361.0, "Induction 575V": 289.0, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "350", "Induction 115V": None, "Induction 200V": None, "Induction 208V": None, "Induction 230V": 828.0, "Induction 460V": 414.0, "Induction 575V": 336.0, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "400", "Induction 115V": None, "Induction 200V": None, "Induction 208V": None, "Induction 230V": 954.0, "Induction 460V": 477.0, "Induction 575V": 382.0, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "450", "Induction 115V": None, "Induction 200V": None, "Induction 208V": None, "Induction 230V": 1030.0, "Induction 460V": 515.0, "Induction 575V": 412.0, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
        {"Motor rating (hp)": "500", "Induction 115V": None, "Induction 200V": None, "Induction 208V": None, "Induction 230V": 1180.0, "Induction 460V": 590.0, "Induction 575V": 472.0, "Induction 2300V": None, "Synchronous 200V": None, "Synchronous 230V": None, "Synchronous 460V": None, "Synchronous 575V": None, "Synchronous 2300V": None},
    ],
}

TABLE_45 = {
    "title": "Table 45 — Single-phase ac motors (Single-phase ac motors full load current, A)",
    "units": "A",
    "columns": ["hp rating", "115 V", "230 V"],
    "rows": [
        {"hp rating": "1/6", "115 V": 4.4, "230 V": 2.2},
        {"hp rating": "1/4", "115 V": 5.8, "230 V": 2.9},
        {"hp rating": "1/3", "115 V": 7.2, "230 V": 3.6},
        {"hp rating": "1/2", "115 V": 9.8, "230 V": 4.9},
        {"hp rating": "3/4", "115 V": 13.8, "230 V": 6.9},
        {"hp rating": "1", "115 V": 16.0, "230 V": 8.0},
        {"hp rating": "1-1/2", "115 V": 20.0, "230 V": 10.0},
        {"hp rating": "2", "115 V": 24.0, "230 V": 12.0},
        {"hp rating": "3", "115 V": 34.0, "230 V": 17.0},
        {"hp rating": "5", "115 V": 56.0, "230 V": 28.0},
        {"hp rating": "7-1/2", "115 V": 80.0, "230 V": 40.0},
        {"hp rating": "10", "115 V": 100.0, "230 V": 50.0},
    ],
}

# --------------------------------------------------------------------------------------
# Table 27 — Determining conductor sizes for motors for different requirements of service
# --------------------------------------------------------------------------------------
TABLE_27 = {
    "title": "Table 27 — Determining conductor sizes for motors for different requirements of service (Percentage of nameplate current rating of motor)",
    "units": "%",
    "columns": ["Classification of service", "5-min rating", "15-min rating", "30- and 60-min rating", "Continuous rating"],
    "rows": [
        {"Classification of service": "Short-time duty (Operating valves, raising or lowering rolls, etc.)", "5-min rating": 110, "15-min rating": 120, "30- and 60-min rating": 150, "Continuous rating": None},
        {"Classification of service": "Intermittent duty (Freight and passenger elevators, tool heads, pumps, drawbridges, turntables, etc.)", "5-min rating": 85, "15-min rating": 85, "30- and 60-min rating": 90, "Continuous rating": 140},
        {"Classification of service": "Periodic duty (Rolls, ore- and coal-handling machines, etc.)", "5-min rating": 85, "15-min rating": 90, "30- and 60-min rating": 95, "Continuous rating": 140},
        {"Classification of service": "Varying duty", "5-min rating": 110, "15-min rating": 120, "30- and 60-min rating": 150, "Continuous rating": 200},
    ],
}

# --------------------------------------------------------------------------------------
# Table D2 — DC motors
# --------------------------------------------------------------------------------------
TABLE_D2 = {
    "title": "Table D2 — DC motors (DC full load current rating, A)",
    "units": "A",
    "columns": ["Motor rating (hp)", "120 V", "240 V", "500 V"],
    "rows": [
        {"Motor rating (hp)": "1/4", "120 V": 2.9, "240 V": 1.5, "500 V": None},
        {"Motor rating (hp)": "1/3", "120 V": 3.6, "240 V": 1.8, "500 V": None},
        {"Motor rating (hp)": "1/2", "120 V": 5.2, "240 V": 2.6, "500 V": None},
        {"Motor rating (hp)": "3/4", "120 V": 7.4, "240 V": 3.7, "500 V": 1.8},
        {"Motor rating (hp)": "1", "120 V": 9.4, "240 V": 4.7, "500 V": 2.3},
        {"Motor rating (hp)": "1-1/2", "120 V": 13.2, "240 V": 6.6, "500 V": 3.2},
        {"Motor rating (hp)": "2", "120 V": 17, "240 V": 8.5, "500 V": 4.1},
        {"Motor rating (hp)": "3", "120 V": 25, "240 V": 12.5, "500 V": 6.0},
        {"Motor rating (hp)": "5", "120 V": 40, "240 V": 20, "500 V": 9.7},
        {"Motor rating (hp)": "7-1/2", "120 V": 58, "240 V": 29, "500 V": 14},
        {"Motor rating (hp)": "10", "120 V": 76, "240 V": 38, "500 V": 18},
        {"Motor rating (hp)": "15", "120 V": 110, "240 V": 55, "500 V": 26},
        {"Motor rating (hp)": "20", "120 V": 145, "240 V": 72, "500 V": 35},
        {"Motor rating (hp)": "25", "120 V": 179, "240 V": 89, "500 V": 43},
        {"Motor rating (hp)": "30", "120 V": 212, "240 V": 106, "500 V": 51},
        {"Motor rating (hp)": "40", "120 V": 280, "240 V": 140, "500 V": 68},
        {"Motor rating (hp)": "50", "120 V": 349, "240 V": 174, "500 V": 84},
        {"Motor rating (hp)": "60", "120 V": 418, "240 V": 209, "500 V": 101},
        {"Motor rating (hp)": "75", "120 V": 518, "240 V": 259, "500 V": 124},
        {"Motor rating (hp)": "100", "120 V": None, "240 V": 343, "500 V": 165},
        {"Motor rating (hp)": "125", "120 V": None, "240 V": 426, "500 V": 205},
        {"Motor rating (hp)": "150", "120 V": None, "240 V": 507, "500 V": 243},
        {"Motor rating (hp)": "200", "120 V": None, "240 V": 675, "500 V": 324},
    ],
}

# --------------------------------------------------------------------------------------
# Table D — System Factor (f) for voltage drop calculations
# --------------------------------------------------------------------------------------
# Based on various AC and DC electrical systems and connection types
# Used in formula: VD(%) = (k × f × I × L) / 1000
TABLE_D_SYSTEM_FACTOR = {
    "title": "Table D — System factor (f) for voltage drop calculations in various AC and DC electrical systems and connection types",
    "units": "dimensionless",
    "columns": ["system_connection", "f_value", "voltage_reference"],
    "rows": [
        {"system_connection": "DC — 2-wire (positive-to-negative)", "f_value": 2.0, "voltage_reference": "Positive-to-negative"},
        {"system_connection": "DC — 2-wire (positive-to-ground)", "f_value": 2.0, "voltage_reference": "Positive-to-ground"},
        {"system_connection": "DC — 2-wire (negative-to-ground)", "f_value": 2.0, "voltage_reference": "Negative-to-ground"},
        {"system_connection": "DC — 3-wire, line-to-line with grounded conductor", "f_value": 2.0, "voltage_reference": "Line-to-line"},
        {"system_connection": "1-φ AC — 2-wire, line-to-grounded conductor", "f_value": 2.0, "voltage_reference": "Line-to-ground"},
        {"system_connection": "1-φ AC — 2-wire, line-to-line", "f_value": 2.0, "voltage_reference": "Line-to-line"},
        {"system_connection": "1-φ AC — 3-wire, line-to-line, with grounded conductor", "f_value": 2.0, "voltage_reference": "Line-to-line"},
        {"system_connection": "3-φ AC — 2-wire, line-to-grounded conductor", "f_value": 2.0, "voltage_reference": "Line-to-ground"},
        {"system_connection": "3-φ AC — 2-wire, line-to-line, no grounded conductor", "f_value": 2.0, "voltage_reference": "Line-to-line"},
        {"system_connection": "3-φ AC — 3-wire, line-to-line with grounded conductor", "f_value": 2.0, "voltage_reference": "Line-to-line"},
        {"system_connection": "3-φ AC — 3-wire, line-to-grounded conductor", "f_value": 2.0, "voltage_reference": "Line-to-ground"},
        {"system_connection": "3-φ AC — 3-wire, line-to-line, no grounded conductor", "f_value": 1.732, "voltage_reference": "Line-to-line"},
        {"system_connection": "3-φ AC — 4-wire, line-to-line, with grounded conductor", "f_value": 1.732, "voltage_reference": "Line-to-line"},
    ],
}

# --------------------------------------------------------------------------------------
# Table D3 (Voltage Drop) — K values for calculating voltage drop (Ω/km)
# --------------------------------------------------------------------------------------
# Based on conductor operating temperature of 75 °C
# Applies to installations of 2, 3, or 4 insulated conductors in cable or raceway
TABLE_D3 = {
    "title": "Table D3 — K values for calculating voltage drop in an installation of 2, 3, or 4 insulated conductors in a cable or raceway based on a conductor operating temperature of 75 °C",
    "units": "Ω/km",
    "columns": ["size_awg_kcmil", "copper_dc", "copper_cable_100pf", "copper_cable_90pf", "copper_cable_80pf", "copper_raceway_100pf", "copper_raceway_90pf", "copper_raceway_80pf", "aluminum_dc", "aluminum_cable_100pf", "aluminum_cable_90pf", "aluminum_cable_80pf", "aluminum_raceway_100pf", "aluminum_raceway_90pf", "aluminum_raceway_80pf"],
    "rows": [
        {"size_awg_kcmil": "14", "copper_dc": 10.2, "copper_cable_100pf": 10.2, "copper_cable_90pf": 9.92, "copper_cable_80pf": 9.67, "copper_raceway_100pf": 10.2, "copper_raceway_90pf": 10, "copper_raceway_80pf": 9.67, "aluminum_dc": None, "aluminum_cable_100pf": None, "aluminum_cable_90pf": None, "aluminum_cable_80pf": None, "aluminum_raceway_100pf": None, "aluminum_raceway_90pf": None, "aluminum_raceway_80pf": None},
        {"size_awg_kcmil": "12", "copper_dc": 6.38, "copper_cable_100pf": 6.38, "copper_cable_90pf": 6.25, "copper_cable_80pf": 6.1, "copper_raceway_100pf": 6.38, "copper_raceway_90pf": 6.26, "copper_raceway_80pf": 6.11, "aluminum_dc": 10.5, "aluminum_cable_100pf": 10.5, "aluminum_cable_90pf": 10.3, "aluminum_cable_80pf": 10.0, "aluminum_raceway_100pf": 10.5, "aluminum_raceway_90pf": 10.3, "aluminum_raceway_80pf": 9.99},
        {"size_awg_kcmil": "10", "copper_dc": 4.03, "copper_cable_100pf": 4.03, "copper_cable_90pf": 3.96, "copper_cable_80pf": 3.87, "copper_raceway_100pf": 4.03, "copper_raceway_90pf": 3.96, "copper_raceway_80pf": 3.87, "aluminum_dc": 6.58, "aluminum_cable_100pf": 6.58, "aluminum_cable_90pf": 6.44, "aluminum_cable_80pf": 6.28, "aluminum_raceway_100pf": 6.58, "aluminum_raceway_90pf": 6.45, "aluminum_raceway_80pf": 6.29},
        {"size_awg_kcmil": "8", "copper_dc": 2.54, "copper_cable_100pf": 2.54, "copper_cable_90pf": 2.5, "copper_cable_80pf": 2.45, "copper_raceway_100pf": 2.54, "copper_raceway_90pf": 2.51, "copper_raceway_80pf": 2.45, "aluminum_dc": 4.14, "aluminum_cable_100pf": 4.14, "aluminum_cable_90pf": 4.07, "aluminum_cable_80pf": 3.97, "aluminum_raceway_100pf": 4.14, "aluminum_raceway_90pf": 4.07, "aluminum_raceway_80pf": 3.98},
        {"size_awg_kcmil": "6", "copper_dc": 1.59, "copper_cable_100pf": 1.59, "copper_cable_90pf": 1.58, "copper_cable_80pf": 1.55, "copper_raceway_100pf": 1.59, "copper_raceway_90pf": 1.58, "copper_raceway_80pf": 1.55, "aluminum_dc": 2.62, "aluminum_cable_100pf": 2.62, "aluminum_cable_90pf": 2.58, "aluminum_cable_80pf": 2.52, "aluminum_raceway_100pf": 2.62, "aluminum_raceway_90pf": 2.58, "aluminum_raceway_80pf": 2.53},
        {"size_awg_kcmil": "4", "copper_dc": 1.01, "copper_cable_100pf": 1.01, "copper_cable_90pf": 1.01, "copper_cable_80pf": 0.987, "copper_raceway_100pf": 1.01, "copper_raceway_90pf": 1.01, "copper_raceway_80pf": 1, "aluminum_dc": 1.65, "aluminum_cable_100pf": 1.65, "aluminum_cable_90pf": 1.63, "aluminum_cable_80pf": 1.6, "aluminum_raceway_100pf": 1.65, "aluminum_raceway_90pf": 1.64, "aluminum_raceway_80pf": 1.61},
        {"size_awg_kcmil": "3", "copper_dc": 0.792, "copper_cable_100pf": 0.792, "copper_cable_90pf": 0.797, "copper_cable_80pf": 0.787, "copper_raceway_100pf": 0.792, "copper_raceway_90pf": 0.801, "copper_raceway_80pf": 0.792, "aluminum_dc": 1.3, "aluminum_cable_100pf": 1.31, "aluminum_cable_90pf": 1.3, "aluminum_cable_80pf": 1.27, "aluminum_raceway_100pf": 1.31, "aluminum_raceway_90pf": 1.3, "aluminum_raceway_80pf": 1.28},
        {"size_awg_kcmil": "2", "copper_dc": 0.626, "copper_cable_100pf": 0.627, "copper_cable_90pf": 0.636, "copper_cable_80pf": 0.629, "copper_raceway_100pf": 0.627, "copper_raceway_90pf": 0.639, "copper_raceway_80pf": 0.635, "aluminum_dc": 1.04, "aluminum_cable_100pf": 1.04, "aluminum_cable_90pf": 1.04, "aluminum_cable_80pf": 1.02, "aluminum_raceway_100pf": 1.04, "aluminum_raceway_90pf": 1.04, "aluminum_raceway_80pf": 1.03},
        {"size_awg_kcmil": "1", "copper_dc": 0.5, "copper_cable_100pf": 0.5, "copper_cable_90pf": 0.512, "copper_cable_80pf": 0.509, "copper_raceway_100pf": 0.5, "copper_raceway_90pf": 0.516, "copper_raceway_80pf": 0.515, "aluminum_dc": 0.82, "aluminum_cable_100pf": 0.82, "aluminum_cable_90pf": 0.823, "aluminum_cable_80pf": 0.812, "aluminum_raceway_100pf": 0.82, "aluminum_raceway_90pf": 0.827, "aluminum_raceway_80pf": 0.818},
        {"size_awg_kcmil": "1/0", "copper_dc": 0.395, "copper_cable_100pf": 0.396, "copper_cable_90pf": 0.41, "copper_cable_80pf": 0.409, "copper_raceway_100pf": 0.396, "copper_raceway_90pf": 0.414, "copper_raceway_80pf": 0.415, "aluminum_dc": 0.651, "aluminum_cable_100pf": 0.652, "aluminum_cable_90pf": 0.659, "aluminum_cable_80pf": 0.652, "aluminum_raceway_100pf": 0.652, "aluminum_raceway_90pf": 0.663, "aluminum_raceway_80pf": 0.657},
        {"size_awg_kcmil": "2/0", "copper_dc": 0.314, "copper_cable_100pf": 0.316, "copper_cable_90pf": 0.331, "copper_cable_80pf": 0.332, "copper_raceway_100pf": 0.316, "copper_raceway_90pf": 0.335, "copper_raceway_80pf": 0.338, "aluminum_dc": 0.516, "aluminum_cable_100pf": 0.517, "aluminum_cable_90pf": 0.526, "aluminum_cable_80pf": 0.522, "aluminum_raceway_100pf": 0.517, "aluminum_raceway_90pf": 0.53, "aluminum_raceway_80pf": 0.528},
        {"size_awg_kcmil": "3/0", "copper_dc": 0.249, "copper_cable_100pf": 0.251, "copper_cable_90pf": 0.267, "copper_cable_80pf": 0.27, "copper_raceway_100pf": 0.251, "copper_raceway_90pf": 0.271, "copper_raceway_80pf": 0.275, "aluminum_dc": 0.408, "aluminum_cable_100pf": 0.409, "aluminum_cable_90pf": 0.42, "aluminum_cable_80pf": 0.419, "aluminum_raceway_100pf": 0.409, "aluminum_raceway_90pf": 0.424, "aluminum_raceway_80pf": 0.425},
        {"size_awg_kcmil": "4/0", "copper_dc": 0.197, "copper_cable_100pf": 0.2, "copper_cable_90pf": 0.217, "copper_cable_80pf": 0.221, "copper_raceway_100pf": 0.2, "copper_raceway_90pf": 0.221, "copper_raceway_80pf": 0.226, "aluminum_dc": 0.326, "aluminum_cable_100pf": 0.327, "aluminum_cable_90pf": 0.341, "aluminum_cable_80pf": 0.341, "aluminum_raceway_100pf": 0.327, "aluminum_raceway_90pf": 0.345, "aluminum_raceway_80pf": 0.347},
        {"size_awg_kcmil": "250", "copper_dc": 0.167, "copper_cable_100pf": 0.171, "copper_cable_90pf": 0.188, "copper_cable_80pf": 0.193, "copper_raceway_100pf": 0.171, "copper_raceway_90pf": 0.192, "copper_raceway_80pf": 0.198, "aluminum_dc": 0.275, "aluminum_cable_100pf": 0.277, "aluminum_cable_90pf": 0.291, "aluminum_cable_80pf": 0.293, "aluminum_raceway_100pf": 0.277, "aluminum_raceway_90pf": 0.295, "aluminum_raceway_80pf": 0.299},
        {"size_awg_kcmil": "300", "copper_dc": 0.14, "copper_cable_100pf": 0.144, "copper_cable_90pf": 0.162, "copper_cable_80pf": 0.167, "copper_raceway_100pf": 0.144, "copper_raceway_90pf": 0.166, "copper_raceway_80pf": 0.172, "aluminum_dc": 0.229, "aluminum_cable_100pf": 0.231, "aluminum_cable_90pf": 0.247, "aluminum_cable_80pf": 0.249, "aluminum_raceway_100pf": 0.231, "aluminum_raceway_90pf": 0.25, "aluminum_raceway_80pf": 0.255},
        {"size_awg_kcmil": "350", "copper_dc": 0.12, "copper_cable_100pf": 0.125, "copper_cable_90pf": 0.143, "copper_cable_80pf": 0.148, "copper_raceway_100pf": 0.125, "copper_raceway_90pf": 0.147, "copper_raceway_80pf": 0.154, "aluminum_dc": 0.196, "aluminum_cable_100pf": 0.199, "aluminum_cable_90pf": 0.215, "aluminum_cable_80pf": 0.218, "aluminum_raceway_100pf": 0.199, "aluminum_raceway_90pf": 0.219, "aluminum_raceway_80pf": 0.224},
        {"size_awg_kcmil": "400", "copper_dc": 0.105, "copper_cable_100pf": 0.111, "copper_cable_90pf": 0.129, "copper_cable_80pf": 0.135, "copper_raceway_100pf": 0.111, "copper_raceway_90pf": 0.133, "copper_raceway_80pf": 0.14, "aluminum_dc": 0.172, "aluminum_cable_100pf": 0.175, "aluminum_cable_90pf": 0.191, "aluminum_cable_80pf": 0.195, "aluminum_raceway_100pf": 0.175, "aluminum_raceway_90pf": 0.195, "aluminum_raceway_80pf": 0.201},
        {"size_awg_kcmil": "500", "copper_dc": 0.0836, "copper_cable_100pf": 0.0912, "copper_cable_90pf": 0.11, "copper_cable_80pf": 0.116, "copper_raceway_100pf": 0.0912, "copper_raceway_90pf": 0.114, "copper_raceway_80pf": 0.121, "aluminum_dc": 0.138, "aluminum_cable_100pf": 0.141, "aluminum_cable_90pf": 0.158, "aluminum_cable_80pf": 0.163, "aluminum_raceway_100pf": 0.141, "aluminum_raceway_90pf": 0.162, "aluminum_raceway_80pf": 0.168},
        {"size_awg_kcmil": "600", "copper_dc": 0.0697, "copper_cable_100pf": 0.0785, "copper_cable_90pf": 0.0969, "copper_cable_80pf": 0.104, "copper_raceway_100pf": 0.0785, "copper_raceway_90pf": 0.101, "copper_raceway_80pf": 0.109, "aluminum_dc": 0.115, "aluminum_cable_100pf": 0.119, "aluminum_cable_90pf": 0.136, "aluminum_cable_80pf": 0.142, "aluminum_raceway_100pf": 0.119, "aluminum_raceway_90pf": 0.14, "aluminum_raceway_80pf": 0.147},
        {"size_awg_kcmil": "750", "copper_dc": 0.0558, "copper_cable_100pf": 0.0668, "copper_cable_90pf": 0.085, "copper_cable_80pf": 0.0915, "copper_raceway_100pf": 0.0668, "copper_raceway_90pf": 0.0889, "copper_raceway_80pf": 0.097, "aluminum_dc": 0.0916, "aluminum_cable_100pf": 0.0968, "aluminum_cable_90pf": 0.115, "aluminum_cable_80pf": 0.121, "aluminum_raceway_100pf": 0.0968, "aluminum_raceway_90pf": 0.119, "aluminum_raceway_80pf": 0.126},
        {"size_awg_kcmil": "1000", "copper_dc": 0.0417, "copper_cable_100pf": 0.0558, "copper_cable_90pf": 0.0739, "copper_cable_80pf": 0.0805, "copper_raceway_100pf": 0.0558, "copper_raceway_90pf": 0.0778, "copper_raceway_80pf": 0.086, "aluminum_dc": 0.0686, "aluminum_cable_100pf": 0.0758, "aluminum_cable_90pf": 0.0933, "aluminum_cable_80pf": 0.0994, "aluminum_raceway_100pf": 0.0758, "aluminum_raceway_90pf": 0.0973, "aluminum_raceway_80pf": 0.105},
    ],
}

# ----------------------------
# Registry + public API
# ----------------------------

def _is_table_var(name: str) -> bool:
    if not name.startswith("TABLE_"):
        return False
    # Exclude helper constants like TABLE_6A_TYPES
    return not name.endswith("_TYPES")

def _build_registry() -> Dict[str, Dict[str, Any]]:
    reg: Dict[str, Dict[str, Any]] = {}

    # 1) Include every TABLE_* object in this module (including legacy dict tables)
    g = globals()
    for k, v in list(g.items()):
        if _is_table_var(k) and isinstance(v, (dict, list)):
            # Friendly key: "1", "5A", "6A", etc.
            key = k.replace("TABLE_", "")
            title = None
            units = None
            columns = None
            rows = None

            if isinstance(v, dict) and "title" in v and "rows" in v:
                title = v.get("title")
                units = v.get("units")
                columns = v.get("columns")
                rows = v.get("rows")
            else:
                # Legacy tables (e.g., TABLE_6A) are specialized structures; keep raw only
                title = f"Table {key}"
                rows = None

            effective_title = TITLE_OVERRIDES.get(key, title or f"Table {key}")

            reg[key] = {
                "id": key,
                "var_name": k,
                "title": effective_title,
                "units": units,
                "columns": columns,
                "rows": rows,
                "raw": v,
            }

    # 2) Convenience combined views for Table 6 and Table 9 families
    # These are NOT official table IDs in the code book, but they make browsing easier in the Table Library.
    # They are generated dynamically in get_table_dataframe().
    if "6" not in reg:
        reg["6"] = {
            "id": "6",
            "var_name": "(generated)",
            "title": "Table 6 (Combined) — All Table 6 sub-tables",
            "units": None,
            "columns": None,
            "rows": None,
            "raw": {"subtables": [k for k in reg.keys() if str(k).upper().startswith("6") and str(k).upper() != "6"]},
        }
    if "9" not in reg:
        reg["9"] = {
            "id": "9",
            "var_name": "(generated)",
            "title": "Table 9 (Combined) — All Table 9 sub-tables",
            "units": None,
            "columns": None,
            "rows": None,
            "raw": {"subtables": [k for k in reg.keys() if str(k).upper().startswith("9") and str(k).upper() != "9"]},
        }

    return reg

# Module-level cached registry
_TABLE_REGISTRY: Dict[str, Dict[str, Any]] = _build_registry()

def list_table_ids() -> List[str]:
    """Return sorted table IDs available in the library (e.g., ['1','2','5A','6A',...])."""
    def _sort_key(tid: str):
        # Numeric prefix first, then alpha suffix (e.g., 5A, 5B)
        m = __import__("re").match(r"^(\d+)([A-Z]*)$", str(tid))
        if not m:
            return (10**9, str(tid))
        n = int(m.group(1))
        suf = m.group(2) or ""
        return (n, suf)
    return sorted(_TABLE_REGISTRY.keys(), key=_sort_key)

def get_table_meta(table_id: str) -> Optional[Dict[str, Any]]:
    return _TABLE_REGISTRY.get(str(table_id).upper())

def get_table_rows(table_id: str) -> Optional[List[Dict[str, Any]]]:
    meta = get_table_meta(table_id)
    if not meta:
        return None
    return meta.get("rows")


# ----------------------------
# Specialized table-to-DataFrame converters
# (Some embedded tables are stored in structured "raw" formats rather than row lists.)
# ----------------------------
def _df_table6(raw: dict):
    """Convert Table 6(A–K) raw structure to a display DataFrame.

    Expected raw format (by convention in this project):
        {
          "stranded": {size: {"dia_mm": float, "areas_by_count": {n: area_mm2}}},
          "solid":    {size: {"dia_mm": float, "areas_by_count": {n: area_mm2}}},
        }

    Returns a wide DataFrame with one row per size+type, and columns for conductor count -> area.
    """
    try:
        import pandas as pd  # type: ignore
    except Exception:
        pd = None  # type: ignore

    if not isinstance(raw, dict):
        return None

    rows = []
    all_counts = set()

    for conductor_type, size_map in raw.items():
        if not isinstance(size_map, dict):
            continue
        for size, payload in size_map.items():
            if not isinstance(payload, dict):
                continue
            dia = payload.get("dia_mm")
            areas = payload.get("areas_by_count") or {}
            if isinstance(areas, dict):
                for n in areas.keys():
                    try:
                        all_counts.add(int(n))
                    except Exception:
                        pass
            rows.append(
                {
                    "Conductor": str(size),
                    "Type": str(conductor_type).title(),
                    "Diameter (mm)": dia,
                    "_areas": areas,
                }
            )

    if not rows:
        return None

    count_cols = sorted(all_counts)
    out_rows = []
    for r in rows:
        base = {
            "Conductor": r["Conductor"],
            "Type": r["Type"],
            "Diameter (mm)": r["Diameter (mm)"],
        }
        areas = r.get("_areas") or {}
        for n in count_cols:
            base[str(n)] = areas.get(n) if isinstance(areas, dict) else None
        out_rows.append(base)

    if pd is None:
        # fallback list-of-dicts
        return out_rows

    df = pd.DataFrame(out_rows)
    ordered = ["Conductor", "Type", "Diameter (mm)"] + [str(n) for n in count_cols]
    return df[ordered]


def _df_table9(raw: dict):
    """Convert Table 9(A–H) raw structure to a display DataFrame.

    Expected raw format (by convention in this project):
        {trade_size: {raceway_type: {"id_mm": float, "area_mm2": float}, ...}, ...}

    Returns a wide DataFrame with one row per trade size, and columns for each raceway type's ID/Area.
    """
    try:
        import pandas as pd  # type: ignore
    except Exception:
        pd = None  # type: ignore

    if not isinstance(raw, dict):
        return None

    type_keys = set()
    for trade, payload in raw.items():
        if isinstance(payload, dict):
            type_keys.update(payload.keys())

    def _pretty(k: str) -> str:
        return str(k).replace("_", " ").title()

    rows = []
    for trade, payload in raw.items():
        if not isinstance(payload, dict):
            continue
        row = {"Trade size": trade}
        for t in sorted(type_keys, key=lambda x: str(x)):
            entry = payload.get(t) or {}
            if isinstance(entry, dict):
                row[f"{_pretty(t)} ID (mm)"] = entry.get("id_mm")
                row[f"{_pretty(t)} Area (mm²)"] = entry.get("area_mm2")
            else:
                row[f"{_pretty(t)} ID (mm)"] = None
                row[f"{_pretty(t)} Area (mm²)"] = None
        rows.append(row)

    if not rows:
        return None

    if pd is None:
        return rows

    return pd.DataFrame(rows)


def get_table_dataframe(table_id: str):
    """Return a pandas DataFrame when possible; otherwise returns list-of-dicts or None.

    Notes:
    - Most tables are stored as a simple list-of-dicts in meta['rows'].
    - Some large tables (notably Table 6 and Table 9 families) are stored in structured meta['raw'] formats.
      For those, we generate a display DataFrame here so the Table Library page can render them.
    """
    meta = get_table_meta(table_id)
    if not meta:
        return None

    rows = meta.get("rows")
    if rows is not None:
        return _df(rows)

    raw = meta.get("raw")
    if raw is None:
        return None

    tid = str(table_id).upper().strip()

    # Combined convenience views (generated keys "6" and "9")
    if tid == "6":
        try:
            import pandas as pd  # type: ignore
        except Exception:
            pd = None  # type: ignore

        subtables = [k for k in _TABLE_REGISTRY.keys() if str(k).upper().startswith("6") and str(k).upper() != "6"]
        parts = []
        for sid in subtables:
            m2 = get_table_meta(sid) or {}
            raw2 = m2.get("raw")
            df2 = _df_table6(raw2) if raw2 is not None else None
            if df2 is None:
                continue
            if isinstance(df2, list):
                for r in df2:
                    r["Subtable"] = sid
                parts.append(df2)
            else:
                df2 = df2.copy()
                df2.insert(0, "Subtable", sid)
                parts.append(df2)

        if not parts:
            return None

        if pd is None:
            out = []
            for p in parts:
                out.extend(p if isinstance(p, list) else p.to_dict("records"))
            return out

        return pd.concat(parts, ignore_index=True, sort=False)

    if tid == "9":
        try:
            import pandas as pd  # type: ignore
        except Exception:
            pd = None  # type: ignore

        subtables = [k for k in _TABLE_REGISTRY.keys() if str(k).upper().startswith("9") and str(k).upper() != "9"]
        parts = []
        for sid in subtables:
            m2 = get_table_meta(sid) or {}
            raw2 = m2.get("raw")
            df2 = _df_table9(raw2) if raw2 is not None else None
            if df2 is None:
                continue
            if isinstance(df2, list):
                for r in df2:
                    r["Subtable"] = sid
                parts.append(df2)
            else:
                df2 = df2.copy()
                df2.insert(0, "Subtable", sid)
                parts.append(df2)

        if not parts:
            return None

        if pd is None:
            out = []
            for p in parts:
                out.extend(p if isinstance(p, list) else p.to_dict("records"))
            return out

        return pd.concat(parts, ignore_index=True, sort=False)

    # Table 6(A–K) family (conductor areas by count)
    if tid.startswith("6"):
        return _df_table6(raw)

    # Table 9(A–H) family (raceway IDs/areas)
    if tid.startswith("9"):
        return _df_table9(raw)

    return None


def search_tables(query: str) -> List[str]:
    q = (query or "").strip().lower()
    if not q:
        return list_table_ids()
    out = []
    for tid, meta in _TABLE_REGISTRY.items():
        hay = " ".join([str(tid), str(meta.get("title","")), str(meta.get("var_name",""))]).lower()
        if q in hay:
            out.append(tid)
    # keep natural ordering
    order = list_table_ids()
    return [t for t in order if t in out]
